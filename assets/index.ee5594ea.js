(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerpolicy&&(s.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?s.credentials="include":i.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();function et(){}const Ja=e=>e;function bu(e){return e()}function Qo(){return Object.create(null)}function br(e){e.forEach(bu)}function Rs(e){return typeof e=="function"}function Dt(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Mf(e){return Object.keys(e).length===0}function Pf(e,...t){if(e==null)return et;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function Xe(e,t,r){e.$$.on_destroy.push(Pf(t,r))}function Jo(e){return e==null?"":e}function Ff(e,t,r){return e.set(r),t}const Eu=typeof window<"u";let Su=Eu?()=>window.performance.now():()=>Date.now(),Ya=Eu?e=>requestAnimationFrame(e):et;const Dn=new Set;function _u(e){Dn.forEach(t=>{t.c(e)||(Dn.delete(t),t.f())}),Dn.size!==0&&Ya(_u)}function wu(e){let t;return Dn.size===0&&Ya(_u),{promise:new Promise(r=>{Dn.add(t={c:e,f:r})}),abort(){Dn.delete(t)}}}function se(e,t){e.appendChild(t)}function Tu(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function Vf(e){const t=oe("style");return Kf(Tu(e),t),t.sheet}function Kf(e,t){return se(e.head||e,t),t.sheet}function me(e,t,r){e.insertBefore(t,r||null)}function ye(e){e.parentNode&&e.parentNode.removeChild(e)}function dn(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function oe(e){return document.createElement(e)}function ft(e){return document.createTextNode(e)}function it(){return ft(" ")}function Ii(){return ft("")}function Lt(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function pe(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function Hf(e){return Array.from(e.childNodes)}function qt(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function Bn(e,t){e.value=t==null?"":t}function Fr(e,t,r){e.classList[r?"add":"remove"](t)}function $f(e,t,{bubbles:r=!1,cancelable:n=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(e,r,n,t),i}const rs=new Map;let ns=0;function Gf(e){let t=5381,r=e.length;for(;r--;)t=(t<<5)-t^e.charCodeAt(r);return t>>>0}function qf(e,t){const r={stylesheet:Vf(t),rules:{}};return rs.set(e,r),r}function xu(e,t,r,n,i,s,a,o=0){const l=16.666/n;let u=`{
`;for(let T=0;T<=1;T+=l){const x=t+(r-t)*s(T);u+=T*100+`%{${a(x,1-x)}}
`}const c=u+`100% {${a(r,1-r)}}
}`,f=`__svelte_${Gf(c)}_${o}`,d=Tu(e),{stylesheet:p,rules:g}=rs.get(d)||qf(d,e);g[f]||(g[f]=!0,p.insertRule(`@keyframes ${f} ${c}`,p.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${f} ${n}ms linear ${i}ms 1 both`,ns+=1,f}function va(e,t){const r=(e.style.animation||"").split(", "),n=r.filter(t?s=>s.indexOf(t)<0:s=>s.indexOf("__svelte")===-1),i=r.length-n.length;i&&(e.style.animation=n.join(", "),ns-=i,ns||jf())}function jf(){Ya(()=>{ns||(rs.forEach(e=>{const{ownerNode:t}=e.stylesheet;t&&ye(t)}),rs.clear())})}let Xa;function hi(e){Xa=e}const li=[],Yo=[],zi=[],Xo=[],zf=Promise.resolve();let Ca=!1;function Wf(){Ca||(Ca=!0,zf.then(Au))}function Jr(e){zi.push(e)}const Zs=new Set;let Pi=0;function Au(){const e=Xa;do{for(;Pi<li.length;){const t=li[Pi];Pi++,hi(t),Qf(t.$$)}for(hi(null),li.length=0,Pi=0;Yo.length;)Yo.pop()();for(let t=0;t<zi.length;t+=1){const r=zi[t];Zs.has(r)||(Zs.add(r),r())}zi.length=0}while(li.length);for(;Xo.length;)Xo.pop()();Ca=!1,Zs.clear(),hi(e)}function Qf(e){if(e.fragment!==null){e.update(),br(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(Jr)}}let ii;function Iu(){return ii||(ii=Promise.resolve(),ii.then(()=>{ii=null})),ii}function is(e,t,r){e.dispatchEvent($f(`${t?"intro":"outro"}${r}`))}const Wi=new Set;let Hr;function Lr(){Hr={r:0,c:[],p:Hr}}function Dr(){Hr.r||br(Hr.c),Hr=Hr.p}function Se(e,t){e&&e.i&&(Wi.delete(e),e.i(t))}function Ie(e,t,r,n){if(e&&e.o){if(Wi.has(e))return;Wi.add(e),Hr.c.push(()=>{Wi.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}else n&&n()}const ku={duration:0};function Za(e,t,r){let n=t(e,r),i=!1,s,a,o=0;function l(){s&&va(e,s)}function u(){const{delay:f=0,duration:d=300,easing:p=Ja,tick:g=et,css:m}=n||ku;m&&(s=xu(e,0,1,d,f,p,m,o++)),g(0,1);const T=Su()+f,x=T+d;a&&a.abort(),i=!0,Jr(()=>is(e,!0,"start")),a=wu(B=>{if(i){if(B>=x)return g(1,0),is(e,!0,"end"),l(),i=!1;if(B>=T){const v=p((B-T)/d);g(v,1-v)}}return i})}let c=!1;return{start(){c||(c=!0,va(e),Rs(n)?(n=n(),Iu().then(u)):u())},invalidate(){c=!1},end(){i&&(l(),i=!1)}}}function eo(e,t,r){let n=t(e,r),i=!0,s;const a=Hr;a.r+=1;function o(){const{delay:l=0,duration:u=300,easing:c=Ja,tick:f=et,css:d}=n||ku;d&&(s=xu(e,1,0,u,l,c,d));const p=Su()+l,g=p+u;Jr(()=>is(e,!1,"start")),wu(m=>{if(i){if(m>=g)return f(0,1),is(e,!1,"end"),--a.r||br(a.c),!1;if(m>=p){const T=c((m-p)/u);f(1-T,T)}}return i})}return Rs(n)?Iu().then(()=>{n=n(),o()}):o(),{end(l){l&&n.tick&&n.tick(1,0),i&&(s&&va(e,s),i=!1)}}}function _t(e){e&&e.c()}function pt(e,t,r,n){const{fragment:i,after_update:s}=e.$$;i&&i.m(t,r),n||Jr(()=>{const a=e.$$.on_mount.map(bu).filter(Rs);e.$$.on_destroy?e.$$.on_destroy.push(...a):br(a),e.$$.on_mount=[]}),s.forEach(Jr)}function gt(e,t){const r=e.$$;r.fragment!==null&&(br(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function Jf(e,t){e.$$.dirty[0]===-1&&(li.push(e),Wf(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Er(e,t,r,n,i,s,a,o=[-1]){const l=Xa;hi(e);const u=e.$$={fragment:null,ctx:[],props:s,update:et,not_equal:i,bound:Qo(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(l?l.$$.context:[])),callbacks:Qo(),dirty:o,skip_bound:!1,root:t.target||l.$$.root};a&&a(u.root);let c=!1;if(u.ctx=r?r(e,t.props||{},(f,d,...p)=>{const g=p.length?p[0]:d;return u.ctx&&i(u.ctx[f],u.ctx[f]=g)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](g),c&&Jf(e,f)),d}):[],u.update(),c=!0,br(u.before_update),u.fragment=n?n(u.ctx):!1,t.target){if(t.hydrate){const f=Hf(t.target);u.fragment&&u.fragment.l(f),f.forEach(ye)}else u.fragment&&u.fragment.c();t.intro&&Se(e.$$.fragment),pt(e,t.target,t.anchor,t.customElement),Au()}hi(l)}class Sr{$destroy(){gt(this,1),this.$destroy=et}$on(t,r){if(!Rs(r))return et;const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const i=n.indexOf(r);i!==-1&&n.splice(i,1)}}$set(t){this.$$set&&!Mf(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Yf(e){let t,r;return{c(){t=oe("span"),r=ft(e[0]),pe(t,"class","material-symbols-outlined")},m(n,i){me(n,t,i),se(t,r)},p(n,[i]){i&1&&qt(r,n[0])},i:et,o:et,d(n){n&&ye(t)}}}function Xf(e,t,r){let{id:n}=t;return e.$$set=i=>{"id"in i&&r(0,n=i.id)},[n]}class hr extends Sr{constructor(t){super(),Er(this,t,Xf,Yf,Dt,{id:0})}}const An=[];function Bu(e,t){return{subscribe:Wn(e,t).subscribe}}function Wn(e,t=et){let r;const n=new Set;function i(o){if(Dt(e,o)&&(e=o,r)){const l=!An.length;for(const u of n)u[1](),An.push(u,e);if(l){for(let u=0;u<An.length;u+=2)An[u][0](An[u+1]);An.length=0}}}function s(o){i(o(e))}function a(o,l=et){const u=[o,l];return n.add(u),n.size===1&&(r=t(i)||et),o(e),()=>{n.delete(u),n.size===0&&(r(),r=null)}}return{set:i,update:s,subscribe:a}}const Ru=["la","en","es","fr","lv"],Zf=e=>[[["1"],"",["prayer"]],[["2"],"",[e.period,"dialogue"]],[["3"],"",[e.period,"prayer"]]],eh="Alma Redemptoris Mater",th={name:eh},rh={description:["Period"],options:{before:"Up through the day before Christmas Eve",after:"From Christmas Eve on"}},nh={period:rh},ih="O Loving Mother of our Redeemer",sh=["Prayer","O loving Mother of our Redeemer, gate of heaven, star of the sea,","Hasten to aid thy fallen people who strive to rise once more.","Thou who brought forth thy holy Creator, all creation wond'ring,","Yet remainest ever Virgin, taking from Gabriel's lips",'that joyful "Hail!": be merciful to us sinners.'],ah={dialogue:["Dialogue","V. The Angel of the Lord declared unto Mary.","R. And she conceived by the Holy Spirit."],prayer:["Prayer","Let us pray. Pour forth, we beseech Thee, O Lord, Thy grace into our hearts, that we, to whom the incarnation of Christ, Thy Son, was made known by the message of an angel, may by His passion and cross be brought to the glory of His resurrection, through the same Christ our Lord. Amen."]},oh={dialogue:["Dialogue","V. Thou gavest birth without loss of thy virginity:","R. Intercede for us, O holy Mother of God."],prayer:["Prayer","Let us pray. O God, Who by the fruitful virginity of blessed Mary hast offered unto the human race the rewards of eternal salvation, grant, we beseech thee, that we may know the effects of her intercession, through whom we have deserved to receive the author of life, our Lord Jesus Christ, Thy Son. Amen."]},lh={_name:ih,prayer:sh,before:ah,after:oh},uh="Alma Redemptoris Mater",ch=["Oratio","Alma Redemptoris Mater, quae pervia caeli","Porta manes, et stella maris, sucurre cadenti,","Surgere qui curat populo: tu quae genuisti,","Natura mirante, tuum sanctum Genitorem,","Virgo prius ac posterius, Gabrielis ab ore","Sumens illud Ave, peccatorum miserere."],fh={dialogue:["Dialogus","V. Angelus Domini nuntiavit Mariae.","R. Et concepit de Spiritu Sancto."],prayer:["Oratio","Oremus. Gratiam tuam, quaesumus, Domine, mentibus nostris infunde; ut, qui, angelo nuntiante, Christi Filii tui incarnationem cognovimus, per passionem ejus et crucem, ad resurrectionis gloriam perducamur. Per eumdem Christum Dominum nostrum. Amen."]},hh={dialogue:["Dialogus","V. Post partum, Virgo, inviolata permansisti.","R. Dei Genitrix, intercede pro nobis."],prayer:["Oratio","Oremus. Deus, qui salutis aeternae, beatae Mariae virginitate fecudna, humano generi praemia praestitisti: tribue, quaesumus, ut ipsam pro nobis intercedere sentiamus, per quam meruimus auctorem vitae suscipere, Dominum nostrum Iesum Christum, Filium tuum. Amen."]},dh={_name:uh,prayer:ch,before:fh,after:hh},ph={generate:Zf,meta:th,params:nh,languages:{en:lh,la:dh}},gh=e=>[[["1"],"",["dialogue-1"]],[["2"],"hail-mary",["formula"]],[["3"],"",["dialogue-2"]],[["4"],"hail-mary",["formula"]],[["5"],"",["dialogue-3"]],[["6"],"hail-mary",["formula"]],[["7"],"",["dialogue-4"]],[["8"],"",["prayer"]]],yh="Angelus",mh={name:yh},vh={},Ch="The Angelus",bh=["Prayer","Let us pray. Pour forth, we beseech you, O Lord, your grace into our hearts: that we, to whom the Incarnation of Christ your Son was made known by the message of an Angel, may by his Passion and Cross be brought to the glory of his Resurrection. Through the same Christ our Lord. Amen."],Eh={_name:Ch,"dialogue-1":["Dialogue","V. The Angel of the Lord declared unto Mary,","R. And she conceived of the Holy Spirit."],"dialogue-2":["Dialogue","V. Behold the handmaid of the Lord,","R. Be it done unto me according to your Word."],"dialogue-3":["Dialogue","V. And the Word was made flesh,","R. And dwelt among us."],"dialogue-4":["Dialogue","V. Pray for us, O holy Mother of God,","R. That we may be made worthy of the promises of Christ."],prayer:bh},Sh="Angelus Domini",_h=["Oratio","Oremus. Gratiam tuam, quaesumus, Domine, mentibus nostris infunde; ut qui, Angelo nuntiante, Christi Filii tui incarnationem cognovimus, per passionem eius et crucem ad resurrectionis gloriam perducamur. Per eumdem Christum Dominum nostrum. Amen."],wh={_name:Sh,"dialogue-1":["Dialogus","V. Angelus Domini nuntiavit Mariae.","R. Et concepit de Spiritu Sancto."],"dialogue-2":["Dialogus","V. Ecce ancilla Domini,","R. Fiat mihi secundum verbum tuum."],"dialogue-3":["Dialogus","V. Et Verbum caro factum est,","R. Et habitavit in nobis."],"dialogue-4":["Dialogus","V. Ora pro nobis, sancta Dei Genetrix,","R. Ut digni efficiamur promissionibus Christi."],prayer:_h},Th={generate:gh,meta:mh,params:vh,languages:{en:Eh,la:wh}},xh=e=>[[["formula"],"",["formula"]]],Ah="Apostles' Creed",Ih={name:Ah},kh={},Bh="The Apostles' Creed",Rh=["The Apostles' Creed","I believe in God the Father Almighty, Creator of heaven and earth; and in Jesus Christ, His only Son, our Lord; Who was conceived by the Holy Spirit, born of the Virgin Mary, suffered under Pontius Pilate, was crucified, died and was buried. He descended into hell; the third day He rose again from the dead; He ascended into heaven and sits at the right hand of God, the Father Almighty; from thence He shall come to judge the living and the dead.","I believe the Holy Spirit, the holy Catholic Church, the communion of saints, the forgiveness of sins, the resurrection of the body, and life everlasting. Amen."],Nh={_name:Bh,formula:Rh},Lh="El Credo de los Ap\xF3stoles",Dh=["El Credo de los Ap\xF3stoles","Creo en Dios Padre, Todopoderoso, Creador del cielo y de la tierra. Y en Jesucristo, su \xFAnico Hijo, Nuestro Se\xF1or, que fue concebido por obra y gracia del Esp\xEDritu Santo, naci\xF3 de Santa Mar\xEDa Virgen, padeci\xF3 bajo el poder de Poncio Pilato, fue crucificado, muerto y sepultado, descendi\xF3 a los infiernos, al tercer d\xEDa resucit\xF3 entre los muertos, subi\xF3 a los cielos y est\xE1 sentado a la derecha de Dios Padre, Todopoderoso. Desde all\xED vendr\xE1 a juzgar a vivos y a muertos.","Creo en el Esp\xEDritu Santo, la Santa Iglesia Cat\xF3lica, la comuni\xF3n de los santos, el perd\xF3n de los pecados, la resurrecci\xF3n de la carne y la vida perdurable. Am\xE9n."],Uh={_name:Lh,formula:Dh},Oh="Symbole des Ap\xF4tres",Mh=["Symbole des Ap\xF4tres","Je crois en Dieu, le P\xE8re tout-puissant, Cr\xE9ateur du ciel et de la terre. Et en J\xE9sus Christ, son Fils unique, notre Seigneur ; qui a \xE9t\xE9 con\xE7u du Saint Esprit, est n\xE9 de la Vierge Marie, a souffert sous Ponce Pilate, a \xE9t\xE9 crucifi\xE9, est mort et a \xE9t\xE9 enseveli, est descendu aux enfers ; le troisi\xE8me jour est ressuscit\xE9 des morts, est mont\xE9 aux cieux, est assis \xE0 la droite de Dieu le P\xE8re tout-puissant, d\u2019o\xF9 il viendra juger les vivants et les morts.","Je crois en l\u2019Esprit Saint, \xE0 la sainte \xC9glise catholique, \xE0 la communion des saints, \xE0 la r\xE9mission des p\xE9ch\xE9s, \xE0 la r\xE9surrection de la chair, \xE0 la vie \xE9ternelle. Amen."],Ph={_name:Oh,formula:Mh},Fh="Symbolum Apostolicum",Vh=["Symbolum Apostolicum","Credo in Deum, Patrem omnipotentem, creatorem caeli et terrae. Et in Iesum Christum, Filium eius unicum, Dominum nostrum, qui conceptus est de Spiritu Sancto, natus ex Maria Virgine, passus sub Pontio Pilato, crucifixus, mortuus et sepultus. Descendit ad inferos, tertia die resurrexit a mortuis. Ascendit ad caelos, sedet ad dextram Dei Patris omnipotentis. Inde venturus est iudicare vivos et mortuos.","Credo in Spiritum Sanctum, sanctam Ecclesiam catholicam, sanctorum communionem, remissionem peccatorum, carnis resurrectionem, vitam aeternam. Amen."],Kh={_name:Fh,formula:Vh},Hh="Tic\u012Bbas apliecin\u0101jums",$h=["Tic\u012Bbas apliecin\u0101jums","Es ticu uz Dievu, visvareno T\u0113vu, debesu un zemes Rad\u012Bt\u0101ju, un uz J\u0113zu Kristu, Vi\u0146a vienpiedzimu\u0161o D\u0113lu, m\u016Bsu Kungu, kas ir ie\u0146emts no Sv\u0113t\u0101 Gara, piedzimis no Jaunavas Marijas, cietis zem Poncija Pil\u0101ta, krust\u0101 sists, nomiris un apbed\u012Bts, nok\u0101pis ell\u0113, tre\u0161aj\u0101 dien\u0101 aug\u0161\u0101mc\u0113lies no miru\u0161ajiem, uzk\u0101pis debes\u012Bs, s\u0113\u017E pie Dieva, visvaren\u0101 T\u0113va, lab\u0101s rokas, no kurienes Vi\u0146\u0161 atn\u0101ks ties\u0101t dz\u012Bvos un miru\u0161os.","Es ticu uz Sv\u0113to Garu, sv\u0113to katolisko Bazn\u012Bcu, sv\u0113to sadraudz\u012Bbu, gr\u0113ku piedo\u0161anu, miesas aug\u0161\u0101mcel\u0161anos un m\u016B\u017E\u012Bgo dz\u012Bvo\u0161anu. Amen."],Gh={_name:Hh,formula:$h},qh={generate:xh,meta:Ih,params:kh,languages:{en:Nh,es:Uh,fr:Ph,la:Kh,lv:Gh}},jh=e=>[[["1"],"",["prayer-1"]],[["2"],"",["prayer-2"]],[["3"],"",["dialogue"]],[["4"],"",["prayer"]]],zh="Ave Regina caelorum",Wh={name:zh},Qh={},Jh="Hail, O Queen of Heaven",Yh=["Dialogus","V. Allow me to praise thee, O sacred Virgin.","R. Against thy enemies give me strength."],Xh=["Oratio","Let us pray. Grant unto us, O merciful God, a defense against our weakness, that we who remember the holy Mother of God, by the help of her intercession, may rise from our iniquities, through the same Christ our Lord. Amen."],Zh={_name:Jh,"prayer-1":["Prayer","Welcome, O Queen of Heaven.","Welcome, O Lady of Angels","Hail! thou root, hail! thou gate","From whom unto the world, a light has arisen:"],"prayer-2":["Prayer","Rejoice, O glorious Virgin,","Lovely beyond all others,","Farewell, most beautiful maiden,","And pray for us to Christ."],dialogue:Yh,prayer:Xh},ed="Ave Regina caelorum",td=["Dialogus","V. Dignare me laudare te, Virgo sacrata.","R. Da mihi virtutem contra hostes tuos."],rd=["Oratio","Oremus. Concede, misericors Deus, fragilitati nostrae praesidium: ut, qui sanctae Dei Genitricis memoriam agimus; intercessionis eius auxilio, a nostris iniquitatibus resurgamus. Per eundem Christum Dominum nostrum. Amen."],nd={_name:ed,"prayer-1":["Oratio","Ave, Regina caelorum,","Ave, Domina Angelorum:","Salve, radix, salve, porta","Ex qua mundo lux est orta:"],"prayer-2":["Oratio","Gaude, Virgo gloriosa,","Super omnes speciosa,","Vale, o valde decora,","Et pro nobis Christum exora."],dialogue:td,prayer:rd},id={generate:jh,meta:Wh,params:Qh,languages:{en:Zh,la:nd}},sd=e=>{let t=[[["initial","1"],"lords-prayer",["formula"]],[["initial","2"],"hail-mary",["formula"]],[["initial","3"],"apostles-creed",["formula"]]];for(let r=0;r<5;r++){t.push([["decades",[r,5],"our-father-bead"],"",["our-father-bead"],"On the Our Father bead, say this prayer"]);for(let n=0;n<10;n++)t.push([["decades",[r,5],"hail-mary-bead",[n,10]],"",["hail-mary-bead"],"On the Hail Mary bead, say this prayer"])}for(let r=0;r<3;r++)t.push([["concluding",[r,3]],"",["concluding-prayer"]]);return t},ad="Chaplet of Divine Mercy",od={name:ad},ld={},ud="The Chaplet of Divine Mercy",cd={_name:ud,"our-father-bead":["Prayer","Eternal Father, I offer you the Body and Blood, Soul and Divinity of Your Dearly Beloved Son, Our Lord, Jesus Christ, in atonement for our sins and those of the whole world."],"hail-mary-bead":["Prayer","For the sake of His sorrowful Passion, have mercy on us and on the whole world."],"concluding-prayer":["Prayer","Holy God, Holy Mighty One, Holy Immortal One, have mercy on us and on the whole world."]},fd="Corona Divinae Misericordiae",hd={_name:fd,"our-father-bead":["Oratio","Pater aeterne, offero tibi Corpus et Sanguinem, animam et divinitatem dilectissimi Filii Tui, Domini nostri, Iesu Christi, in propitiatione pro peccatis nostris et totius mundi."],"hail-mary-bead":["Oratio","Pro dolorosa Eius passione, miserere nobis et totius mundi."],"concluding-prayer":["Oratio","Sanctus Deus, Sanctus Fortis, Sanctus Immortalis, miserere nobis et totius mundi."]},dd={generate:sd,meta:od,params:ld,languages:{en:cd,la:hd}},pd=e=>[[["formula"],"",["formula"]]],gd="Fatima Prayer",yd={name:gd},md={},vd="Fatima Prayer",Cd=["Fatima Prayer","O my Jesus, forgive us our sins, save us from the fires of hell, and lead all souls to heaven, especially those most in need of Thy mercy."],bd={_name:vd,formula:Cd},Ed="Oraci\xF3n de F\xE1tima",Sd=["Oraci\xF3n de F\xE1tima","\xA1Oh! Jes\xFAs m\xEDo, perdona nuestros pecados, l\xEDbranos del fuego del infierno, lleva al cielo a todas las almas, especialmente a las m\xE1s necesitadas de Tu misericordia."],_d={_name:Ed,formula:Sd},wd="Pri\xE8re de Fatima",Td=["Pri\xE8re de Fatima","\xD4 mon J\xE9sus, pardonnez-nous nos p\xE9ch\xE9s, pr\xE9servez-nous du feu de l'enfer, et conduisez au Ciel toutes les \xE2mes, sp\xE9cialement celles qui ont le plus besoin de votre mis\xE9ricorde."],xd={_name:wd,formula:Td},Ad="Oratio Fatima",Id=["Oratio Fatima","Domine Iesu, dimitte nobis debita nostra, salva nos ab igne inferiori, perduc in caelum omnes animas, praesertim eas quae misericordiae tuae maximae indigent."],kd={_name:Ad,formula:Id},Bd="Fatimas l\u016Bg\u0161ana",Rd=["Fatimas l\u016Bg\u0161ana","Mans J\u0113zu, piedod mums m\u016Bsu vainas, pasargi m\u016Bs no elles uguns un aizved visas dv\u0113seles uz debes\u012Bm, it sevi\u0161\u0137i t\u0101s, kur\u0101m visvair\u0101k vajadz\u012Bga Tava \u017E\u0113lsird\u012Bba."],Nd={_name:Bd,formula:Rd},Ld={generate:pd,meta:yd,params:md,languages:{en:bd,es:_d,fr:xd,la:kd,lv:Nd}},Dd=e=>[[["formula"],"",["formula"]]],Ud="Glory Be",Od={name:Ud},Md={},Pd="Glory be to the Father",Fd=["Glory be to the Father","Glory be to the Father, and to the Son, and to the Holy Spirit.","As it was in the beginning, is now, and ever shall be, world without end. Amen."],Vd={_name:Pd,formula:Fd},Kd="Gloria al Padre",Hd=["Gloria al Padre","Gloria al Padre y al Hijo y al Esp\xEDritu Santo.","Como era en el principio, ahora y siempre, por los siglos de los siglos. Am\xE9n."],$d={_name:Kd,formula:Hd},Gd="Gloire au P\xE8re",qd=["Gloire au P\xE8re","Gloire au P\xE8re et au Fils at au Saint-Esprit.","Comme il \xE9tait au commencement, maintenant et toujours, et dans les si\xE8cles des si\xE8cles. Amen."],jd={_name:Gd,formula:qd},zd="Gloria Patri",Wd=["Gloria Patri","Gloria Patri, et Filio, et Spiritui Sancto.","Sicut erat in principio, et nunc, et semper, et in saecula saeculorum. Amen."],Qd={_name:zd,formula:Wd},Jd="Gods lai ir T\u0113vam",Yd=["Gods lai ir T\u0113vam","Gods lai ir T\u0113vam un D\u0113lam, un Sv\u0113tajam Garam.","K\u0101 tas no ies\u0101kuma bijis, t\u0101 tagad un vienm\u0113r, un m\u016B\u017E\u012Bgi m\u016B\u017Eam. Amen."],Xd={_name:Jd,formula:Yd},Zd={generate:Dd,meta:Od,params:Md,languages:{en:Vd,es:$d,fr:jd,la:Qd,lv:Xd}},e0=e=>[[["formula"],"",["formula"]]],t0="Hail Mary",r0={name:t0},n0={},i0="Hail Mary",s0=["Hail Mary","Hail, Mary, full of grace; the Lord is with thee; blessed art thou among women, and blessed is the fruit of thy womb, Jesus.","Holy Mary, Mother of God, pray for us sinners, now and at the hour of our death. Amen."],a0={_name:i0,formula:s0},o0="Ave Mar\xEDa",l0=["Ave Mar\xEDa","Dios te salve, Mar\xEDa; llena eres de gracia; el Se\xF1or es contigo; bendita t\xFA eres entre todas las mujeres, y bendito es el fruto de tu vientre, Jes\xFAs.","Santa Mar\xEDa, Madre de Dios, ruega por nosotros, pecadores, ahora y en la hora de nuestra muerte. Am\xE9n."],u0={_name:o0,formula:l0},c0="Je vous salue Marie",f0=["Je vous salue Marie","Je vous salue, Marie, pleine de gr\xE2ces, le Seigneur est avec vous, vous \xEAtes b\xE9nie entre toutes les femmes, et J\xE9sus, le fruit de vos entrailles, est b\xE9ni.","Sainte Marie, M\xE8re de Dieu, priez pour nous, pauvres p\xE9cheurs, maintenant, et \xE0 l'heure de notre mort. Amen."],h0={_name:c0,formula:f0},d0="Ave Maria",p0=["Ave Maria","Ave Maria, gratia plena: Dominus tecum, benedicta tu in mulieribus, et benedictus fructus ventris tui, Iesus.","Sancta Maria, Mater Dei, ora pro nobis peccatoribus, nunc et in hora mortis nostrae. Amen."],g0={_name:d0,formula:p0},y0="Esi sveicin\u0101ta, Marija",m0=["Esi sveicin\u0101ta, Marija","Esi sveicin\u0101ta, Marija, \u017E\u0113last\u012Bbas piln\u0101, Kungs ir ar Tevi; Tu esi sv\u0113t\u012Bta starp sieviet\u0113m, un sv\u0113t\u012Bts ir Tavas miesas auglis J\u0113zus.","Sv\u0113t\u0101 Marija, Dieva M\u0101te, l\u016Bdz par mums, gr\u0113ciniekiem, tagad un m\u016Bsu n\u0101ves stund\u0101. Amen."],v0={_name:y0,formula:m0},C0={generate:e0,meta:r0,params:n0,languages:{en:a0,es:u0,fr:h0,la:g0,lv:v0}},b0=e=>[[["formula"],"",["formula"]]],E0="Lord's Prayer",S0={name:E0},_0={},w0="Lord's Prayer",T0=["Lord's Prayer","Our Father, Who art in heaven, hallowed by Thy name, Thy kingdom come; Thy will be done on earth as it is in heaven.","Give us this day our daily bread; and forgive us our trespasses, as we forgive those who trespass against us. And lead us not into temptation; but deliver us from evil. Amen."],x0={_name:w0,formula:T0},A0="Padrenuestro",I0=["Padrenuestro","Padre Nuestro, que est\xE1s en el cielo, santificado sea tu nombre venga a nosotros tu reino; h\xE1gase tu voluntad, en la tierra como en el cielo.","Danos hoy nuestro pan de cada d\xEDa; perdona nuestras ofensas, como tambi\xE9n nosotros perdonamos a los que nos ofenden; no nos dejes caer en la tentaci\xF3n, y l\xEDbranos del mal. Am\xE9n."],k0={_name:A0,formula:I0},B0="Notre P\xE8re",R0=["Notre P\xE8re","Notre P\xE8re, qui es aux cieux, que ton nom soit sanctifi\xE9, que ton r\xE8gne vienne, que ta volont\xE9 soit faite sur la terre comme au ciel.","Donne-nous aujourd'hui notre pain de ce jour, pardonne-nous nos offenses, comme nous pardonnons aussi \xE0 ceux qui nous ont offens\xE9s, et ne nous laisse pas entrer en tentation, mais d\xE9livre-nous du mal. Amen."],N0={_name:B0,formula:R0},L0="Dominica oratio",D0=["Dominica oratio","Pater noster, qui es in caelis: Sanctificetur nomen tuum: Adveniat regnum tuum: Fiat voluntas tua, sicut in caelo, et in terra.","Panem nostrum quotidianum da nobis hodie: Et dimitte nobis debita nostra, sicut et nos dimittimus debitoribus nostris. Et ne nos inducas in tentationem, sed libera nos a malo. Amen."],U0={_name:L0,formula:D0},O0="Kunga J\u0113zus l\u016Bg\u0161ana",M0=["Kunga J\u0113zus l\u016Bg\u0161ana","T\u0113vs m\u016Bsu, kas esi debes\u012Bs, sv\u0113t\u012Bts lai top Tavs v\u0101rds, lai atn\u0101k Tava valst\u012Bba, Tavs pr\u0101ts lai notiek k\u0101 debes\u012Bs, t\u0101 ar\u012B virs zemes.","M\u016Bsu dieni\u0161\u0137o maizi dod mums \u0161odien un piedod mums m\u016Bsu par\u0101dus, k\u0101 ar\u012B m\u0113s piedodam saviem par\u0101dniekiem, un neieved m\u016Bs k\u0101rdin\u0101\u0161an\u0101, bet atpest\u012B m\u016Bs no \u013Cauna. Amen."],P0={_name:O0,formula:M0},F0={generate:b0,meta:S0,params:_0,languages:{en:x0,es:k0,fr:N0,la:U0,lv:P0}},V0=e=>[[["1"],"",["dialogue"]],[["2"],"",["prayer"]]],K0="Regina caeli",H0={name:K0},$0={},G0="Queen of Heaven",q0=["Dialogue","V. Queen of Heaven, rejoice, alleluia.","R. For He whom you did merit to bear, alleluia.","V. Has risen, as he said, alleluia.","R. Pray for us to God, alleluia.","V. Rejoice and be glad, O Virgin Mary, alleluia.","R. For the Lord has truly risen, alleluia."],j0=["Prayer","Let us pray. O God, who gave joy to the world through the resurrection of Thy Son, our Lord Jesus Christ, grant we beseech Thee, that through the intercession of the Virgin Mary, His Mother, we may obtain the joys of everlasting life. Through the same Christ our Lord. Amen."],z0={_name:G0,dialogue:q0,prayer:j0},W0="Regina caeli",Q0=["Dialogus","V. Regina caeli, laetare, alleluia.","R. Quia quem meruisti portare, alleluia.","V. Resurrexit, sicut dixit, alleluia.","R. Ora pro nobis Deum, alleluia.","V. Gaude et laetare, Virgo Maria, alleluia.","R. Quia surrexit Dominus vere, alleluia."],J0=["Oratio","Oremus. Deus, qui per resurrectionem Filii tui, Domini nostri Iesu Christi, mundum laetificare dignatus es: praesta, quaesumus; ut per eius Genetricem Virginem Mariam, perpetuae capiamus gaudia vitae. Per eundem Christum Dominum nostrum. Amen."],Y0={_name:W0,dialogue:Q0,prayer:J0},X0={generate:V0,meta:H0,params:$0,languages:{en:z0,la:Y0}},Z0=e=>{let t;e["glory-be"]=="good-friday"?t=["",["good-friday"]]:e["glory-be"]=="holy-saturday"?t=["",["holy-saturday"]]:t=["glory-be",["formula"]];let r;const n=e.weekday;n=="mon"||n=="sat"||n=="sun-advent-christmas"?r="joyful-mysteries":n=="tue"||n=="fri"||n=="sun-lent"?r="sorrowful-mysteries":n=="wed"||n=="sun"?r="glorious-mysteries":r="luminous-mysteries";let i=[[["initial","1"],"",[r,"introduction"]],[["initial","2"],"sign-of-the-cross",["formula"]],[["initial","3"],"apostles-creed",["formula"],"Holding the Crucifix, say the Apostles' Creed"],[["initial","4"],"lords-prayer",["formula"],"On the first bead, say an Our Father"]];for(let s=0;s<3;s++)i.push([["initial","5",[s,3]],"hail-mary",["formula"],"Say one Hail Mary on each of the next three beads"]);i.push([["initial","6"]].concat(t));for(let s=0;s<5;s++){i=i.concat([[["decades",[s,5],"introduction"],"",[r,(s+1).toString(),"introduction"],"Announce the Mystery"],[["decades",[s,5],"scripture"],"",[r,(s+1).toString(),"scripture"],"Optionally, have a brief reading from the Scripture"],[["decades",[s,5],"lords-prayer"],"lords-prayer",["formula"]]]);for(let a=0;a<10;a++)i.push([["decades",[s,5],"hail-mary",[a,10]],"hail-mary",["formula"],"Say ten Hail Marys while meditating on the Mystery"]);i=i.concat([[["decades",[s,5],"glory-be"]].concat(t),[["decades",[s,5],"fatima-prayer"],"fatima-prayer",["formula"],"Optionally, say the Fatima Prayer"]])}return i=i.concat([[["concluding","salve-regina","prayer"],"salve-regina",["prayer"]],[["concluding","salve-regina","dialogue"],"salve-regina",["dialogue"]],[["concluding","salve-regina","concluding-prayer"],"",["salve-regina-concluding-prayer"]],[["concluding","prayer-to-st-joseph"],"",["prayer-to-st-joseph"],"Optionally, say the prayer to St Joseph"],[["concluding","sign-of-the-cross"],"sign-of-the-cross",["formula"]]]),i},ep="Rosary",tp={name:ep},rp={description:["Day of the week"],options:{sun:"Sunday",mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday","sun-advent-christmas":"Sunday of Advent or Christmas","sun-lent":"Sunday of Lent"}},np={weekday:rp,"glory-be":{description:["Glory Be"],options:{regular:"Regular","good-friday":"Good Friday","holy-saturday":"Holy Saturday"}}},ip="The Rosary",sp={_name:ip,"salve-regina-concluding-prayer":["Prayer","Let us pray. O God, Whose Only-Begotten Son, by His life, death and resurrection, has purchased for us the rewards of eternal life: grant, we beseech Thee, that by meditating upon these mysteries of the most holy Rosary of the Blessed Virgin Mary, we may imitate what they contain, and obtain what they promise, through the same Christ our Lord. Amen."],"prayer-to-st-joseph":["Prayer to Saint Joseph","To you, O blessed Joseph, do we come in our tribulation, and having implored the help of your most holy Spouse, we confidently invoke your patronage also.","Through that charity which bound you to the Immaculate Virgin Mother of God and through the paternal love with which you embraced the Child Jesus, we humbly beg you graciously to regard the inheritance which Jesus Christ has purchased by his Blood, and with your power and strength to aid us in our necessities.","O most watchful guardian of the Holy Family, defend the chosen children of Jesus Christ; O most loving father, ward off from us every contagion of error and corrupting influence; O our most mighty protector, be kind to us and from heaven assist us in our struggle with the power of darkness.","As once you rescued the Child Jesus from deadly peril, so now protect God's Holy Church from the snares of the enemy and from all adversity; shield, too, each one of us by your constant protection, so that, supported by your example and your aid, we may be able to live piously, to die in holiness, and to obtain eternal happiness in heaven.","Amen."],"good-friday":["Dialogue","V. Christ became obedient for us unto death.","R. Even unto death on the Cross."],"holy-saturday":["Dialogue","V. Christ became obedient for us unto death, even unto death on the Cross.","R. For which God hath exalted Him and hath given Him a name which is above all names."],"joyful-mysteries":{1:{introduction:["The Annunciation","First Joyful Mystery","Him Whom thou didst conceive.","Fruit of the mystery: Humility"],scripture:["[Mt 1:18, Lk 1:26-38]"]},2:{introduction:["The Visitation","Second Joyful Mystery","Him Whom thou didst carry while visiting Elizabeth.","Fruit of the mystery: Love of Neighbor"],scripture:["[Lk 1:39-45]"]},3:{introduction:["The Nativity","Third Joyful Mystery","Him Whom thou didst give birth to.","Fruit of the mystery: Poverty"],scripture:["[Lk 2:6-12]"]},4:{introduction:["The Presentation in the Temple","Fourth Joyful Mystery","Him Whom thou didst present in the temple.","Fruit of the mystery: Purity of Heart and Body"],scripture:["[Lk 2:25-32]"]},5:{introduction:["The Finding in the Temple","Fifth Joyful Mystery","Him Whom thou didst find in the temple.","Fruit of the mystery: Devotion to Jesus"],scripture:["[Lk 2:41-50]"]},introduction:["Joyful Mysteries"]},"luminous-mysteries":{1:{introduction:["The Baptism of Christ in the Jordan","First Luminous Mystery","He Who was baptized in the Jordan.","Fruit of the mystery: Openness to the Holy Spirit"],scripture:["[Mt 3:13, Mk 1:9, Jn 1:29]"]},2:{introduction:["The Wedding Feast at Cana","Second Luminous Mystery","He Who revealed Himself at the wedding feast of Cana.","Fruit of the mystery: To Jesus through Mary"],scripture:["[Jn 2:1-11]"]},3:{introduction:["Jesus' Proclamation of the Coming of the Kingdom of God","Third Luminous Mystery","He who announced the Kingdom of God.","Fruit of the mystery: Conversion"],scripture:["[Mk 1:15, Lk 10:8-11]"]},4:{introduction:["The Transfiguration","Fourth Luminous Mystery","He Who was transfigured.","Fruit of the mystery: Desire for holiness"],scripture:["[Mt 17:1-8, Mk 9:2-9]"]},5:{introduction:["The Institution of the Eucharist","Fifth Luminous Mystery","He Who instituted the Eucharist.","Fruit of the mystery: Adoration"],scripture:["[Jn 6:27-59, Mt 26:26-29, Mk 14:22-24, Lk 22:15-20]"]},introduction:["Luminous Mysteries"]},"sorrowful-mysteries":{1:{introduction:["The Agony in the Garden","First Sorrowful Mystery","He Who sweated blood for us.","Fruit of the mystery: Obedience to God\u2019s Will"],scripture:["[Lc 22:39-46]"]},2:{introduction:["The Scourging at the Pillar","Second Sorrowful Mystery","He Who was scourged for us.","Fruit of the mystery: Mortification"],scripture:["[Mt 27:26, Mk 15:6-15, Jn 19:1]"]},3:{introduction:["The Crowning with Thorns","Third Sorrowful Mystery","He Who was crowned with thorns for us.","Fruit of the mystery: Courage"],scripture:["[Jn 19:1-8]"]},4:{introduction:["The Carrying of the Cross","Fourth Sorrowful Mystery","He Who carried the Cross for us.","Fruit of the mystery: Patience"],scripture:["[Jn 19:16-22]"]},5:{introduction:["The Crucifixion and Death","Fifth Sorrowful Mystery","He Who was crucified for us.","Fruit of the mystery: Sorrow for our Sins"],scripture:["[Jn 19:25-30]"]},introduction:["Sorrowful Mysteries"]},"glorious-mysteries":{1:{introduction:["The Resurrection","First Glorious Mystery","He Who arose from the dead.","Fruit of the mystery: Faith"],scripture:["[Mk 16:1-7]"]},2:{introduction:["The Ascension","Second Glorious Mystery","He Who ascended into heaven.","Fruit of the mystery: Hope"],scripture:["[Lk 24:46-53]"]},3:{introduction:["The Descent of the Holy Spirit","Third Glorious Mystery","He Who sent the Holy Spirit.","Fruit of the mystery: Wisdom"],scripture:["[Act 2:1-7]"]},4:{introduction:["The Assumption","Fourth Glorious Mystery","He Who assumed thee into heaven.","Fruit of the mystery: Devotion to Mary"],scripture:["[Ps 16:10]"]},5:{introduction:["The Coronation of Mary","Fifth Glorious Mystery","He Who crowned thee Queen of Heaven.","Fruit of the mystery: Grace of a happy death"],scripture:["[Rev 12:1]"]},introduction:["Glorious Mysteries"]}},ap="El Rosario",op={_name:ap,"salve-regina-concluding-prayer":["Oraci\xF3n","Oremos. Te pedimos, Se\xF1or, nos concedas a nosotros tus siervos, gozar de perpetua salud de alma y cuerpo, y por la gloriosa intercesi\xF3n de la bienaventurada siempre Virgen Mar\xEDa, seamos librados de las tristezas presentes y gocemos de la eterna alegr\xEDa. Por Jesucristo, nuestro Se\xF1or. Am\xE9n."],"prayer-to-st-joseph":["Oraci\xF3n a San Jos\xE9","A ti, bienaventurado san Jos\xE9, acudimos en nuestra tribulaci\xF3n, y despu\xE9s de implorar el auxilio de tu sant\xEDsima esposa, solicitamos tambi\xE9n confiadamente tu patrocinio.","Con aquella caridad que te tuvo unido con la Inmaculada Virgen Mar\xEDa, Madre de Dios, y por el paterno amor con que abrazaste al Ni\xF1o Jes\xFAs, humildemente te suplicamos que vuelvas benigno los ojos a la herencia que con su Sangre adquiri\xF3 Jesucristo, y con tu poder y auxilio socorras nuestras necesidades.","Protege, oh provident\xEDsimo Custodio de la divina Familia, la escogida descendencia de Jesucristo; aleja de nosotros, oh padre amant\xEDsimo, este flagelo de errores y vicios.","As\xEDstenos propicio desde el cielo, en esta lucha contra el poder de las tinieblas; y como en otro tiempo libraste de la muerte la vida amenazada del Ni\xF1o Jes\xFAs, as\xED ahora defiende a la santa Iglesia de Dios de las hostiles insidias y de toda adversidad. Y a cada uno de nosotros prot\xE9genos con tu constante patrocinio, para que, a ejemplo tuyo, y sostenidos por tu auxilio, podamos vivir y morir santamente y alcanzar en los cielos la eterna bienaventuranza.","Am\xE9n."],"good-friday":["Di\xE1logo","V. Christ became obedient for us unto death.","R. Even unto death on the Cross."],"holy-saturday":["Di\xE1logo","V. Christ became obedient for us unto death, even unto death on the Cross.","R. For which God hath exalted Him and hath given Him a name which is above all names."],"joyful-mysteries":{1:{introduction:["La Encarnaci\xF3n del Hijo de Dios","Primer Misterio Gozoso","Him Whom thou didst conceive.","Fruit of the mystery: Humility"],scripture:["[Lc 1,26-27]"]},2:{introduction:["La Visitaci\xF3 de Nuestra Se\xF1ora a su prima Santa Isabel","Segundo Misterio Gozoso","Him Whom thou didst carry while visiting Elizabeth.","Fruit of the mystery: Love of Neighbor"],scripture:["[Lc 1, 39-42]"]},3:{introduction:["El Nacimiento del Hijo de Dios en el portal de Bel\xE9n","Tercer Misterio Gozoso","Him Whom thou didst give birth to.","Fruit of the mystery: Poverty"],scripture:["[Lc 2,1-7]"]},4:{introduction:["La presentaci\xF3n de Jes\xFAs en el Templo","Cuarto Misterio Gozoso","Him Whom thou didst present in the temple.","Fruit of the mystery: Purity of Heart and Body"],scripture:["[Lc 2, 21-24]"]},5:{introduction:["El Ni\xF1o Jes\xFAs perdido y hallado en el Templo","Quinto Misterio Gozoso","Him Whom thou didst find in the temple.","Fruit of the mystery: Devotion to Jesus"],scripture:["[Lc 2, 41-47]"]},introduction:["Misterios Gozosos"]},"luminous-mysteries":{1:{introduction:["El Bautismo en el Jord\xE1n","Primer Misterio Luminoso","He Who was baptized in the Jordan.","Fruit of the mystery: Openness to the Holy Spirit"],scripture:["[Mt 3,16-17]"]},2:{introduction:["Las bodas de Can\xE1","Segundo Misterio Luminoso","He Who revealed Himself at the wedding feast of Cana.","Fruit of the mystery: To Jesus through Mary"],scripture:["[Jn 2, 1-5]"]},3:{introduction:["El anuncio del Reino de Dios","Tercer Misterio Luminoso","He who announced the Kingdom of God.","Fruit of the mystery: Conversion"],scripture:["[Mc 1, 15]"]},4:{introduction:["La Transfiguraci\xF3n","Cuarto Misterio Luminoso","He Who was transfigured.","Fruit of the mystery: Desire for holiness"],scripture:["[Mt 17, 1-2]"]},5:{introduction:["La instituci\xF3n de la Eucarist\xEDa","Quinto Misterio Luminoso","He Who instituted the Eucharist.","Fruit of the mystery: Adoration"],scripture:["[Mt 26, 26]"]},introduction:["Misterios Luminosos"]},"sorrowful-mysteries":{1:{introduction:["La oraci\xF3n en el Huerto","Primer Misterio Doloroso","He Who sweated blood for us.","Fruit of the mystery: Obedience to God\u2019s Will"],scripture:["[Mt 26, 36-39]"]},2:{introduction:["La flagelaci\xF3n de Jes\xFAs atado a la columna","Segundo Misterio Doloroso","He Who was scourged for us.","Fruit of the mystery: Mortification"],scripture:["[Mt 27, 26]"]},3:{introduction:["La coronaci\xF3n de espinas","Tercer Misterio Doloroso","He Who was crowned with thorns for us.","Fruit of the mystery: Courage"],scripture:["[Mt 27, 27-29]"]},4:{introduction:["Jes\xFAs con la Cruz a cuestas camino del Calvario","Cuarto Misterio Doloroso","He Who carried the Cross for us.","Fruit of the mystery: Patience"],scripture:["[Mc 15, 21-22]"]},5:{introduction:["La crucifixi\xF3n y muerte de Jes\xFAs","Quinto Misterio Doloroso","He Who was crucified for us.","Fruit of the mystery: Sorrow for our Sins"],scripture:["[Lc  23, 33-46]"]},introduction:["Misterios Dolorosos"]},"glorious-mysteries":{1:{introduction:["La resurrecci\xF3n del Hijo de Dios","Primer Misterio Glorioso","He Who arose from the dead.","Fruit of the mystery: Faith"],scripture:["[Lc 24, 1-6]"]},2:{introduction:["La Ascensi\xF3n del Se\xF1or al cielo","Segundo Misterio Glorioso","He Who ascended into heaven.","Fruit of the mystery: Hope"],scripture:["[Mc 16, 19]"]},3:{introduction:["La venida del Esp\xEDritu Santo","Tercer Misterio Glorioso","He Who sent the Holy Spirit.","Fruit of the mystery: Wisdom"],scripture:["[Hch 2, 1-4]"]},4:{introduction:["La Asunci\xF3n de Mar\xEDa al cielo","Cuarto Misterio Glorioso","He Who assumed thee into heaven.","Fruit of the mystery: Devotion to Mary"],scripture:["[Lc 1, 48-49]"]},5:{introduction:["La coronaci\xF3n de Mar\xEDa como Reina y Se\xF1ora de todo lo creado","Quinto Misterio Glorioso","He Who crowned thee Queen of Heaven.","Fruit of the mystery: Grace of a happy death"],scripture:["[Ap 12, 1]"]},introduction:["Misterios Gloriosos"]}},lp="Le Rosaire",up={_name:lp,"salve-regina-concluding-prayer":["Pri\xE8re","Prions: O Dieu dont le Fils unique, par sa vie, sa mort et sa r\xE9surrection, nous a m\xE9rit\xE9, les r\xE9compenses du salut \xE9ternel, faites que, m\xE9ditant ses myst\xE8res dans le tr\xE8s saint Rosaire de la bienheureuse Vierge Marie, nous mettions \xE0 profit les le\xE7ons qu'ils contiennent afin d'obtenir ce qu'ils nous font esp\xE9rer. Par la m\xE9me J\xE9sus-Christ, votre Fils notre Seigneur. Amen."],"prayer-to-st-joseph":["Prayer to Saint Joseph","\xD4 bienheureux Joseph, nous recourons \xE0 vous dans notre tribulation et, apr\xE8s avoir implor\xE9 le secours de votre tr\xE8s sainte Epouse, nous sollicitons aussi avec confiance votre protection.","Par l'affection qui vous a uni \xE0 la Vierge Immacul\xE9e M\xE8re de Dieu, par l'amour paternel dont vous avez entour\xE9 l'Enfant J\xE9sus, nous vous supplions de regarder avec bont\xE9 l'h\xE9ritage que J\xE9sus Christ s'est acquis au prix de son sang, et de nous assister de votre puissance et de votre secours dans nos besoins.","Prot\xE9gez, \xF4 Gardien vigilant de la divine Famille, la race \xE9lue de J\xE9sus Christ; pr\xE9servez-nous , \xF4 P\xE8re tr\xE8s aimant, de l'erreur et de la corruption; assistez-nous du haut du ciel, \xF4 protecteur tr\xE8s puissant, dans le combat contre la puissance des t\xE9n\xE8bres.","Et de m\xEAme qu'autrefois vous avez arrach\xE9 l'Enfant J\xE9sus au p\xE9ril de la mort, d\xE9fendez aujourd'hui la sainte \xC9glise de Dieu des emb\xFBches de l'ennemi et de toute adversit\xE9. Couvrez chacun de nous de votre constante protection, afin qu'\xE0 votre exemple et par votre secours nous puissions vivre saintement, mourir pieusement et obtenir la b\xE9atitude \xE9ternelle du ciel.","Amen."],"good-friday":["Dialogue","V. Christ became obedient for us unto death.","R. Even unto death on the Cross."],"holy-saturday":["Dialogue","V. Christ became obedient for us unto death, even unto death on the Cross.","R. For which God hath exalted Him and hath given Him a name which is above all names."],"joyful-mysteries":{1:{introduction:["L'Annonciation de l'Ange Gabriel \xE0 la Vierge Marie","1er Myst\xE8re Joyeux","Him Whom thou didst conceive.","Fruit of the mystery: Humility"],scripture:["[Lc 1,26-27]"]},2:{introduction:["Visite de la Vierge Marie \xE0 sa cousine \xC9lisabeth","2e Myst\xE8re Joyeux","Him Whom thou didst carry while visiting Elizabeth.","Fruit of the mystery: Love of Neighbor"],scripture:["[Lc 1, 39-42]"]},3:{introduction:["La naissance de J\xE9sus dans la grotte de Bethl\xE9em","3e Myst\xE8re Joyeux","Him Whom thou didst give birth to.","Fruit of the mystery: Poverty"],scripture:["[Lc 2,1-7]"]},4:{introduction:["J\xE9sus est pr\xE9sent\xE9 au temple par Marie et Joseph","4e Myst\xE8re Joyeux","Him Whom thou didst present in the temple.","Fruit of the mystery: Purity of Heart and Body"],scripture:["[Lc 2, 21-24]"]},5:{introduction:["J\xE9sus retrouv\xE9 dans le temple","5e Myst\xE8re Joyeux","Him Whom thou didst find in the temple.","Fruit of the mystery: Devotion to Jesus"],scripture:["[Lc 2, 41-47]"]},introduction:["Myst\xE8res joyeux"]},"luminous-mysteries":{1:{introduction:["Le Bapt\xEAme dans le Jourdain","1er Myst\xE8re Lumineux","He Who was baptized in the Jordan.","Fruit of the mystery: Openness to the Holy Spirit"],scripture:["[Mt 3,16-17]"]},2:{introduction:["Les noces de Cana","2e Myst\xE8re Lumineux","He Who revealed Himself at the wedding feast of Cana.","Fruit of the mystery: To Jesus through Mary"],scripture:["[Jn 2, 1-5]"]},3:{introduction:["L'annonce du Royaume de Dieu et l'invitation \xE0 la conversion","3e Myst\xE8re Lumineux","He who announced the Kingdom of God.","Fruit of the mystery: Conversion"],scripture:["[Mc 1, 15]"]},4:{introduction:["La transfiguration","4e Myst\xE8re Lumineux","He Who was transfigured.","Fruit of the mystery: Desire for holiness"],scripture:["[Mt 17, 1-2]"]},5:{introduction:["L'institution de l'Eucharistie","5e Myst\xE8re Lumineux","He Who instituted the Eucharist.","Fruit of the mystery: Adoration"],scripture:["[Mt 26, 26]"]},introduction:["Myst\xE8res lumineux"]},"sorrowful-mysteries":{1:{introduction:["L'agonie de J\xE9sus \xE0 Geths\xE9mani","1er Myst\xE8re Douloureux","He Who sweated blood for us.","Fruit of the mystery: Obedience to God\u2019s Will"],scripture:["[Mt 26, 36-39]"]},2:{introduction:["La flagellation de J\xE9sus","2e Myst\xE8re Douloureux","He Who was scourged for us.","Fruit of the mystery: Mortification"],scripture:["[Mt 27, 26]"]},3:{introduction:["Le couronnement d'\xE9pines","3e Myst\xE8re Douloureux","He Who was crowned with thorns for us.","Fruit of the mystery: Courage"],scripture:["[Mt 27, 27-29]"]},4:{introduction:["Le portement de la Croix","4e Myst\xE8re Douloureux","He Who carried the Cross for us.","Fruit of the mystery: Patience"],scripture:["[Mc 15, 21-22]"]},5:{introduction:["J\xE9sus est crucifi\xE9 et meurt sur la Croix","5e Myst\xE8re Douloureux","He Who was crucified for us.","Fruit of the mystery: Sorrow for our Sins"],scripture:["[Lc 23, 32-33, 44-46]"]},introduction:["Myst\xE8res douloureux"]},"glorious-mysteries":{1:{introduction:["La R\xE9surrection de J\xE9sus","1er Myst\xE8re Glorieux","He Who arose from the dead.","Fruit of the mystery: Faith"],scripture:["[Lc 24, 1-6]"]},2:{introduction:["L'Ascension du Seigneur au ciel","2e Myst\xE8re Glorieux","He Who ascended into heaven.","Fruit of the mystery: Hope"],scripture:["[Mc 16, 19]"]},3:{introduction:["La descente du Saint-Esprit au C\xE9nacle","3e Myst\xE8re Glorieux","He Who sent the Holy Spirit.","Fruit of the mystery: Wisdom"],scripture:["[Ac 2, 1-4]"]},4:{introduction:["L'Assomption de Marie au Ciel","4e Myst\xE8re Glorieux","He Who assumed thee into heaven.","Fruit of the mystery: Devotion to Mary"],scripture:["[Lc 1, 48-49]"]},5:{introduction:["Marie est couronn\xE9e Reine du ciel et de la terre","5e Myst\xE8re Glorieux","He Who crowned thee Queen of Heaven.","Fruit of the mystery: Grace of a happy death"],scripture:["[Ap 12, 1]"]},introduction:["Myst\xE8res glorieux"]}},cp="Rosarium",fp={_name:cp,"salve-regina-concluding-prayer":["Oratio","Oremus. Deus, cuius Unigenitus per vitam, mortem et resurrectionem suam nobis salutis aeternae praemia comparavit: concede, quaesumus; ut, haec mysteria sacratissimo beatae Mariae Virginis Rosario recolentes. et imitemur quod continent, et quod promittunt, assequamur. Per eundem Christum Dominum nostrum. Amen."],"prayer-to-st-joseph":["Oratio ad Sanctum Iosephum","Ad te beate Ioseph, in tribulatione nostra confugimus, atque, implorato Sponsae tuae sanctissimae auxilio, patrocinium quoque tuum fidenter exposcimus.","Per eam, quaesumus quae te cum immaculata Virgine Dei Genetrice coniunxit, caritatem, perque paternum, quo Puerum Iesum amplexus es, amorem, supplices deprecamur, ut ad hereditatem, quam Iesus Christus acquisivit Sanguine suo, benignus respicias, ac necessitatibus nostris tua virtute et ope succurras.","Tuere, o Custos providentissime divinae Familiae, Iesu Christi sobolem electam; prohibe a nobis, amantissime Pater, omnem errorum ac corruptelarum luem; propitius nobis, sospitator noster fortissime, in hoc cum potestate tenebrarum certamine e caelo adesto;","et sicut olim Puerum Iesum e summo eripuisti vitae discrimine, ita nunc Ecclesiam sanctam Dei ab hostilibus insidiis atque ab omni adversitate defende: nosque singulos perpetuo tege patrocinio, ut ad tui exemplar et ope tua suffulti, sancte vivere, pie emori, sempiternamque in caelis beatitudinem assequi possimus.","Amen."],"good-friday":["Dialogus","V. Christus factus est pro nobis oboediens usque ad mortem.","R. Mortem autem crucis."],"holy-saturday":["Dialogus","V. Christus factus est pro nobis oboediens usque ad mortem, mortem autem crucis.","R. Propter quod et Deus exaltavit illum: et dedit illi nomen, quod est super omne nomen."],"joyful-mysteries":{1:{introduction:["Annuntiatio","Primum mysterium gaudiosum","Quem, Virgo, concepisti.","Fruit of the mystery: Humility"],scripture:["[Mt 1:18, Lc 1:26-38]"]},2:{introduction:["Visitatio","Secundum mysterium gaudiosum","Quem visitando Elisabeth portasti.","Fruit of the mystery: Love of Neighbor"],scripture:["[Lc 1:39-45]"]},3:{introduction:["Nativitas","Tertium mysterium gaudiosum","Quem, Virgo, genuisti.","Fruit of the mystery: Poverty"],scripture:["[Lc 2:6-12]"]},4:{introduction:["Presentatio","Quartum mysterium gaudiosum","Quem in templo praesentasti.","Fruit of the mystery: Purity of Heart and Body"],scripture:["[Lc 2:25-32]"]},5:{introduction:["Inventionem Domini nostri Iesu Christi in templo","Quintum mysterium gaudiosum","Quem in templo invenisti.","Fruit of the mystery: Devotion to Jesus"],scripture:["[Lc 2:41-50]"]},introduction:["Mysteria gaudiosa"]},"luminous-mysteries":{1:{introduction:["Baptismus Iesu","Primum mysterium luminosum","Qui apud Iordanem baptizatus est.","Fruit of the mystery: Openness to the Holy Spirit"],scripture:["[Mt 3:13, Mc 1:9, Jn 1:29]"]},2:{introduction:["Miraculum ad nuptias in Cana","Secundum mysterium luminosum","Qui ipsum revelavit apud Canense matrimonium.","Fruit of the mystery: To Jesus through Mary"],scripture:["[In 2:1-11]"]},3:{introduction:["Proclamatio Regni Dei","Tertium mysterium luminosum","Qui Regnum Dei annuntiavit.","Fruit of the mystery: Conversion"],scripture:["[Mc 1:15, Lc 10:8-11]"]},4:{introduction:["Transfiguratum","Quartum mysterium luminosum","Qui transfiguratus est.","Fruit of the mystery: Desire for holiness"],scripture:["[Mt 17:1-8, Mc 9:2-9]"]},5:{introduction:["Ultima cena","Quintum mysterium luminosum","Qui Eucharistiam instituit.","Fruit of the mystery: Adoration"],scripture:["[In 6:27-59, Mt 26:26-29, Mc 14:22-24, Lc 22:15-20]"]},introduction:["Mysteria luminosa"]},"sorrowful-mysteries":{1:{introduction:["Cruciatus in Horto","Primum mysterium dolorosum","Qui pro nobis sanguinem sudavit.","Fruit of the mystery: Obedience to God\u2019s Will"],scripture:["[Lc 22:39-46]"]},2:{introduction:["Flagellatio Domini nostri Iesu Christi","Secundum mysterium dolorosum","Qui pro nobis flagellatus est.","Fruit of the mystery: Mortification"],scripture:["[Mt 27:26, Mc 15:6-15, In 19:1]"]},3:{introduction:["Coronatio cum Spinis","Tertium mysterium dolorosum","Qui pro nobis spinis coronatus est.","Fruit of the mystery: Courage"],scripture:["[In 19:1-8]"]},4:{introduction:["Baiulatio Crucis","Quartum mysterium dolorosum","Qui pro nobis crucem baiulavit.","Fruit of the mystery: Patience"],scripture:["[In 19:16-22]"]},5:{introduction:["Crucifixio","Quintum mysterium dolorosum","Qui pro nobis crucifixus est.","Fruit of the mystery: Sorrow for our Sins"],scripture:["[In 19:25-30]"]},introduction:["Mysteria dolorosa"]},"glorious-mysteries":{1:{introduction:["Resurrectio","Primum mysterium gloriosum","Qui resurrexit a mortuis.","Fruit of the mystery: Faith"],scripture:["[Mc 16:1-7]"]},2:{introduction:["Ascensio","Secundum mysterium gloriosum","Qui in caelum ascendit.","Fruit of the mystery: Hope"],scripture:["[Lc 24:46-53]"]},3:{introduction:["Descensus Spiritus Sancti","Tertium mysterium gloriosum","Qui Spiritum Sanctum misit.","Fruit of the mystery: Wisdom"],scripture:["[Acta 2:1-7]"]},4:{introduction:["Assumptio","Quartum mysterium gloriosum","Qui te assumpsit.","Fruit of the mystery: Devotion to Mary"],scripture:["[Ps 16:10]"]},5:{introduction:["Coronatio Beatae Mariae Virginis in caelum","Quintum mysterium gloriosum","Qui te in caelis coronavit.","Fruit of the mystery: Grace of a happy death"],scripture:["[Apoc 12:1]"]},introduction:["Mysteria gloriosa"]}},hp="Ro\u017Eukronis",dp={_name:hp,"salve-regina-concluding-prayer":["L\u016Bg\u0161ana","Dievs, kura Viendzimtais D\u0113ls ar savu dz\u012Bvi, n\u0101vi un aug\u0161\u0101mcel\u0161anos mums sagatavoja m\u016B\u017E\u012Bg\u0101s pest\u012B\u0161anas algu, Tevi l\u016Bdzam, dod, ka m\u0113s, \u0161os nosl\u0113pumus Vissv\u0113t\u0101s Jaunavas Marijas Ro\u017Eukron\u012B apcer\u0113dami, sekotu tajos ietvertai m\u0101c\u012Bbai un sasniegtu algu, kas tajos apsol\u012Bta. Caur to pa\u0161u m\u016Bsu Kungu J\u0113zu Kristu, Tavu D\u0113lu, kas ar Tevi dz\u012Bvo un valda Sv\u0113t\u0101 Gara vien\u012Bb\u0101, Dievs no m\u016B\u017E\u012Bbas m\u016B\u017E\u012Bb\u0101. Amen."],"prayer-to-st-joseph":["L\u016Bg\u0161ana sv\u0113tajam J\u0101zepam","Pie Tevis, sv\u0113tais J\u0101zep, m\u0113s steidzamies sav\u0101s b\u0113d\u0101s un Tavas Vissv\u0113t\u0101k\u0101s L\u012Bgavas pal\u012Bdz\u012Bbu piesauku\u0161i, pa\u013C\u0101v\u012Bgi l\u016Bdzam ar\u012B Tavu aizbildn\u012Bbu.","T\u0101s m\u012Blest\u012Bbas d\u0113\u013C, kas Tevi vienoja ar bezvain\u012Bgo Jaunavu, Dieva Dzemd\u0113t\u0101ju, un t\u0101s t\u0113vi\u0161\u0137\u0101s g\u0101d\u012Bbas d\u0113\u013C, ar kuru Tu r\u016Bp\u0113jies par b\u0113rni\u0146u J\u0113zu, m\u0113s Tevi pazem\u012Bgi l\u016Bdzam, uzl\u016Bko \u017E\u0113l\u012Bgi J\u0113zus Kristus asin\u012Bm atpirkto mantojumu un pal\u012Bdzi mums ar savu sp\u0113c\u012Bgo p\u0101rst\u0101v\u012Bbu m\u016Bsu vajadz\u012Bb\u0101s.","Sargi, Dieva aizg\u0101d\u012Bbas dotais sv\u0113t\u0101s \u0123imenes sargs, izredz\u0113tos J\u0113zus Kristus b\u0113rnus, izgl\u0101b m\u016Bs, visum\u012B\u013Cais T\u0113vs, no ikvienas samait\u0101\u0161anas un maldiem, ar debesu sp\u0113ku stiprini m\u016Bs, sp\u0113c\u012Bgais pal\u012Bdz\u0113t\u0101j, c\u012B\u0146\u0101 ar tums\u012Bbas sp\u0113kiem.","Un k\u0101 Tu citk\u0101rt izgl\u0101bi b\u0113rni\u0146u J\u0113zu no draudo\u0161\u0101m n\u0101ves briesm\u0101m, t\u0101 tagad aizst\u0101vi sv\u0113to Dieva Bazn\u012Bcu pret ienaidnieku uzbrukumiem un ikvienu nelaimi. Uz\u0146em m\u016Bs visus sav\u0101 past\u0101v\u012Bg\u0101 patv\u0113rum\u0101, ka m\u0113s, p\u0113c Tava parauga dz\u012Bvodami, un Tavas pal\u012Bdz\u012Bbas sp\u0113cin\u0101ti, var\u0113tu dievbij\u012Bgi dz\u012Bvot, sv\u0113t\u012Bgi nomirt un iemantot m\u016B\u017E\u012Bgo l\u012Bksm\u012Bbu debes\u012Bs.","Amen."],"good-friday":["Dialogs","V. M\u016Bsu d\u0113\u013C Kristus k\u013Cuva paklaus\u012Bgs l\u012Bdz n\u0101vei","R. L\u012Bdz par krusta n\u0101vei."],"holy-saturday":["Dialogs","V. M\u016Bsu d\u0113\u013C Kristus k\u013Cuva paklaus\u012Bgs l\u012Bdz n\u0101vei, l\u012Bdz par krusta n\u0101vei.","R. T\u0101d\u0113\u013C Dievs Vi\u0146u paaugstin\u0101ja p\u0101ri visam un deva Vi\u0146am V\u0101rdu, kas ir p\u0101ri p\u0101r katru v\u0101rdu."],"joyful-mysteries":{1:{introduction:["E\u0146\u0123e\u013Ca pasludin\u0101jums Jaunavai Marijai","Pirmais priec\u012Bgais nosl\u0113pums","Him Whom thou didst conceive.","Fruit of the mystery: Humility"],scripture:["[Lk 1,26-31]"]},2:{introduction:["Marija apmekl\u0113 sv. Elizabeti","Otrais priec\u012Bgais nosl\u0113pums","Him Whom thou didst carry while visiting Elizabeth.","Fruit of the mystery: Love of Neighbor"],scripture:["[Lk 1,39-42]"]},3:{introduction:["Betl\u0113mes stall\u012Bt\u012B piedzimst J\u0113zus","Tre\u0161ais priec\u012Bgais nosl\u0113pums","Him Whom thou didst give birth to.","Fruit of the mystery: Poverty"],scripture:["[Lk 1,4-7]"]},4:{introduction:["B\u0113rna J\u0113zus upur\u0113\u0161ana templ\u012B","Ceturtais priec\u012Bgais nosl\u0113pums","Him Whom thou didst present in the temple.","Fruit of the mystery: Purity of Heart and Body"],scripture:["[Lk 2]"]},5:{introduction:["B\u0113rna J\u0113zus atra\u0161ana sv\u0113tn\u012Bc\u0101","Piektais priec\u012Bgais nosl\u0113pums","Him Whom thou didst find in the temple.","Fruit of the mystery: Devotion to Jesus"],scripture:["[Lk 2,42-46]"]},introduction:["Priec\u012Bgie nosl\u0113pumi"]},"luminous-mysteries":{1:{introduction:["J\u0113zus Krist\u012Bba Jord\u0101n\u0101","Pirmais gaismas nosl\u0113pums","He Who was baptized in the Jordan.","Fruit of the mystery: Openness to the Holy Spirit"],scripture:["[Mt 3]"]},2:{introduction:["J\u0113zus atkl\u0101\u0161an\u0101s k\u0101z\u0101s K\u0101n\u0101","Otrais gaismas nosl\u0113pums","He Who revealed Himself at the wedding feast of Cana.","Fruit of the mystery: To Jesus through Mary"],scripture:["[J\u0146 2]"]},3:{introduction:["Dieva valst\u012Bbas sludin\u0101\u0161ana un aicin\u0101jums atgriezties","Tre\u0161ais gaismas nosl\u0113pums","He who announced the Kingdom of God.","Fruit of the mystery: Conversion"],scripture:["[Mk 1; Mk 2,5.11-12]"]},4:{introduction:["P\u0101rveido\u0161an\u0101s Tabora kaln\u0101","Ceturtais gaismas nosl\u0113pums","He Who was transfigured.","Fruit of the mystery: Desire for holiness"],scripture:["[Lk 9,28-35]"]},5:{introduction:["Euharistijas iedibin\u0101\u0161ana","Piektais gaismas nosl\u0113pums","He Who instituted the Eucharist.","Fruit of the mystery: Adoration"],scripture:["[J\u0146 13,1; Mk 14,22-24]"]},introduction:["Gaismas nosl\u0113pumi"]},"sorrowful-mysteries":{1:{introduction:["Kungs J\u0113zus l\u016Bdzas Ol\u012Bvd\u0101rz\u0101","Pirmais s\u0101p\u012Bgais nosl\u0113pums","He Who sweated blood for us.","Fruit of the mystery: Obedience to God\u2019s Will"],scripture:["[Lk 22,41-44]"]},2:{introduction:["Kungs J\u0113zus tiek \u0161aust\u012Bts","Otrais s\u0101p\u012Bgais nosl\u0113pums","He Who was scourged for us.","Fruit of the mystery: Mortification"],scripture:["[Mk 15,12-15]"]},3:{introduction:["Kungam J\u0113zum uzliek galv\u0101 \u0113rk\u0161\u0137u kroni","Tre\u0161ais s\u0101p\u012Bgais nosl\u0113pums","He Who was crowned with thorns for us.","Fruit of the mystery: Courage"],scripture:["[Mt 27,29]"]},4:{introduction:["Kunga J\u0113zus ce\u013C\u0161 uz Golg\u0101tu","Ceturtais s\u0101p\u012Bgais nosl\u0113pums","He Who carried the Cross for us.","Fruit of the mystery: Patience"],scripture:["[J\u0146 19,17]"]},5:{introduction:["J\u0113zu pienaglo pie Krusta, un Vi\u0146\u0161 mirst \u0161ausm\u012Bg\u0101s cie\u0161an\u0101s","Piektais s\u0101p\u012Bgais nosl\u0113pums","He Who was crucified for us.","Fruit of the mystery: Sorrow for our Sins"],scripture:["[Lk 23,33.44-46]"]},introduction:["S\u0101p\u012Bgie nosl\u0113pumi"]},"glorious-mysteries":{1:{introduction:["Kungs J\u0113zus aug\u0161\u0101mce\u013Cas","Pirmais god\u012Bbas nosl\u0113pums","He Who arose from the dead.","Fruit of the mystery: Faith"],scripture:["[Mt 28,5-6]"]},2:{introduction:["Kungs J\u0113zus uzk\u0101pj debes\u012Bs","Otrais god\u012Bbas nosl\u0113pums","He Who ascended into heaven.","Fruit of the mystery: Hope"],scripture:["[Mk 16,19-20]"]},3:{introduction:["Sv\u0113tais Gars non\u0101k p\u0101r Jaunavu Mariju un apustu\u013Ciem","Tre\u0161ais god\u012Bbas nosl\u0113pums","He Who sent the Holy Spirit.","Fruit of the mystery: Wisdom"],scripture:["[Apd 2,1-4]"]},4:{introduction:["Vissv\u0113t\u0101 Jaunava Marija ar miesu un dv\u0113seli tiek uz\u0146emta debes\u012Bs","Ceturtais god\u012Bbas nosl\u0113pums","He Who assumed thee into heaven.","Fruit of the mystery: Devotion to Mary"],scripture:[""]},5:{introduction:["Marija tiek kron\u0113ta par debesu un zemes Karalieni","Piektais god\u012Bbas nosl\u0113pums","He Who crowned thee Queen of Heaven.","Fruit of the mystery: Grace of a happy death"],scripture:["[Atkl 12,1]"]},introduction:["God\u012Bbas nosl\u0113pumi"]}},pp={generate:Z0,meta:tp,params:np,languages:{en:sp,es:op,fr:up,la:fp,lv:dp}},gp=e=>[[["prayer"],"",["prayer"]],[["dialogue"],"",["dialogue"]],[["concluding-prayer"],"",["concluding-prayer"]]],yp="Salve Regina",mp={name:yp},vp={},Cp="Hail, holy Queen",bp=["Prayer","Hail, holy Queen, Mother of mercy, our life, our sweetness and our hope. To thee do we cry, poor banished children of Eve. To thee do we send up our sighs, mourning and weeping in this valley of tears. Turn, then, most gracious advocate, thine eyes of mercy toward us, and after this, our exile, show unto us the blessed fruit of thy womb, Jesus. O clement, O loving, O sweet Virgin Mary."],Ep=["Dialogue","V. Pray for us, O holy Mother of God.","R. That we may be made worthy of the promises of Christ."],Sp={_name:Cp,prayer:bp,dialogue:Ep,"concluding-prayer":["Prayer","Let us pray. Almighty and everlasting God, Who by the working of the Holy Spirit didst prepare both body and soul of the glorious Virgin Mother, Mary, that she might deserve to be made a worthy dwelling for Thy Son, grant that we who rejoice in her memory, may, by her loving intercession, be delivered from present evils and from lasting death, through the same Christ our Lord. Amen."]},_p="Salve Regina",wp=["Oraci\xF3n","Dios te salve, Reina y Madre de misericordia, vida, dulzura y esperanza nuestra; Dios te salve. A Ti llamamos los desterrados hijos de Eva; a Ti suspiramos gimiendo y llorando, en este valle de l\xE1grimas. Ea, pues, Se\xF1ora, abogada nuestra, vuelve a nosotros esos tus ojos misericordiosos; y despu\xE9s de este destierro, mu\xE9stranos a Jes\xFAs, fruto bendito de tu vientre. \xA1Oh clement\xEDsima, oh piadosa, oh dulce siempre Virgen Mar\xEDa!"],Tp=["Di\xE1logo","V. Ruega por nosotros, Santa Madre de Dios.","R. Para que seamos dignos de alcanzar las promesas de Nuestro Se\xF1or Jesucristo."],xp={_name:_p,prayer:wp,dialogue:Tp,"concluding-prayer":["Prayer","Let us pray. Almighty and everlasting God, Who by the working of the Holy Spirit didst prepare both body and soul of the glorious Virgin Mother, Mary, that she might deserve to be made a worthy dwelling for Thy Son, grant that we who rejoice in her memory, may, by her loving intercession, be delivered from present evils and from lasting death, through the same Christ our Lord. Amen."]},Ap="Salut, \xF4 Reine",Ip=["Pri\xE8re","Salut, \xF4 Reine, m\xE8re de mis\xE9ricorde: notre vie, notre douceur et notre esp\xE9rance, salut! Enfants d'\xC8ve, exil\xE9s, nous crions vers toi; vers toi, nous soupirons, g\xE9missant et pleurant dans cette vall\xE9e de larmes. \xD4 toi, notre avocate, tourne vers nous ton regard mis\xE9ricordieux. Et apr\xE8s cet exil, montre-nous J\xE9sus, le fruit b\xE9ni de tes entrailles, \xF4 cl\xE9mente, \xF4 mis\xE9ricordieuse, \xF4 douce Vierge Marie!"],kp=["Dialogue","V. Priez pour nous, sainte M\xE8re de Dieu.","R. Afin que nous soyons rendus dignes des promesses de Notre-Seigneur J\xE9sus-Christ."],Bp={_name:Ap,prayer:Ip,dialogue:kp,"concluding-prayer":["Prayer","Let us pray. Almighty and everlasting God, Who by the working of the Holy Spirit didst prepare both body and soul of the glorious Virgin Mother, Mary, that she might deserve to be made a worthy dwelling for Thy Son, grant that we who rejoice in her memory, may, by her loving intercession, be delivered from present evils and from lasting death, through the same Christ our Lord. Amen."]},Rp="Salve, Regina",Np=["Oratio","Salve, Regina, mater misericordiae;","vita, dulcedo et spes nostra, salve.","Ad te clamamus exsules filii Hevae.","Ad te suspiramus gementes et flentes","in hac lacrimarum valle.","Eia ergo, advocata nostra,","illos tuos misericordes oculos ad nos converte.","Et Iesum, benedictum fructum ventris tui,","nobis post hoc exsilium ostende.","O clemens, o pia, o dulcis Virgo Maria."],Lp=["Dialogus","V. Ora pro nobis, sancta Dei Genitrix.","R. Ut digni efficamur promissionibus Christi."],Dp={_name:Rp,prayer:Np,dialogue:Lp,"concluding-prayer":["Oratio","Oremus. Omnipotens sempiterne Deus, qui gloriosae Virginis Matris Mariae corpus et animam, ut dignum Filii tui habitaculum effici mereretur, Spiritu Sancto cooperante, praeparasti, da, ut cuius commemoratione laetamur; eius pia intercessione, ab instantibus malis et a morte perpetua liberemur. Per eundem Christum Dominum nostrum. Amen."]},Up="Esi sveicin\u0101ta, Karaliene",Op=["L\u016Bg\u0161ana","Esi sveicin\u0101ta, Karaliene, \u017E\u0113lsird\u012Bbas M\u0101te, Kas mums Pest\u012Bt\u0101ju devi, esi sveicin\u0101ta. M\u0113s, Ievas b\u0113rni, sve\u0161um\u0101 saucam uz Tevi. M\u0113s Tevi l\u016Bdzam, s\u0113rojot un raudot \u0161ai asaru ielej\u0101. T\u0101d\u0113\u013C, m\u016Bsu aizst\u0101ve, uzl\u016Bko m\u016Bs sav\u0101 \u017E\u0113lsird\u012Bb\u0101. Un p\u0113c \u0161\u012Bs dz\u012Bves ved m\u016Bs pie J\u0113zus, pie Tava dievi\u0161\u0137\u0101 D\u0113la. Tu \u017E\u0113l\u012Bg\u0101 un laipn\u0101, Vissv\u0113t\u0101k\u0101 Jaunava Marija."],Mp=["Dialogs","V. L\u016Bdz par mums, sv\u0113t\u0101 Dieva Dzemd\u0113t\u0101ja!","R. Lai m\u0113s Kristus sol\u012Bjumu cien\u012Bgi topam!"],Pp={_name:Up,prayer:Op,dialogue:Mp,"concluding-prayer":["Prayer","Let us pray. Almighty and everlasting God, Who by the working of the Holy Spirit didst prepare both body and soul of the glorious Virgin Mother, Mary, that she might deserve to be made a worthy dwelling for Thy Son, grant that we who rejoice in her memory, may, by her loving intercession, be delivered from present evils and from lasting death, through the same Christ our Lord. Amen."]},Fp={generate:gp,meta:mp,params:vp,languages:{en:Sp,es:xp,fr:Bp,la:Dp,lv:Pp}},Vp=e=>[[["formula"],"",["formula"],"Make the Sign of the Cross"]],Kp="Sign of the Cross",Hp={name:Kp},$p={},Gp="The Sign of the Cross",qp=["The Sign of the Cross","In the name of the Father, and of the Son, and of the Holy Spirit. Amen."],jp={_name:Gp,formula:qp},zp="La Se\xF1al de la Cruz",Wp=["La Se\xF1al de la Cruz","En el nombre del Padre, y del Hijo, y del Esp\xEDritu Santo. Am\xE9n."],Qp={_name:zp,formula:Wp},Jp="Signe de croix",Yp=["Signe de croix","Au nom du P\xE8re et du Fils et du Saint-Esprit. Amen."],Xp={_name:Jp,formula:Yp},Zp="Signum Crucis",eg=["Signum Crucis","In nomine Patris et Filii et Spiritus Sancti. Amen."],tg={_name:Zp,formula:eg},rg="Krusta z\u012Bme",ng=["Krusta z\u012Bme","Dieva T\u0113va un D\u0113la, un Sv\u0113t\u0101 Gara v\u0101rd\u0101. Amen."],ig={_name:rg,formula:ng},sg={generate:Vp,meta:Hp,params:$p,languages:{en:jp,es:Qp,fr:Xp,la:tg,lv:ig}},Nu={"alma-redemptoris-mater":ph,angelus:Th,"apostles-creed":qh,"ave-regina-caelorum":id,"chaplet-of-divine-mercy":dd,"fatima-prayer":Ld,"glory-be":Zd,"hail-mary":C0,"lords-prayer":F0,"regina-caeli":X0,rosary:pp,"salve-regina":Fp,"sign-of-the-cross":sg},Zo=JSON.parse(localStorage.getItem("state")),el=localStorage.getItem("privateName"),ss=Wn("menu"),Tt=Wn(Zo!==null?Zo:{prayer:Object.keys(Nu)[0],lang:Ru[0],stage:0,step:0,conf:{}}),Lu=Wn(!1),ui=Wn(el!==null?el:""),ln=Wn(!0),Ns=Bu(Ru,()=>()=>{}),Qn=Bu(Nu,()=>()=>{});function ag(e){let t,r,n,i,s,a,o,l,u,c,f,d;return n=new hr({props:{id:"menu"}}),a=new hr({props:{id:"import_contacts"}}),u=new hr({props:{id:"groups"}}),{c(){t=oe("nav"),r=oe("div"),_t(n.$$.fragment),i=it(),s=oe("div"),_t(a.$$.fragment),o=it(),l=oe("div"),_t(u.$$.fragment),pe(r,"class","svelte-1uqidzq"),Fr(r,"active",e[0]=="menu"),pe(s,"class","svelte-1uqidzq"),Fr(s,"active",e[0]=="prayer"),pe(l,"class","svelte-1uqidzq"),Fr(l,"active",e[0]=="groups"),pe(t,"class","svelte-1uqidzq")},m(p,g){me(p,t,g),se(t,r),pt(n,r,null),se(t,i),se(t,s),pt(a,s,null),se(t,o),se(t,l),pt(u,l,null),c=!0,f||(d=[Lt(r,"click",e[2]),Lt(s,"click",e[3]),Lt(l,"click",e[4])],f=!0)},p(p,[g]){(!c||g&1)&&Fr(r,"active",p[0]=="menu"),(!c||g&1)&&Fr(s,"active",p[0]=="prayer"),(!c||g&1)&&Fr(l,"active",p[0]=="groups")},i(p){c||(Se(n.$$.fragment,p),Se(a.$$.fragment,p),Se(u.$$.fragment,p),c=!0)},o(p){Ie(n.$$.fragment,p),Ie(a.$$.fragment,p),Ie(u.$$.fragment,p),c=!1},d(p){p&&ye(t),gt(n),gt(a),gt(u),f=!1,br(d)}}}function og(e,t,r){let n;Xe(e,ss,l=>r(0,n=l));const i=l=>{ss.set(l)};return[n,i,()=>{i("menu")},()=>{i("prayer")},()=>{i("groups")}]}class lg extends Sr{constructor(t){super(),Er(this,t,og,ag,Dt,{})}}function Pn(e,{delay:t=0,duration:r=400,easing:n=Ja}={}){const i=+getComputedStyle(e).opacity;return{delay:t,duration:r,easing:n,css:s=>`opacity: ${s*i}`}}const as=(e,t,r)=>{if(t in e)return[t,e[t]];for(const n of r)if(n in e)return[n,e[n]]};function tl(e){let t,r,n=e[1].toUpperCase()+"",i,s,a=e[2]._name+"",o,l,u,c;return{c(){t=oe("div"),r=oe("div"),i=ft(n),s=ft(": "),o=ft(a),pe(r,"class","ellipsis"),pe(t,"class","svelte-134b3vf")},m(f,d){me(f,t,d),se(t,r),se(r,i),se(r,s),se(r,o),c=!0},p(f,d){(!c||d&2)&&n!==(n=f[1].toUpperCase()+"")&&qt(i,n),(!c||d&4)&&a!==(a=f[2]._name+"")&&qt(o,a)},i(f){c||(Jr(()=>{u&&u.end(1),l=Za(t,Pn,{delay:75,duration:75}),l.start()}),c=!0)},o(f){l&&l.invalidate(),u=eo(t,Pn,{duration:75}),c=!1},d(f){f&&ye(t),f&&u&&u.end()}}}function rl(e){let t=e[0].lang,r,n,i=tl(e);return{c(){i.c(),r=Ii()},m(s,a){i.m(s,a),me(s,r,a),n=!0},p(s,a){a&1&&Dt(t,t=s[0].lang)?(Lr(),Ie(i,1,1,et),Dr(),i=tl(s),i.c(),Se(i,1),i.m(r.parentNode,r)):i.p(s,a)},i(s){n||(Se(i),n=!0)},o(s){Ie(i),n=!1},d(s){s&&ye(r),i.d(s)}}}function ug(e){let t,r,n=e[0].prayer,i,s,a,o,l,u,c,f,d,p,g,m,T,x,B,v,_=rl(e);return o=new hr({props:{id:"restart_alt"}}),f=new hr({props:{id:"arrow_back"}}),m=new hr({props:{id:"arrow_forward"}}),{c(){t=oe("div"),r=oe("div"),_.c(),i=it(),s=oe("nav"),a=oe("button"),_t(o.$$.fragment),u=it(),c=oe("button"),_t(f.$$.fragment),p=it(),g=oe("button"),_t(m.$$.fragment),pe(r,"class","svelte-134b3vf"),a.disabled=l=!e[3]||e[0].stage==0&&e[0].step==0,pe(a,"class","svelte-134b3vf"),c.disabled=d=!e[3]||e[0].stage==0&&e[0].step==0,pe(c,"class","svelte-134b3vf"),g.disabled=T=!e[3]||e[0].stage==1||e[0].stage==2&&e[4],pe(g,"class","svelte-134b3vf"),pe(s,"class","svelte-134b3vf"),pe(t,"class","footer svelte-134b3vf")},m(w,I){me(w,t,I),se(t,r),_.m(r,null),se(t,i),se(t,s),se(s,a),pt(o,a,null),se(s,u),se(s,c),pt(f,c,null),se(s,p),se(s,g),pt(m,g,null),x=!0,B||(v=[Lt(a,"click",e[5]),Lt(c,"click",e[6]),Lt(g,"click",e[7])],B=!0)},p(w,[I]){I&1&&Dt(n,n=w[0].prayer)?(Lr(),Ie(_,1,1,et),Dr(),_=rl(w),_.c(),Se(_,1),_.m(r,null)):_.p(w,I),(!x||I&9&&l!==(l=!w[3]||w[0].stage==0&&w[0].step==0))&&(a.disabled=l),(!x||I&9&&d!==(d=!w[3]||w[0].stage==0&&w[0].step==0))&&(c.disabled=d),(!x||I&25&&T!==(T=!w[3]||w[0].stage==1||w[0].stage==2&&w[4]))&&(g.disabled=T)},i(w){x||(Se(_),Se(o.$$.fragment,w),Se(f.$$.fragment,w),Se(m.$$.fragment,w),x=!0)},o(w){Ie(_),Ie(o.$$.fragment,w),Ie(f.$$.fragment,w),Ie(m.$$.fragment,w),x=!1},d(w){w&&ye(t),_.d(w),gt(o),gt(f),gt(m),B=!1,br(v)}}}function cg(e,t,r){let n,i,s,a,o;Xe(e,Tt,p=>r(0,n=p)),Xe(e,Qn,p=>r(8,i=p)),Xe(e,Ns,p=>r(9,s=p)),Xe(e,ln,p=>r(3,a=p)),Xe(e,Lu,p=>r(4,o=p));let l,u;const c=()=>{Tt.update(p=>(p.stage=0,p.step=0,p))},f=()=>{Tt.update(p=>{const g=Object.keys(i[n.prayer].params).length;return p.step==0?p.stage==2&&g==0?(p.stage=0,p.step=0):p.stage==2?(p.stage-=1,p.step=g-1):p.stage-=1:p.step-=1,p})},d=()=>{Tt.update(p=>{const g=Object.keys(i[n.prayer].params).length;return p.stage==0&&g==0?p.stage=2:p.stage==0?p.stage+=1:p.stage==1&&p.step==g-1?(p.step=0,p.stage+=1):p.step+=1,p})};return e.$$.update=()=>{e.$$.dirty&769&&r(1,[l,u]=as(i[n.prayer].languages,n.lang,s),l,(r(2,u),r(8,i),r(0,n),r(9,s)))},[n,l,u,a,o,c,f,d,i,s]}class fg extends Sr{constructor(t){super(),Er(this,t,cg,ug,Dt,{})}}function nl(e,t,r){const n=e.slice();return n[8]=t[r],n}function il(e,t,r){const n=e.slice();return n[11]=t[r],n}function sl(e){let t,r=e[11].toUpperCase()+"",n,i,s,a;function o(){return e[6](e[11])}return{c(){t=oe("button"),n=ft(r),t.disabled=i=!e[1]||e[2].lang==e[11],pe(t,"class","svelte-n43ep6")},m(l,u){me(l,t,u),se(t,n),s||(a=Lt(t,"click",o),s=!0)},p(l,u){e=l,u&1&&r!==(r=e[11].toUpperCase()+"")&&qt(n,r),u&7&&i!==(i=!e[1]||e[2].lang==e[11])&&(t.disabled=i)},d(l){l&&ye(t),s=!1,a()}}}function al(e){let t,r=e[3][e[8]].meta.name+"",n,i,s,a;function o(){return e[7](e[8])}return{c(){t=oe("button"),n=ft(r),t.disabled=i=!e[1]||e[2].prayer==e[8]},m(l,u){me(l,t,u),se(t,n),s||(a=Lt(t,"click",o),s=!0)},p(l,u){e=l,u&8&&r!==(r=e[3][e[8]].meta.name+"")&&qt(n,r),u&14&&i!==(i=!e[1]||e[2].prayer==e[8])&&(t.disabled=i)},d(l){l&&ye(t),s=!1,a()}}}function hg(e){let t,r,n,i,s,a,o=e[0],l=[];for(let f=0;f<o.length;f+=1)l[f]=sl(il(e,o,f));let u=Object.keys(e[3]),c=[];for(let f=0;f<u.length;f+=1)c[f]=al(nl(e,u,f));return{c(){t=oe("div"),r=oe("nav");for(let f=0;f<l.length;f+=1)l[f].c();n=it(),i=oe("h1"),i.textContent="Prayers",s=it(),a=oe("nav");for(let f=0;f<c.length;f+=1)c[f].c();pe(r,"class","languages svelte-n43ep6"),pe(a,"class","prayers svelte-n43ep6"),pe(t,"class","menu svelte-n43ep6")},m(f,d){me(f,t,d),se(t,r);for(let p=0;p<l.length;p+=1)l[p].m(r,null);se(t,n),se(t,i),se(t,s),se(t,a);for(let p=0;p<c.length;p+=1)c[p].m(a,null)},p(f,[d]){if(d&23){o=f[0];let p;for(p=0;p<o.length;p+=1){const g=il(f,o,p);l[p]?l[p].p(g,d):(l[p]=sl(g),l[p].c(),l[p].m(r,null))}for(;p<l.length;p+=1)l[p].d(1);l.length=o.length}if(d&46){u=Object.keys(f[3]);let p;for(p=0;p<u.length;p+=1){const g=nl(f,u,p);c[p]?c[p].p(g,d):(c[p]=al(g),c[p].c(),c[p].m(a,null))}for(;p<c.length;p+=1)c[p].d(1);c.length=u.length}},i:et,o:et,d(f){f&&ye(t),dn(l,f),dn(c,f)}}}function dg(e,t,r){let n,i,s,a;Xe(e,Ns,f=>r(0,n=f)),Xe(e,ln,f=>r(1,i=f)),Xe(e,Tt,f=>r(2,s=f)),Xe(e,Qn,f=>r(3,a=f));const o=f=>{Tt.update(d=>(d.lang=f,d))},l=f=>{Tt.update(d=>(d.prayer=f,d.stage=0,d.step=0,d.conf={},d))};return[n,i,s,a,o,l,f=>o(f),f=>l(f)]}class pg extends Sr{constructor(t){super(),Er(this,t,dg,hg,Dt,{})}}function gg(e){let t,r=as(e[0][e[1].prayer].languages,e[1].lang,e[2])[1]._name+"",n;return{c(){t=oe("h1"),n=ft(r)},m(i,s){me(i,t,s),se(t,n)},p(i,[s]){s&7&&r!==(r=as(i[0][i[1].prayer].languages,i[1].lang,i[2])[1]._name+"")&&qt(n,r)},i:et,o:et,d(i){i&&ye(t)}}}function yg(e,t,r){let n,i,s;return Xe(e,Qn,a=>r(0,n=a)),Xe(e,Tt,a=>r(1,i=a)),Xe(e,Ns,a=>r(2,s=a)),[n,i,s]}class mg extends Sr{constructor(t){super(),Er(this,t,yg,gg,Dt,{})}}function ol(e,t,r){const n=e.slice();return n[7]=t[r],n}function ll(e){let t,r=e[7][1]+"",n,i,s,a;function o(){return e[4](e[7])}return{c(){t=oe("button"),n=ft(r),t.disabled=i=!e[0]},m(l,u){me(l,t,u),se(t,n),s||(a=Lt(t,"click",o),s=!0)},p(l,u){e=l,u&1&&i!==(i=!e[0])&&(t.disabled=i)},d(l){l&&ye(t),s=!1,a()}}}function vg(e){let t,r,n,i=Object.entries(e[1][e[2]].options),s=[];for(let a=0;a<i.length;a+=1)s[a]=ll(ol(e,i,a));return{c(){t=oe("h1"),t.textContent=`${e[1][e[2]].description[0]}`,r=it(),n=oe("div");for(let a=0;a<s.length;a+=1)s[a].c();pe(n,"class","options svelte-v65i26")},m(a,o){me(a,t,o),me(a,r,o),me(a,n,o);for(let l=0;l<s.length;l+=1)s[l].m(n,null)},p(a,[o]){if(o&15){i=Object.entries(a[1][a[2]].options);let l;for(l=0;l<i.length;l+=1){const u=ol(a,i,l);s[l]?s[l].p(u,o):(s[l]=ll(u),s[l].c(),s[l].m(n,null))}for(;l<s.length;l+=1)s[l].d(1);s.length=i.length}},i:et,o:et,d(a){a&&ye(t),a&&ye(r),a&&ye(n),dn(s,a)}}}function Cg(e,t,r){let n,i,s;Xe(e,Tt,c=>r(5,n=c)),Xe(e,Qn,c=>r(6,i=c)),Xe(e,ln,c=>r(0,s=c));const a=i[n.prayer].params,o=Object.keys(a)[n.step],l=c=>{Tt.update(f=>(f.conf[o]=c,f.step==Object.keys(a).length-1?(f.step=0,f.stage+=1):f.step+=1,f))};return[s,a,o,l,c=>l(c[0])]}class bg extends Sr{constructor(t){super(),Er(this,t,Cg,vg,Dt,{})}}function ul(e,t,r){const n=e.slice();return n[7]=t[r],n[9]=r,n}function cl(e,t,r){const n=e.slice();return n[10]=t[r],n}function fl(e,t,r){const n=e.slice();return n[9]=t[r],n}function Eg(e){let t,r,n=e[2],i=[];for(let a=0;a<n.length;a+=1)i[a]=dl(cl(e,n,a));const s=a=>Ie(i[a],1,1,()=>{i[a]=null});return{c(){t=oe("div");for(let a=0;a<i.length;a+=1)i[a].c();pe(t,"class","repetitions svelte-3vlz0t")},m(a,o){me(a,t,o);for(let l=0;l<i.length;l+=1)i[l].m(t,null);r=!0},p(a,o){if(o&4){n=a[2];let l;for(l=0;l<n.length;l+=1){const u=cl(a,n,l);i[l]?(i[l].p(u,o),Se(i[l],1)):(i[l]=dl(u),i[l].c(),Se(i[l],1),i[l].m(t,null))}for(Lr(),l=n.length;l<i.length;l+=1)s(l);Dr()}},i(a){if(!r){for(let o=0;o<n.length;o+=1)Se(i[o]);r=!0}},o(a){i=i.filter(Boolean);for(let o=0;o<i.length;o+=1)Ie(i[o]);r=!1},d(a){a&&ye(t),dn(i,a)}}}function hl(e){let t,r,n;return r=new hr({props:{id:"circle"}}),{c(){t=oe("div"),_t(r.$$.fragment),pe(t,"class","svelte-3vlz0t"),Fr(t,"muted",e[9]>e[10][0])},m(i,s){me(i,t,s),pt(r,t,null),n=!0},p(i,s){(!n||s&4)&&Fr(t,"muted",i[9]>i[10][0])},i(i){n||(Se(r.$$.fragment,i),n=!0)},o(i){Ie(r.$$.fragment,i),n=!1},d(i){i&&ye(t),gt(r)}}}function dl(e){let t,r,n,i=[...Array(e[10][1]).keys()],s=[];for(let o=0;o<i.length;o+=1)s[o]=hl(fl(e,i,o));const a=o=>Ie(s[o],1,1,()=>{s[o]=null});return{c(){t=oe("div");for(let o=0;o<s.length;o+=1)s[o].c();r=it(),pe(t,"class","svelte-3vlz0t")},m(o,l){me(o,t,l);for(let u=0;u<s.length;u+=1)s[u].m(t,null);se(t,r),n=!0},p(o,l){if(l&4){i=[...Array(o[10][1]).keys()];let u;for(u=0;u<i.length;u+=1){const c=fl(o,i,u);s[u]?(s[u].p(c,l),Se(s[u],1)):(s[u]=hl(c),s[u].c(),Se(s[u],1),s[u].m(t,r))}for(Lr(),u=i.length;u<s.length;u+=1)a(u);Dr()}},i(o){if(!n){for(let l=0;l<i.length;l+=1)Se(s[l]);n=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)Ie(s[l]);n=!1},d(o){o&&ye(t),dn(s,o)}}}function pl(e){let t,r,n=e[0].instructions+"",i;return{c(){t=oe("p"),r=oe("em"),i=ft(n)},m(s,a){me(s,t,a),se(t,r),se(r,i)},p(s,a){a&1&&n!==(n=s[0].instructions+"")&&qt(i,n)},d(s){s&&ye(t)}}}function Sg(e){let t,r=e[7]+"",n;return{c(){t=oe("p"),n=ft(r)},m(i,s){me(i,t,s),se(t,n)},p(i,s){s&2&&r!==(r=i[7]+"")&&qt(n,r)},d(i){i&&ye(t)}}}function gl(e){let t,r=e[9]>0&&Sg(e);return{c(){r&&r.c(),t=Ii()},m(n,i){r&&r.m(n,i),me(n,t,i)},p(n,i){n[9]>0&&r.p(n,i)},d(n){r&&r.d(n),n&&ye(t)}}}function _g(e){let t,r,n,i=e[1][0]+"",s,a,o,l,u=e[2].length>0&&Eg(e),c=e[0].instructions!==null&&pl(e),f=e[1],d=[];for(let p=0;p<f.length;p+=1)d[p]=gl(ul(e,f,p));return{c(){u&&u.c(),t=it(),c&&c.c(),r=it(),n=oe("h1"),s=ft(i),a=it();for(let p=0;p<d.length;p+=1)d[p].c();o=Ii()},m(p,g){u&&u.m(p,g),me(p,t,g),c&&c.m(p,g),me(p,r,g),me(p,n,g),se(n,s),me(p,a,g);for(let m=0;m<d.length;m+=1)d[m].m(p,g);me(p,o,g),l=!0},p(p,[g]){if(p[2].length>0&&u.p(p,g),p[0].instructions!==null?c?c.p(p,g):(c=pl(p),c.c(),c.m(r.parentNode,r)):c&&(c.d(1),c=null),(!l||g&2)&&i!==(i=p[1][0]+"")&&qt(s,i),g&2){f=p[1];let m;for(m=0;m<f.length;m+=1){const T=ul(p,f,m);d[m]?d[m].p(T,g):(d[m]=gl(T),d[m].c(),d[m].m(o.parentNode,o))}for(;m<d.length;m+=1)d[m].d(1);d.length=f.length}},i(p){l||(Se(u),l=!0)},o(p){Ie(u),l=!1},d(p){u&&u.d(p),p&&ye(t),c&&c.d(p),p&&ye(r),p&&ye(n),p&&ye(a),dn(d,p),p&&ye(o)}}}function wg(e,t,r){let n,i,s;Xe(e,Ns,c=>r(3,n=c)),Xe(e,Tt,c=>r(4,i=c)),Xe(e,Qn,c=>r(5,s=c));let{item:a}=t;const o=a.id.filter(c=>typeof c!="string"&&c[1]>1),l=()=>{let c=as(s[a.prayer].languages,i.lang,n)[1];for(const f of a.key)c=c[f];return c};let u=l();return Tt.subscribe(c=>{r(1,u=l())}),e.$$set=c=>{"item"in c&&r(0,a=c.item)},[a,u,o]}class Tg extends Sr{constructor(t){super(),Er(this,t,wg,_g,Dt,{item:0})}}function xg(e){let t,r;return t=new Tg({props:{item:e[0][e[1].step]}}),{c(){_t(t.$$.fragment)},m(n,i){pt(t,n,i),r=!0},p(n,i){const s={};i&3&&(s.item=n[0][n[1].step]),t.$set(s)},i(n){r||(Se(t.$$.fragment,n),r=!0)},o(n){Ie(t.$$.fragment,n),r=!1},d(n){gt(t,n)}}}function Ag(e){let t,r;return t=new bg({}),{c(){_t(t.$$.fragment)},m(n,i){pt(t,n,i),r=!0},p:et,i(n){r||(Se(t.$$.fragment,n),r=!0)},o(n){Ie(t.$$.fragment,n),r=!1},d(n){gt(t,n)}}}function Ig(e){let t,r;return t=new mg({}),{c(){_t(t.$$.fragment)},m(n,i){pt(t,n,i),r=!0},p:et,i(n){r||(Se(t.$$.fragment,n),r=!0)},o(n){Ie(t.$$.fragment,n),r=!1},d(n){gt(t,n)}}}function yl(e){let t,r,n,i,s,a;const o=[Ig,Ag,xg],l=[];function u(c,f){return c[1].stage==0?0:c[1].stage==1?1:2}return r=u(e),n=l[r]=o[r](e),{c(){t=oe("div"),n.c(),pe(t,"class","svelte-bvvv0h")},m(c,f){me(c,t,f),l[r].m(t,null),a=!0},p(c,f){let d=r;r=u(c),r===d?l[r].p(c,f):(Lr(),Ie(l[d],1,1,()=>{l[d]=null}),Dr(),n=l[r],n?n.p(c,f):(n=l[r]=o[r](c),n.c()),Se(n,1),n.m(t,null))},i(c){a||(Se(n),Jr(()=>{s&&s.end(1),i=Za(t,Pn,{delay:75,duration:75}),i.start()}),a=!0)},o(c){Ie(n),i&&i.invalidate(),s=eo(t,Pn,{duration:75}),a=!1},d(c){c&&ye(t),l[r].d(),c&&s&&s.end()}}}function ml(e){let t=e[1].step,r,n,i=yl(e);return{c(){i.c(),r=Ii()},m(s,a){i.m(s,a),me(s,r,a),n=!0},p(s,a){a&2&&Dt(t,t=s[1].step)?(Lr(),Ie(i,1,1,et),Dr(),i=yl(s),i.c(),Se(i,1),i.m(r.parentNode,r)):i.p(s,a)},i(s){n||(Se(i),n=!0)},o(s){Ie(i),n=!1},d(s){s&&ye(r),i.d(s)}}}function kg(e){let t,r=e[1].stage,n,i=ml(e);return{c(){t=oe("div"),i.c(),pe(t,"class","prayer svelte-bvvv0h")},m(s,a){me(s,t,a),i.m(t,null),n=!0},p(s,[a]){a&2&&Dt(r,r=s[1].stage)?(Lr(),Ie(i,1,1,et),Dr(),i=ml(s),i.c(),Se(i,1),i.m(t,null)):i.p(s,a)},i(s){n||(Se(i),n=!0)},o(s){Ie(i),n=!1},d(s){s&&ye(t),i.d(s)}}}function Bg(e,t,r){let n,i;Xe(e,Tt,o=>r(1,n=o)),Xe(e,Qn,o=>r(2,i=o));let s=[];const a=()=>{r(0,s=i[n.prayer].generate(n.conf).map(o=>({id:o[0],prayer:o[1].length>0?o[1]:n.prayer,key:o[2],instructions:o.length>3?o[3]:null})))};return a(),Tt.subscribe(o=>{o.stage==2&&(o.step==0&&a(),Lu.set(o.step==s.length-1))}),[s,n]}class Rg extends Sr{constructor(t){super(),Er(this,t,Bg,kg,Dt,{})}}const dr=()=>new Map,os=e=>{const t=dr();return e.forEach((r,n)=>{t.set(n,r)}),t},Zt=(e,t,r)=>{let n=e.get(t);return n===void 0&&e.set(t,n=r()),n},Ng=(e,t)=>{const r=[];for(const[n,i]of e)r.push(t(i,n));return r},Lg=(e,t)=>{for(const[r,n]of e)if(t(n,r))return!0;return!1},vi=()=>new Set,ea=e=>e[e.length-1],Dg=(e,t)=>{for(let r=0;r<t.length;r++)e.push(t[r])},Du=Array.from,OE=Array.isArray;class Ls{constructor(){this._observers=dr()}on(t,r){Zt(this._observers,t,vi).add(r)}once(t,r){const n=(...i)=>{this.off(t,n),r(...i)};this.on(t,n)}off(t,r){const n=this._observers.get(t);n!==void 0&&(n.delete(r),n.size===0&&this._observers.delete(t))}emit(t,r){return Du((this._observers.get(t)||dr()).values()).forEach(n=>n(...r))}destroy(){this._observers=dr()}}const yr=Math.floor,Qi=Math.abs,Ug=Math.log10,to=(e,t)=>e<t?e:t,Cn=(e,t)=>e>t?e:t,Uu=e=>e!==0?e<0:1/e<0,Og=String.fromCharCode,Mg=e=>e.toLowerCase(),Pg=/^\s*/g,Fg=e=>e.replace(Pg,""),Vg=/([A-Z])/g,vl=(e,t)=>Fg(e.replace(Vg,r=>`${t}${Mg(r)}`)),Kg=e=>{const t=unescape(encodeURIComponent(e)),r=t.length,n=new Uint8Array(r);for(let i=0;i<r;i++)n[i]=t.codePointAt(i);return n},Ci=typeof TextEncoder<"u"?new TextEncoder:null,Hg=e=>Ci.encode(e),ba=Ci?Hg:Kg;let di=typeof TextDecoder>"u"?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});di&&di.decode(new Uint8Array).length===1&&(di=null);const Cl=e=>e===void 0?null:e;class $g{constructor(){this.map=new Map}setItem(t,r){this.map.set(t,r)}getItem(t){return this.map.get(t)}}let Ou=new $g,Mu=!0;try{typeof localStorage<"u"&&(Ou=localStorage,Mu=!1)}catch{}const Pu=Ou,Gg=e=>Mu||addEventListener("storage",e),qg=Object.keys,ls=e=>qg(e).length,jg=(e,t)=>{for(const r in e)if(!t(e[r],r))return!1;return!0},Fu=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),zg=(e,t)=>e===t||ls(e)===ls(t)&&jg(e,(r,n)=>(r!==void 0||Fu(t,n))&&t[n]===r),ro=(e,t,r=0)=>{try{for(;r<e.length;r++)e[r](...t)}finally{r<e.length&&ro(e,t,r+1)}},Wg=()=>{},Qg=(e,t)=>e===t,pi=(e,t)=>{if(e==null||t==null)return Qg(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:{if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;break}case Set:{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;break}case Map:{if(e.size!==t.size)return!1;for(const r of e.keys())if(!t.has(r)||!pi(e.get(r),t.get(r)))return!1;break}case Object:if(ls(e)!==ls(t))return!1;for(const r in e)if(!Fu(e,r)||!pi(e[r],t[r]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!pi(e[r],t[r]))return!1;break;default:return!1}return!0},Jg=(e,t)=>t.includes(e),pn=typeof process<"u"&&process.release&&/node|io\.js/.test(process.release.name),Vu=typeof window<"u"&&!pn;typeof navigator<"u"&&/Mac/.test(navigator.platform);let ir;const Yg=()=>{if(ir===void 0)if(pn){ir=dr();const e=process.argv;let t=null;for(let r=0;r<e.length;r++){const n=e[r];n[0]==="-"?(t!==null&&ir.set(t,""),t=n):t!==null&&(ir.set(t,n),t=null)}t!==null&&ir.set(t,"")}else typeof location=="object"?(ir=dr(),(location.search||"?").slice(1).split("&").forEach(e=>{if(e.length!==0){const[t,r]=e.split("=");ir.set(`--${vl(t,"-")}`,r),ir.set(`-${vl(t,"-")}`,r)}})):ir=dr();return ir},Ea=e=>Yg().has(e),us=e=>Cl(pn?process.env[e.toUpperCase()]:Pu.getItem(e)),Xg=e=>Ea("--"+e)||us(e)!==null;Xg("production");const bl=pn&&Jg(process.env.FORCE_COLOR,["true","1","2"]),Zg=!Ea("no-colors")&&(!pn||process.stdout.isTTY||bl)&&(!pn||Ea("color")||bl||us("COLORTERM")!==null||(us("TERM")||"").includes("color")),El=1,Sl=2,ta=4,ra=8,bi=32,kr=64,Gt=128,Ds=31,Sa=63,cn=127,ey=2147483647,Ku=Number.MAX_SAFE_INTEGER,ty=Number.isInteger||(e=>typeof e=="number"&&isFinite(e)&&yr(e)===e),tn=e=>new Error(e),pr=()=>{throw tn("Method unimplemented")},mr=()=>{throw tn("Unexpected case")},Hu=tn("Unexpected end of array"),$u=tn("Integer out of Range");class Us{constructor(t){this.arr=t,this.pos=0}}const _r=e=>new Us(e),ry=e=>e.pos!==e.arr.length,ny=(e,t)=>{const r=so(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,r},bt=e=>ny(e,be(e)),gn=e=>e.arr[e.pos++],be=e=>{let t=0,r=1;const n=e.arr.length;for(;e.pos<n;){const i=e.arr[e.pos++];if(t=t+(i&cn)*r,r*=128,i<Gt)return t;if(t>Ku)throw $u}throw Hu},no=e=>{let t=e.arr[e.pos++],r=t&Sa,n=64;const i=(t&kr)>0?-1:1;if((t&Gt)===0)return i*r;const s=e.arr.length;for(;e.pos<s;){if(t=e.arr[e.pos++],r=r+(t&cn)*n,n*=128,t<Gt)return i*r;if(r>Ku)throw $u}throw Hu},iy=e=>{let t=be(e);if(t===0)return"";{let r=String.fromCodePoint(gn(e));if(--t<100)for(;t--;)r+=String.fromCodePoint(gn(e));else for(;t>0;){const n=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+n);e.pos+=n,r+=String.fromCodePoint.apply(null,i),t-=n}return decodeURIComponent(escape(r))}},sy=e=>di.decode(bt(e)),Br=di?sy:iy,io=(e,t)=>{const r=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,r},ay=e=>io(e,4).getFloat32(0,!1),oy=e=>io(e,8).getFloat64(0,!1),ly=e=>io(e,8).getBigInt64(0,!1),uy=[e=>{},e=>null,no,ay,oy,ly,e=>!1,e=>!0,Br,e=>{const t=be(e),r={};for(let n=0;n<t;n++){const i=Br(e);r[i]=Fn(e)}return r},e=>{const t=be(e),r=[];for(let n=0;n<t;n++)r.push(Fn(e));return r},bt],Fn=e=>uy[127-gn(e)](e);class _l extends Us{constructor(t,r){super(t),this.reader=r,this.s=null,this.count=0}read(){return this.count===0&&(this.s=this.reader(this),ry(this)?this.count=be(this)+1:this.count=-1),this.count--,this.s}}class Ji extends Us{constructor(t){super(t),this.s=0,this.count=0}read(){if(this.count===0){this.s=no(this);const t=Uu(this.s);this.count=1,t&&(this.s=-this.s,this.count=be(this)+2)}return this.count--,this.s}}class na extends Us{constructor(t){super(t),this.s=0,this.count=0,this.diff=0}read(){if(this.count===0){const t=no(this),r=t&1;this.diff=yr(t/2),this.count=1,r&&(this.count=be(this)+2)}return this.s+=this.diff,this.count--,this.s}}class cy{constructor(t){this.decoder=new Ji(t),this.str=Br(this.decoder),this.spos=0}read(){const t=this.spos+this.decoder.read(),r=this.str.slice(this.spos,t);return this.spos=t,r}}const Gu=e=>new Uint8Array(e),so=(e,t,r)=>new Uint8Array(e,t,r),fy=e=>new Uint8Array(e),hy=e=>{let t="";for(let r=0;r<e.byteLength;r++)t+=Og(e[r]);return btoa(t)},dy=e=>Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),py=e=>{const t=atob(e),r=Gu(t.length);for(let n=0;n<t.length;n++)r[n]=t.charCodeAt(n);return r},gy=e=>{const t=Buffer.from(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)},qu=Vu?hy:dy,ju=Vu?py:gy,yy=e=>{const t=Gu(e.byteLength);return t.set(e),t};class ki{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}const St=()=>new ki,my=e=>{let t=e.cpos;for(let r=0;r<e.bufs.length;r++)t+=e.bufs[r].length;return t},at=e=>{const t=new Uint8Array(my(e));let r=0;for(let n=0;n<e.bufs.length;n++){const i=e.bufs[n];t.set(i,r),r+=i.length}return t.set(so(e.cbuf.buffer,0,e.cpos),r),t},vy=(e,t)=>{const r=e.cbuf.length;r-e.cpos<t&&(e.bufs.push(so(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(Cn(r,t)*2),e.cpos=0)},Ct=(e,t)=>{const r=e.cbuf.length;e.cpos===r&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(r*2),e.cpos=0),e.cbuf[e.cpos++]=t},Ei=Ct,fe=(e,t)=>{for(;t>cn;)Ct(e,Gt|cn&t),t=yr(t/128);Ct(e,cn&t)},ao=(e,t)=>{const r=Uu(t);for(r&&(t=-t),Ct(e,(t>Sa?Gt:0)|(r?kr:0)|Sa&t),t=yr(t/64);t>0;)Ct(e,(t>cn?Gt:0)|cn&t),t=yr(t/128)},_a=new Uint8Array(3e4),Cy=_a.length/3,by=(e,t)=>{if(t.length<Cy){const r=Ci.encodeInto(t,_a).written||0;fe(e,r);for(let n=0;n<r;n++)Ct(e,_a[n])}else ct(e,ba(t))},Ey=(e,t)=>{const r=unescape(encodeURIComponent(t)),n=r.length;fe(e,n);for(let i=0;i<n;i++)Ct(e,r.codePointAt(i))},gr=Ci&&Ci.encodeInto?by:Ey,Os=(e,t)=>{const r=e.cbuf.length,n=e.cpos,i=to(r-n,t.length),s=t.length-i;e.cbuf.set(t.subarray(0,i),n),e.cpos+=i,s>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(Cn(r*2,s)),e.cbuf.set(t.subarray(i)),e.cpos=s)},ct=(e,t)=>{fe(e,t.byteLength),Os(e,t)},oo=(e,t)=>{vy(e,t);const r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},Sy=(e,t)=>oo(e,4).setFloat32(0,t,!1),_y=(e,t)=>oo(e,8).setFloat64(0,t,!1),wy=(e,t)=>oo(e,8).setBigInt64(0,t,!1),wl=new DataView(new ArrayBuffer(4)),Ty=e=>(wl.setFloat32(0,e),wl.getFloat32(0)===e),Vn=(e,t)=>{switch(typeof t){case"string":Ct(e,119),gr(e,t);break;case"number":ty(t)&&Qi(t)<=ey?(Ct(e,125),ao(e,t)):Ty(t)?(Ct(e,124),Sy(e,t)):(Ct(e,123),_y(e,t));break;case"bigint":Ct(e,122),wy(e,t);break;case"object":if(t===null)Ct(e,126);else if(t instanceof Array){Ct(e,117),fe(e,t.length);for(let r=0;r<t.length;r++)Vn(e,t[r])}else if(t instanceof Uint8Array)Ct(e,116),ct(e,t);else{Ct(e,118);const r=Object.keys(t);fe(e,r.length);for(let n=0;n<r.length;n++){const i=r[n];gr(e,i),Vn(e,t[i])}}break;case"boolean":Ct(e,t?120:121);break;default:Ct(e,127)}};class Tl extends ki{constructor(t){super(),this.w=t,this.s=null,this.count=0}write(t){this.s===t?this.count++:(this.count>0&&fe(this,this.count-1),this.count=1,this.w(this,t),this.s=t)}}const xl=e=>{e.count>0&&(ao(e.encoder,e.count===1?e.s:-e.s),e.count>1&&fe(e.encoder,e.count-2))};class Yi{constructor(){this.encoder=new ki,this.s=0,this.count=0}write(t){this.s===t?this.count++:(xl(this),this.count=1,this.s=t)}toUint8Array(){return xl(this),at(this.encoder)}}const Al=e=>{if(e.count>0){const t=e.diff*2+(e.count===1?0:1);ao(e.encoder,t),e.count>1&&fe(e.encoder,e.count-2)}};class ia{constructor(){this.encoder=new ki,this.s=0,this.count=0,this.diff=0}write(t){this.diff===t-this.s?(this.s=t,this.count++):(Al(this),this.count=1,this.diff=t-this.s,this.s=t)}toUint8Array(){return Al(this),at(this.encoder)}}class xy{constructor(){this.sarr=[],this.s="",this.lensE=new Yi}write(t){this.s+=t,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(t.length)}toUint8Array(){const t=new ki;return this.sarr.push(this.s),this.s="",gr(t,this.sarr.join("")),Os(t,this.lensE.toUint8Array()),at(t)}}const Il=typeof crypto>"u"?null:crypto,Ay=Il!==null?e=>{const t=new ArrayBuffer(e),r=new Uint8Array(t);return Il.getRandomValues(r),t}:e=>{const t=new ArrayBuffer(e),r=new Uint8Array(t);for(let n=0;n<e;n++)r[n]=Math.ceil(Math.random()*4294967295>>>0);return t},Iy=Math.random,zu=()=>new Uint32Array(Ay(4))[0],ky=[1e7]+-1e3+-4e3+-8e3+-1e11,Wu=()=>ky.replace(/[018]/g,e=>(e^zu()&15>>e/4).toString(16)),Nr=Date.now,By=e=>new Promise(e),Ry=e=>Promise.reject(e),lo=e=>Promise.resolve(e),Ur=Symbol;class Ny{constructor(t,r){this.left=t,this.right=r}}const Tr=(e,t)=>new Ny(e,t),bn=typeof document<"u"?document:{};typeof DOMParser<"u"&&new DOMParser;const Ly=e=>Ng(e,(t,r)=>`${r}:${t};`).join("");bn.ELEMENT_NODE;bn.TEXT_NODE;bn.CDATA_SECTION_NODE;bn.COMMENT_NODE;bn.DOCUMENT_NODE;bn.DOCUMENT_TYPE_NODE;bn.DOCUMENT_FRAGMENT_NODE;const $t=Ur(),Yr=Ur(),uo=Ur(),Ms=Ur(),co=Ur(),fo=Ur(),ho=Ur(),Ps=Ur(),Bi=Ur(),Dy={[$t]:Tr("font-weight","bold"),[Yr]:Tr("font-weight","normal"),[uo]:Tr("color","blue"),[co]:Tr("color","green"),[Ms]:Tr("color","grey"),[fo]:Tr("color","red"),[ho]:Tr("color","purple"),[Ps]:Tr("color","orange"),[Bi]:Tr("color","black")},Qu={[$t]:"\x1B[1m",[Yr]:"\x1B[2m",[uo]:"\x1B[34m",[co]:"\x1B[32m",[Ms]:"\x1B[37m",[fo]:"\x1B[31m",[ho]:"\x1B[35m",[Ps]:"\x1B[38;5;208m",[Bi]:"\x1B[0m"},Uy=e=>{const t=[],r=[],n=dr();let i=[],s=0;for(;s<e.length;s++){const a=e[s],o=Dy[a];if(o!==void 0)n.set(o.left,o.right);else if(a.constructor===String||a.constructor===Number){const l=Ly(n);s>0||l.length>0?(t.push("%c"+a),r.push(l)):t.push(a)}else break}for(s>0&&(i=r,i.unshift(t.join("")));s<e.length;s++){const a=e[s];a instanceof Symbol||i.push(a)}return i},Oy=e=>{const t=[],r=[];let n=0;for(;n<e.length;n++){const i=e[n];if(Qu[i]===void 0)if(i.constructor===String||i.constructor===Number)t.push(i);else break}for(n>0&&r.push(t.join(""));n<e.length;n++){const i=e[n];i instanceof Symbol||(i.constructor===Object?r.push(JSON.stringify(i)):r.push(i))}return r},My=e=>{const t=[],r=[];let n=0;for(;n<e.length;n++){const i=e[n],s=Qu[i];if(s!==void 0)t.push(s);else if(i.constructor===String||i.constructor===Number)t.push(i);else break}for(n>0&&(t.push("\x1B[0m"),r.push(t.join("")));n<e.length;n++){const i=e[n];i instanceof Symbol||r.push(i)}return r},Py=Zg?pn?My:Uy:Oy,Ju=(...e)=>{console.log(...Py(e)),Fy.forEach(t=>t.print(e))},Fy=new Set,kl=[co,ho,Ps,uo];let sa=0,Bl=Nr();const Vy=e=>{const t=kl[sa],r=us("log"),n=r!==null&&(r==="*"||r==="true"||new RegExp(r,"gi").test(e));return sa=(sa+1)%kl.length,e+=": ",n?(...i)=>{const s=Nr(),a=s-Bl;Bl=s,Ju(t,e,Bi,...i.map(o=>typeof o=="string"||typeof o=="symbol"?o:JSON.stringify(o)),t," +"+a+"ms")}:Wg},Yu=e=>({[Symbol.iterator](){return this},next:e}),Ky=(e,t)=>Yu(()=>{let r;do r=e.next();while(!r.done&&!t(r.value));return r}),aa=(e,t)=>Yu(()=>{const{done:r,value:n}=e.next();return{done:r,value:r?void 0:t(n)}});class po{constructor(t,r){this.clock=t,this.len=r}}class Ri{constructor(){this.clients=new Map}}const wa=(e,t,r)=>t.clients.forEach((n,i)=>{const s=e.doc.store.clients.get(i);for(let a=0;a<n.length;a++){const o=n[a];fc(e,s,o.clock,o.len,r)}}),Hy=(e,t)=>{let r=0,n=e.length-1;for(;r<=n;){const i=yr((r+n)/2),s=e[i],a=s.clock;if(a<=t){if(t<a+s.len)return i;r=i+1}else n=i-1}return null},Xu=(e,t)=>{const r=e.clients.get(t.client);return r!==void 0&&Hy(r,t.clock)!==null},go=e=>{e.clients.forEach(t=>{t.sort((i,s)=>i.clock-s.clock);let r,n;for(r=1,n=1;r<t.length;r++){const i=t[n-1],s=t[r];i.clock+i.len>=s.clock?i.len=Cn(i.len,s.clock+s.len-i.clock):(n<r&&(t[n]=s),n++)}t.length=n})},$y=e=>{const t=new Ri;for(let r=0;r<e.length;r++)e[r].clients.forEach((n,i)=>{if(!t.clients.has(i)){const s=n.slice();for(let a=r+1;a<e.length;a++)Dg(s,e[a].clients.get(i)||[]);t.clients.set(i,s)}});return go(t),t},cs=(e,t,r,n)=>{Zt(e.clients,t,()=>[]).push(new po(r,n))},Zu=()=>new Ri,Gy=e=>{const t=Zu();return e.clients.forEach((r,n)=>{const i=[];for(let s=0;s<r.length;s++){const a=r[s];if(a.deleted){const o=a.id.clock;let l=a.length;if(s+1<r.length)for(let u=r[s+1];s+1<r.length&&u.deleted;u=r[++s+1])l+=u.length;i.push(new po(o,l))}}i.length>0&&t.clients.set(n,i)}),t},Jn=(e,t)=>{fe(e.restEncoder,t.clients.size),t.clients.forEach((r,n)=>{e.resetDsCurVal(),fe(e.restEncoder,n);const i=r.length;fe(e.restEncoder,i);for(let s=0;s<i;s++){const a=r[s];e.writeDsClock(a.clock),e.writeDsLen(a.len)}})},yo=e=>{const t=new Ri,r=be(e.restDecoder);for(let n=0;n<r;n++){e.resetDsCurVal();const i=be(e.restDecoder),s=be(e.restDecoder);if(s>0){const a=Zt(t.clients,i,()=>[]);for(let o=0;o<s;o++)a.push(new po(e.readDsClock(),e.readDsLen()))}}return t},Rl=(e,t,r)=>{const n=new Ri,i=be(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();const a=be(e.restDecoder),o=be(e.restDecoder),l=r.clients.get(a)||[],u=xt(r,a);for(let c=0;c<o;c++){const f=e.readDsClock(),d=f+e.readDsLen();if(f<u){u<d&&cs(n,a,u,d-u);let p=vr(l,f),g=l[p];for(!g.deleted&&g.id.clock<f&&(l.splice(p+1,0,ms(t,g,f-g.id.clock)),p++);p<l.length&&(g=l[p++],g.id.clock<d);)g.deleted||(d<g.id.clock+g.length&&l.splice(p,0,ms(t,g,d-g.id.clock)),g.delete(t))}else cs(n,a,f,d-f)}}if(n.clients.size>0){const s=new yn;return fe(s.restEncoder,0),Jn(s,n),s.toUint8Array()}return null},ec=zu;class Yn extends Ls{constructor({guid:t=Wu(),collectionid:r=null,gc:n=!0,gcFilter:i=()=>!0,meta:s=null,autoLoad:a=!1,shouldLoad:o=!0}={}){super(),this.gc=n,this.gcFilter=i,this.clientID=ec(),this.guid=t,this.collectionid=r,this.share=new Map,this.store=new uc,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=a,this.meta=s,this.isLoaded=!1,this.whenLoaded=By(l=>{this.on("load",()=>{this.isLoaded=!0,l(this)})})}load(){const t=this._item;t!==null&&!this.shouldLoad&&qe(t.parent.doc,r=>{r.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(Array.from(this.subdocs).map(t=>t.guid))}transact(t,r=null){qe(this,t,r)}get(t,r=Nt){const n=Zt(this.share,t,()=>{const s=new r;return s._integrate(this,null),s}),i=n.constructor;if(r!==Nt&&i!==r)if(i===Nt){const s=new r;s._map=n._map,n._map.forEach(a=>{for(;a!==null;a=a.left)a.parent=s}),s._start=n._start;for(let a=s._start;a!==null;a=a.right)a.parent=s;return s._length=n._length,this.share.set(t,s),s._integrate(this,null),s}else throw new Error(`Type with the name ${t} has already been defined with a different constructor`);return n}getArray(t=""){return this.get(t,On)}getText(t=""){return this.get(t,$n)}getMap(t=""){return this.get(t,Hn)}getXmlFragment(t=""){return this.get(t,mn)}toJSON(){const t={};return this.share.forEach((r,n)=>{t[n]=r.toJSON()}),t}destroy(){Du(this.subdocs).forEach(r=>r.destroy());const t=this._item;if(t!==null){this._item=null;const r=t.content;r.doc=new Yn({guid:this.guid,...r.opts,shouldLoad:!1}),r.doc._item=t,qe(t.parent.doc,n=>{const i=r.doc;t.deleted||n.subdocsAdded.add(i),n.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}on(t,r){super.on(t,r)}off(t,r){super.off(t,r)}}class tc{constructor(t){this.restDecoder=t}resetDsCurVal(){}readDsClock(){return be(this.restDecoder)}readDsLen(){return be(this.restDecoder)}}class rc extends tc{readLeftID(){return Le(be(this.restDecoder),be(this.restDecoder))}readRightID(){return Le(be(this.restDecoder),be(this.restDecoder))}readClient(){return be(this.restDecoder)}readInfo(){return gn(this.restDecoder)}readString(){return Br(this.restDecoder)}readParentInfo(){return be(this.restDecoder)===1}readTypeRef(){return be(this.restDecoder)}readLen(){return be(this.restDecoder)}readAny(){return Fn(this.restDecoder)}readBuf(){return yy(bt(this.restDecoder))}readJSON(){return JSON.parse(Br(this.restDecoder))}readKey(){return Br(this.restDecoder)}}class qy{constructor(t){this.dsCurrVal=0,this.restDecoder=t}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=be(this.restDecoder),this.dsCurrVal}readDsLen(){const t=be(this.restDecoder)+1;return this.dsCurrVal+=t,t}}class Kn extends qy{constructor(t){super(t),this.keys=[],be(t),this.keyClockDecoder=new na(bt(t)),this.clientDecoder=new Ji(bt(t)),this.leftClockDecoder=new na(bt(t)),this.rightClockDecoder=new na(bt(t)),this.infoDecoder=new _l(bt(t),gn),this.stringDecoder=new cy(bt(t)),this.parentInfoDecoder=new _l(bt(t),gn),this.typeRefDecoder=new Ji(bt(t)),this.lenDecoder=new Ji(bt(t))}readLeftID(){return new Un(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new Un(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return this.parentInfoDecoder.read()===1}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return Fn(this.restDecoder)}readBuf(){return bt(this.restDecoder)}readJSON(){return Fn(this.restDecoder)}readKey(){const t=this.keyClockDecoder.read();if(t<this.keys.length)return this.keys[t];{const r=this.stringDecoder.read();return this.keys.push(r),r}}}class nc{constructor(){this.restEncoder=St()}toUint8Array(){return at(this.restEncoder)}resetDsCurVal(){}writeDsClock(t){fe(this.restEncoder,t)}writeDsLen(t){fe(this.restEncoder,t)}}class Ni extends nc{writeLeftID(t){fe(this.restEncoder,t.client),fe(this.restEncoder,t.clock)}writeRightID(t){fe(this.restEncoder,t.client),fe(this.restEncoder,t.clock)}writeClient(t){fe(this.restEncoder,t)}writeInfo(t){Ei(this.restEncoder,t)}writeString(t){gr(this.restEncoder,t)}writeParentInfo(t){fe(this.restEncoder,t?1:0)}writeTypeRef(t){fe(this.restEncoder,t)}writeLen(t){fe(this.restEncoder,t)}writeAny(t){Vn(this.restEncoder,t)}writeBuf(t){ct(this.restEncoder,t)}writeJSON(t){gr(this.restEncoder,JSON.stringify(t))}writeKey(t){gr(this.restEncoder,t)}}class ic{constructor(){this.restEncoder=St(),this.dsCurrVal=0}toUint8Array(){return at(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(t){const r=t-this.dsCurrVal;this.dsCurrVal=t,fe(this.restEncoder,r)}writeDsLen(t){t===0&&mr(),fe(this.restEncoder,t-1),this.dsCurrVal+=t}}class yn extends ic{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new ia,this.clientEncoder=new Yi,this.leftClockEncoder=new ia,this.rightClockEncoder=new ia,this.infoEncoder=new Tl(Ei),this.stringEncoder=new xy,this.parentInfoEncoder=new Tl(Ei),this.typeRefEncoder=new Yi,this.lenEncoder=new Yi}toUint8Array(){const t=St();return fe(t,0),ct(t,this.keyClockEncoder.toUint8Array()),ct(t,this.clientEncoder.toUint8Array()),ct(t,this.leftClockEncoder.toUint8Array()),ct(t,this.rightClockEncoder.toUint8Array()),ct(t,at(this.infoEncoder)),ct(t,this.stringEncoder.toUint8Array()),ct(t,at(this.parentInfoEncoder)),ct(t,this.typeRefEncoder.toUint8Array()),ct(t,this.lenEncoder.toUint8Array()),Os(t,at(this.restEncoder)),at(t)}writeLeftID(t){this.clientEncoder.write(t.client),this.leftClockEncoder.write(t.clock)}writeRightID(t){this.clientEncoder.write(t.client),this.rightClockEncoder.write(t.clock)}writeClient(t){this.clientEncoder.write(t)}writeInfo(t){this.infoEncoder.write(t)}writeString(t){this.stringEncoder.write(t)}writeParentInfo(t){this.parentInfoEncoder.write(t?1:0)}writeTypeRef(t){this.typeRefEncoder.write(t)}writeLen(t){this.lenEncoder.write(t)}writeAny(t){Vn(this.restEncoder,t)}writeBuf(t){ct(this.restEncoder,t)}writeJSON(t){Vn(this.restEncoder,t)}writeKey(t){const r=this.keyMap.get(t);r===void 0?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(t)):this.keyClockEncoder.write(r)}}const jy=(e,t,r,n)=>{n=Cn(n,t[0].id.clock);const i=vr(t,n);fe(e.restEncoder,t.length-i),e.writeClient(r),fe(e.restEncoder,n);const s=t[i];s.write(e,n-s.id.clock);for(let a=i+1;a<t.length;a++)t[a].write(e,0)},mo=(e,t,r)=>{const n=new Map;r.forEach((i,s)=>{xt(t,s)>i&&n.set(s,i)}),Fs(t).forEach((i,s)=>{r.has(s)||n.set(s,0)}),fe(e.restEncoder,n.size),Array.from(n.entries()).sort((i,s)=>s[0]-i[0]).forEach(([i,s])=>{jy(e,t.clients.get(i),i,s)})},zy=(e,t)=>{const r=dr(),n=be(e.restDecoder);for(let i=0;i<n;i++){const s=be(e.restDecoder),a=new Array(s),o=e.readClient();let l=be(e.restDecoder);r.set(o,{i:0,refs:a});for(let u=0;u<s;u++){const c=e.readInfo();switch(Ds&c){case 0:{const f=e.readLen();a[u]=new zt(Le(o,l),f),l+=f;break}case 10:{const f=be(e.restDecoder);a[u]=new Wt(Le(o,l),f),l+=f;break}default:{const f=(c&(kr|Gt))===0,d=new yt(Le(o,l),null,(c&Gt)===Gt?e.readLeftID():null,null,(c&kr)===kr?e.readRightID():null,f?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,f&&(c&bi)===bi?e.readString():null,Bc(e,c));a[u]=d,l+=d.length}}}}return r},Wy=(e,t,r)=>{const n=[];let i=Array.from(r.keys()).sort((p,g)=>p-g);if(i.length===0)return null;const s=()=>{if(i.length===0)return null;let p=r.get(i[i.length-1]);for(;p.refs.length===p.i;)if(i.pop(),i.length>0)p=r.get(i[i.length-1]);else return null;return p};let a=s();if(a===null&&n.length===0)return null;const o=new uc,l=new Map,u=(p,g)=>{const m=l.get(p);(m==null||m>g)&&l.set(p,g)};let c=a.refs[a.i++];const f=new Map,d=()=>{for(const p of n){const g=p.id.client,m=r.get(g);m?(m.i--,o.clients.set(g,m.refs.slice(m.i)),r.delete(g),m.i=0,m.refs=[]):o.clients.set(g,[p]),i=i.filter(T=>T!==g)}n.length=0};for(;;){if(c.constructor!==Wt){const g=Zt(f,c.id.client,()=>xt(t,c.id.client))-c.id.clock;if(g<0)n.push(c),u(c.id.client,c.id.clock-1),d();else{const m=c.getMissing(e,t);if(m!==null){n.push(c);const T=r.get(m)||{refs:[],i:0};if(T.refs.length===T.i)u(m,xt(t,m)),d();else{c=T.refs[T.i++];continue}}else(g===0||g<c.length)&&(c.integrate(e,g),f.set(c.id.client,c.id.clock+c.length))}}if(n.length>0)c=n.pop();else if(a!==null&&a.i<a.refs.length)c=a.refs[a.i++];else{if(a=s(),a===null)break;c=a.refs[a.i++]}}if(o.clients.size>0){const p=new yn;return mo(p,o,new Map),fe(p.restEncoder,0),{missing:l,update:p.toUint8Array()}}return null},Qy=(e,t)=>mo(e,t.doc.store,t.beforeState),Jy=(e,t,r,n=new Kn(e))=>qe(t,i=>{i.local=!1;let s=!1;const a=i.doc,o=a.store,l=zy(n,a),u=Wy(i,o,l),c=o.pendingStructs;if(c){for(const[d,p]of c.missing)if(p<xt(o,d)){s=!0;break}if(u){for(const[d,p]of u.missing){const g=c.missing.get(d);(g==null||g>p)&&c.missing.set(d,p)}c.update=fs([c.update,u.update])}}else o.pendingStructs=u;const f=Rl(n,i,o);if(o.pendingDs){const d=new Kn(_r(o.pendingDs));be(d.restDecoder);const p=Rl(d,i,o);f&&p?o.pendingDs=fs([f,p]):o.pendingDs=f||p}else o.pendingDs=f;if(s){const d=o.pendingStructs.update;o.pendingStructs=null,sc(i.doc,d)}},r,!1),sc=(e,t,r,n=Kn)=>{const i=_r(t);Jy(i,e,r,new n(i))},Yy=(e,t,r)=>sc(e,t,r,rc),Xy=(e,t,r=new Map)=>{mo(e,t.store,r),Jn(e,Gy(t.store))},Zy=(e,t=new Uint8Array([0]),r=new yn)=>{const n=ac(t);Xy(r,e,n);const i=[r.toUint8Array()];if(e.store.pendingDs&&i.push(e.store.pendingDs),e.store.pendingStructs&&i.push(mm(e.store.pendingStructs.update,t)),i.length>1){if(r.constructor===Ni)return gm(i.map((s,a)=>a===0?s:Cm(s)));if(r.constructor===yn)return fs(i)}return i[0]},em=(e,t)=>Zy(e,t,new Ni),tm=e=>{const t=new Map,r=be(e.restDecoder);for(let n=0;n<r;n++){const i=be(e.restDecoder),s=be(e.restDecoder);t.set(i,s)}return t},ac=e=>tm(new tc(_r(e))),oc=(e,t)=>(fe(e.restEncoder,t.size),Array.from(t.entries()).sort((r,n)=>n[0]-r[0]).forEach(([r,n])=>{fe(e.restEncoder,r),fe(e.restEncoder,n)}),e),rm=(e,t)=>oc(e,Fs(t.store)),nm=(e,t=new ic)=>(e instanceof Map?oc(t,e):rm(t,e),t.toUint8Array()),im=e=>nm(e,new nc);class sm{constructor(){this.l=[]}}const Nl=()=>new sm,Ll=(e,t)=>e.l.push(t),Dl=(e,t)=>{const r=e.l,n=r.length;e.l=r.filter(i=>t!==i),n===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},lc=(e,t,r)=>ro(e.l,[t,r]);class Un{constructor(t,r){this.client=t,this.clock=r}}const Fi=(e,t)=>e===t||e!==null&&t!==null&&e.client===t.client&&e.clock===t.clock,Le=(e,t)=>new Un(e,t),am=e=>{for(const[t,r]of e.doc.share.entries())if(r===e)return t;throw mr()};class om{constructor(t,r){this.ds=t,this.sv=r}}const lm=(e,t)=>new om(e,t);lm(Zu(),new Map);const si=(e,t)=>t===void 0?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!Xu(t.ds,e.id),Ta=(e,t)=>{const r=Zt(e.meta,Ta,vi),n=e.doc.store;r.has(t)||(t.sv.forEach((i,s)=>{i<xt(n,s)&&Xr(e,Le(s,i))}),wa(e,t.ds,i=>{}),r.add(t))};class uc{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}const Fs=e=>{const t=new Map;return e.clients.forEach((r,n)=>{const i=r[r.length-1];t.set(n,i.id.clock+i.length)}),t},xt=(e,t)=>{const r=e.clients.get(t);if(r===void 0)return 0;const n=r[r.length-1];return n.id.clock+n.length},cc=(e,t)=>{let r=e.clients.get(t.id.client);if(r===void 0)r=[],e.clients.set(t.id.client,r);else{const n=r[r.length-1];if(n.id.clock+n.length!==t.id.clock)throw mr()}r.push(t)},vr=(e,t)=>{let r=0,n=e.length-1,i=e[n],s=i.id.clock;if(s===t)return n;let a=yr(t/(s+i.length-1)*n);for(;r<=n;){if(i=e[a],s=i.id.clock,s<=t){if(t<s+i.length)return a;r=a+1}else n=a-1;a=yr((r+n)/2)}throw mr()},um=(e,t)=>{const r=e.clients.get(t.client);return r[vr(r,t.clock)]},oa=um,xa=(e,t,r)=>{const n=vr(t,r),i=t[n];return i.id.clock<r&&i instanceof yt?(t.splice(n+1,0,ms(e,i,r-i.id.clock)),n+1):n},Xr=(e,t)=>{const r=e.doc.store.clients.get(t.client);return r[xa(e,r,t.clock)]},Ul=(e,t,r)=>{const n=t.clients.get(r.client),i=vr(n,r.clock),s=n[i];return r.clock!==s.id.clock+s.length-1&&s.constructor!==zt&&n.splice(i+1,0,ms(e,s,r.clock-s.id.clock+1)),s},cm=(e,t,r)=>{const n=e.clients.get(t.id.client);n[vr(n,t.id.clock)]=r},fc=(e,t,r,n,i)=>{if(n===0)return;const s=r+n;let a=xa(e,t,r),o;do o=t[a++],s<o.id.clock+o.length&&xa(e,t,s),i(o);while(a<t.length&&t[a].id.clock<s)};class fm{constructor(t,r,n){this.doc=t,this.deleteSet=new Ri,this.beforeState=Fs(t.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=r,this.meta=new Map,this.local=n,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set}}const Ol=(e,t)=>t.deleteSet.clients.size===0&&!Lg(t.afterState,(r,n)=>t.beforeState.get(n)!==r)?!1:(go(t.deleteSet),Qy(e,t),Jn(e,t.deleteSet),!0),Ml=(e,t,r)=>{const n=t._item;(n===null||n.id.clock<(e.beforeState.get(n.id.client)||0)&&!n.deleted)&&Zt(e.changed,t,vi).add(r)},Xi=(e,t)=>{const r=e[t-1],n=e[t];r.deleted===n.deleted&&r.constructor===n.constructor&&r.mergeWith(n)&&(e.splice(t,1),n instanceof yt&&n.parentSub!==null&&n.parent._map.get(n.parentSub)===n&&n.parent._map.set(n.parentSub,r))},hm=(e,t,r)=>{for(const[n,i]of e.clients.entries()){const s=t.clients.get(n);for(let a=i.length-1;a>=0;a--){const o=i[a],l=o.clock+o.len;for(let u=vr(s,o.clock),c=s[u];u<s.length&&c.id.clock<l;c=s[++u]){const f=s[u];if(o.clock+o.len<=f.id.clock)break;f instanceof yt&&f.deleted&&!f.keep&&r(f)&&f.gc(t,!1)}}}},dm=(e,t)=>{e.clients.forEach((r,n)=>{const i=t.clients.get(n);for(let s=r.length-1;s>=0;s--){const a=r[s],o=to(i.length-1,1+vr(i,a.clock+a.len-1));for(let l=o,u=i[l];l>0&&u.id.clock>=a.clock;u=i[--l])Xi(i,l)}})},hc=(e,t)=>{if(t<e.length){const r=e[t],n=r.doc,i=n.store,s=r.deleteSet,a=r._mergeStructs;try{go(s),r.afterState=Fs(r.doc.store),n.emit("beforeObserverCalls",[r,n]);const o=[];r.changed.forEach((l,u)=>o.push(()=>{(u._item===null||!u._item.deleted)&&u._callObserver(r,l)})),o.push(()=>{r.changedParentTypes.forEach((l,u)=>o.push(()=>{(u._item===null||!u._item.deleted)&&(l=l.filter(c=>c.target._item===null||!c.target._item.deleted),l.forEach(c=>{c.currentTarget=u}),l.sort((c,f)=>c.path.length-f.path.length),lc(u._dEH,l,r))})),o.push(()=>n.emit("afterTransaction",[r,n]))}),ro(o,[])}finally{n.gc&&hm(s,i,n.gcFilter),dm(s,i),r.afterState.forEach((c,f)=>{const d=r.beforeState.get(f)||0;if(d!==c){const p=i.clients.get(f),g=Cn(vr(p,d),1);for(let m=p.length-1;m>=g;m--)Xi(p,m)}});for(let c=0;c<a.length;c++){const{client:f,clock:d}=a[c].id,p=i.clients.get(f),g=vr(p,d);g+1<p.length&&Xi(p,g+1),g>0&&Xi(p,g)}if(!r.local&&r.afterState.get(n.clientID)!==r.beforeState.get(n.clientID)&&(Ju(Ps,$t,"[yjs] ",Yr,fo,"Changed the client-id because another client seems to be using it."),n.clientID=ec()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){const c=new Ni;Ol(c,r)&&n.emit("update",[c.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){const c=new yn;Ol(c,r)&&n.emit("updateV2",[c.toUint8Array(),r.origin,n,r])}const{subdocsAdded:o,subdocsLoaded:l,subdocsRemoved:u}=r;(o.size>0||u.size>0||l.size>0)&&(o.forEach(c=>{c.clientID=n.clientID,c.collectionid==null&&(c.collectionid=n.collectionid),n.subdocs.add(c)}),u.forEach(c=>n.subdocs.delete(c)),n.emit("subdocs",[{loaded:l,added:o,removed:u},n,r]),u.forEach(c=>c.destroy())),e.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,e])):hc(e,t+1)}}},qe=(e,t,r=null,n=!0)=>{const i=e._transactionCleanups;let s=!1;e._transaction===null&&(s=!0,e._transaction=new fm(e,r,n),i.push(e._transaction),i.length===1&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{t(e._transaction)}finally{if(s){const a=e._transaction===i[0];e._transaction=null,a&&hc(i,0)}}};function*pm(e){const t=be(e.restDecoder);for(let r=0;r<t;r++){const n=be(e.restDecoder),i=e.readClient();let s=be(e.restDecoder);for(let a=0;a<n;a++){const o=e.readInfo();if(o===10){const l=be(e.restDecoder);yield new Wt(Le(i,s),l),s+=l}else if((Ds&o)!==0){const l=(o&(kr|Gt))===0,u=new yt(Le(i,s),null,(o&Gt)===Gt?e.readLeftID():null,null,(o&kr)===kr?e.readRightID():null,l?e.readParentInfo()?e.readString():e.readLeftID():null,l&&(o&bi)===bi?e.readString():null,Bc(e,o));yield u,s+=u.length}else{const l=e.readLen();yield new zt(Le(i,s),l),s+=l}}}}class vo{constructor(t,r){this.gen=pm(t),this.curr=null,this.done=!1,this.filterSkips=r,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&this.curr!==null&&this.curr.constructor===Wt);return this.curr}}class Co{constructor(t){this.currClient=0,this.startClock=0,this.written=0,this.encoder=t,this.clientStructs=[]}}const gm=e=>fs(e,rc,Ni),ym=(e,t)=>{if(e.constructor===zt){const{client:r,clock:n}=e.id;return new zt(Le(r,n+t),e.length-t)}else if(e.constructor===Wt){const{client:r,clock:n}=e.id;return new Wt(Le(r,n+t),e.length-t)}else{const r=e,{client:n,clock:i}=r.id;return new yt(Le(n,i+t),null,Le(n,i+t-1),null,r.rightOrigin,r.parent,r.parentSub,r.content.splice(t))}},fs=(e,t=Kn,r=yn)=>{if(e.length===1)return e[0];const n=e.map(c=>new t(_r(c)));let i=n.map(c=>new vo(c,!0)),s=null;const a=new r,o=new Co(a);for(;i=i.filter(d=>d.curr!==null),i.sort((d,p)=>{if(d.curr.id.client===p.curr.id.client){const g=d.curr.id.clock-p.curr.id.clock;return g===0?d.curr.constructor===p.curr.constructor?0:d.curr.constructor===Wt?1:-1:g}else return p.curr.id.client-d.curr.id.client}),i.length!==0;){const c=i[0],f=c.curr.id.client;if(s!==null){let d=c.curr,p=!1;for(;d!==null&&d.id.clock+d.length<=s.struct.id.clock+s.struct.length&&d.id.client>=s.struct.id.client;)d=c.next(),p=!0;if(d===null||d.id.client!==f||p&&d.id.clock>s.struct.id.clock+s.struct.length)continue;if(f!==s.struct.id.client)Kr(o,s.struct,s.offset),s={struct:d,offset:0},c.next();else if(s.struct.id.clock+s.struct.length<d.id.clock)if(s.struct.constructor===Wt)s.struct.length=d.id.clock+d.length-s.struct.id.clock;else{Kr(o,s.struct,s.offset);const g=d.id.clock-s.struct.id.clock-s.struct.length;s={struct:new Wt(Le(f,s.struct.id.clock+s.struct.length),g),offset:0}}else{const g=s.struct.id.clock+s.struct.length-d.id.clock;g>0&&(s.struct.constructor===Wt?s.struct.length-=g:d=ym(d,g)),s.struct.mergeWith(d)||(Kr(o,s.struct,s.offset),s={struct:d,offset:0},c.next())}}else s={struct:c.curr,offset:0},c.next();for(let d=c.curr;d!==null&&d.id.client===f&&d.id.clock===s.struct.id.clock+s.struct.length&&d.constructor!==Wt;d=c.next())Kr(o,s.struct,s.offset),s={struct:d,offset:0}}s!==null&&(Kr(o,s.struct,s.offset),s=null),bo(o);const l=n.map(c=>yo(c)),u=$y(l);return Jn(a,u),a.toUint8Array()},mm=(e,t,r=Kn,n=yn)=>{const i=ac(t),s=new n,a=new Co(s),o=new r(_r(e)),l=new vo(o,!1);for(;l.curr;){const c=l.curr,f=c.id.client,d=i.get(f)||0;if(l.curr.constructor===Wt){l.next();continue}if(c.id.clock+c.length>d)for(Kr(a,c,Cn(d-c.id.clock,0)),l.next();l.curr&&l.curr.id.client===f;)Kr(a,l.curr,0),l.next();else for(;l.curr&&l.curr.id.client===f&&l.curr.id.clock+l.curr.length<=d;)l.next()}bo(a);const u=yo(o);return Jn(s,u),s.toUint8Array()},dc=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:at(e.encoder.restEncoder)}),e.encoder.restEncoder=St(),e.written=0)},Kr=(e,t,r)=>{e.written>0&&e.currClient!==t.id.client&&dc(e),e.written===0&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),fe(e.encoder.restEncoder,t.id.clock+r)),t.write(e.encoder,r),e.written++},bo=e=>{dc(e);const t=e.encoder.restEncoder;fe(t,e.clientStructs.length);for(let r=0;r<e.clientStructs.length;r++){const n=e.clientStructs[r];fe(t,n.written),Os(t,n.restEncoder)}},vm=(e,t,r)=>{const n=new t(_r(e)),i=new vo(n,!1),s=new r,a=new Co(s);for(let l=i.curr;l!==null;l=i.next())Kr(a,l,0);bo(a);const o=yo(n);return Jn(s,o),s.toUint8Array()},Cm=e=>vm(e,Kn,Ni);class Vs{constructor(t,r){this.target=t,this.currentTarget=t,this.transaction=r,this._changes=null,this._keys=null,this._delta=null}get path(){return bm(this.currentTarget,this.target)}deletes(t){return Xu(this.transaction.deleteSet,t.id)}get keys(){if(this._keys===null){const t=new Map,r=this.target;this.transaction.changed.get(r).forEach(i=>{if(i!==null){const s=r._map.get(i);let a,o;if(this.adds(s)){let l=s.left;for(;l!==null&&this.adds(l);)l=l.left;if(this.deletes(s))if(l!==null&&this.deletes(l))a="delete",o=ea(l.content.getContent());else return;else l!==null&&this.deletes(l)?(a="update",o=ea(l.content.getContent())):(a="add",o=void 0)}else if(this.deletes(s))a="delete",o=ea(s.content.getContent());else return;t.set(i,{action:a,oldValue:o})}}),this._keys=t}return this._keys}get delta(){return this.changes.delta}adds(t){return t.id.clock>=(this.transaction.beforeState.get(t.id.client)||0)}get changes(){let t=this._changes;if(t===null){const r=this.target,n=vi(),i=vi(),s=[];if(t={added:n,deleted:i,delta:s,keys:this.keys},this.transaction.changed.get(r).has(null)){let o=null;const l=()=>{o&&s.push(o)};for(let u=r._start;u!==null;u=u.right)u.deleted?this.deletes(u)&&!this.adds(u)&&((o===null||o.delete===void 0)&&(l(),o={delete:0}),o.delete+=u.length,i.add(u)):this.adds(u)?((o===null||o.insert===void 0)&&(l(),o={insert:[]}),o.insert=o.insert.concat(u.content.getContent()),n.add(u)):((o===null||o.retain===void 0)&&(l(),o={retain:0}),o.retain+=u.length);o!==null&&o.retain===void 0&&l()}this._changes=t}return t}}const bm=(e,t)=>{const r=[];for(;t._item!==null&&t!==e;){if(t._item.parentSub!==null)r.unshift(t._item.parentSub);else{let n=0,i=t._item.parent._start;for(;i!==t._item&&i!==null;)i.deleted||n++,i=i.right;r.unshift(n)}t=t._item.parent}return r},pc=80;let Eo=0;class Em{constructor(t,r){t.marker=!0,this.p=t,this.index=r,this.timestamp=Eo++}}const Sm=e=>{e.timestamp=Eo++},gc=(e,t,r)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=r,e.timestamp=Eo++},_m=(e,t,r)=>{if(e.length>=pc){const n=e.reduce((i,s)=>i.timestamp<s.timestamp?i:s);return gc(n,t,r),n}else{const n=new Em(t,r);return e.push(n),n}},Ks=(e,t)=>{if(e._start===null||t===0||e._searchMarker===null)return null;const r=e._searchMarker.length===0?null:e._searchMarker.reduce((s,a)=>Qi(t-s.index)<Qi(t-a.index)?s:a);let n=e._start,i=0;for(r!==null&&(n=r.p,i=r.index,Sm(r));n.right!==null&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;n.left!==null&&i>t;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);for(;n.left!==null&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)n=n.left,!n.deleted&&n.countable&&(i-=n.length);return r!==null&&Qi(r.index-i)<n.parent.length/pc?(gc(r,n,i),r):_m(e._searchMarker,n,i)},Si=(e,t,r)=>{for(let n=e.length-1;n>=0;n--){const i=e[n];if(r>0){let s=i.p;for(s.marker=!1;s&&(s.deleted||!s.countable);)s=s.left,s&&!s.deleted&&s.countable&&(i.index-=s.length);if(s===null||s.marker===!0){e.splice(n,1);continue}i.p=s,s.marker=!0}(t<i.index||r>0&&t===i.index)&&(i.index=Cn(t,i.index+r))}},Hs=(e,t,r)=>{const n=e,i=t.changedParentTypes;for(;Zt(i,e,()=>[]).push(r),e._item!==null;)e=e._item.parent;lc(n._eH,r,t)};class Nt{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=Nl(),this._dEH=Nl(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(t,r){this.doc=t,this._item=r}_copy(){throw pr()}clone(){throw pr()}_write(t){}get _first(){let t=this._start;for(;t!==null&&t.deleted;)t=t.right;return t}_callObserver(t,r){!t.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(t){Ll(this._eH,t)}observeDeep(t){Ll(this._dEH,t)}unobserve(t){Dl(this._eH,t)}unobserveDeep(t){Dl(this._dEH,t)}toJSON(){}}const yc=(e,t,r)=>{t<0&&(t=e._length+t),r<0&&(r=e._length+r);let n=r-t;const i=[];let s=e._start;for(;s!==null&&n>0;){if(s.countable&&!s.deleted){const a=s.content.getContent();if(a.length<=t)t-=a.length;else{for(let o=t;o<a.length&&n>0;o++)i.push(a[o]),n--;t=0}}s=s.right}return i},mc=e=>{const t=[];let r=e._start;for(;r!==null;){if(r.countable&&!r.deleted){const n=r.content.getContent();for(let i=0;i<n.length;i++)t.push(n[i])}r=r.right}return t},_i=(e,t)=>{let r=0,n=e._start;for(;n!==null;){if(n.countable&&!n.deleted){const i=n.content.getContent();for(let s=0;s<i.length;s++)t(i[s],r++,e)}n=n.right}},vc=(e,t)=>{const r=[];return _i(e,(n,i)=>{r.push(t(n,i,e))}),r},wm=e=>{let t=e._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(r===null){for(;t!==null&&t.deleted;)t=t.right;if(t===null)return{done:!0,value:void 0};r=t.content.getContent(),n=0,t=t.right}const i=r[n++];return r.length<=n&&(r=null),{done:!1,value:i}}}},Cc=(e,t)=>{const r=Ks(e,t);let n=e._start;for(r!==null&&(n=r.p,t-=r.index);n!==null;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},hs=(e,t,r,n)=>{let i=r;const s=e.doc,a=s.clientID,o=s.store,l=r===null?t._start:r.right;let u=[];const c=()=>{u.length>0&&(i=new yt(Le(a,xt(o,a)),i,i&&i.lastId,l,l&&l.id,t,null,new vn(u)),i.integrate(e,0),u=[])};n.forEach(f=>{if(f===null)u.push(f);else switch(f.constructor){case Number:case Object:case Boolean:case Array:case String:u.push(f);break;default:switch(c(),f.constructor){case Uint8Array:case ArrayBuffer:i=new yt(Le(a,xt(o,a)),i,i&&i.lastId,l,l&&l.id,t,null,new Li(new Uint8Array(f))),i.integrate(e,0);break;case Yn:i=new yt(Le(a,xt(o,a)),i,i&&i.lastId,l,l&&l.id,t,null,new Di(f)),i.integrate(e,0);break;default:if(f instanceof Nt)i=new yt(Le(a,xt(o,a)),i,i&&i.lastId,l,l&&l.id,t,null,new Or(f)),i.integrate(e,0);else throw new Error("Unexpected content type in insert operation")}}}),c()},bc=tn("Length exceeded!"),Ec=(e,t,r,n)=>{if(r>t._length)throw bc;if(r===0)return t._searchMarker&&Si(t._searchMarker,r,n.length),hs(e,t,null,n);const i=r,s=Ks(t,r);let a=t._start;for(s!==null&&(a=s.p,r-=s.index,r===0&&(a=a.prev,r+=a&&a.countable&&!a.deleted?a.length:0));a!==null;a=a.right)if(!a.deleted&&a.countable){if(r<=a.length){r<a.length&&Xr(e,Le(a.id.client,a.id.clock+r));break}r-=a.length}return t._searchMarker&&Si(t._searchMarker,i,n.length),hs(e,t,a,n)},Tm=(e,t,r)=>{let i=(t._searchMarker||[]).reduce((s,a)=>a.index>s.index?a:s,{index:0,p:t._start}).p;if(i)for(;i.right;)i=i.right;return hs(e,t,i,r)},Sc=(e,t,r,n)=>{if(n===0)return;const i=r,s=n,a=Ks(t,r);let o=t._start;for(a!==null&&(o=a.p,r-=a.index);o!==null&&r>0;o=o.right)!o.deleted&&o.countable&&(r<o.length&&Xr(e,Le(o.id.client,o.id.clock+r)),r-=o.length);for(;n>0&&o!==null;)o.deleted||(n<o.length&&Xr(e,Le(o.id.client,o.id.clock+n)),o.delete(e),n-=o.length),o=o.right;if(n>0)throw bc;t._searchMarker&&Si(t._searchMarker,i,-s+n)},ds=(e,t,r)=>{const n=t._map.get(r);n!==void 0&&n.delete(e)},So=(e,t,r,n)=>{const i=t._map.get(r)||null,s=e.doc,a=s.clientID;let o;if(n==null)o=new vn([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:o=new vn([n]);break;case Uint8Array:o=new Li(n);break;case Yn:o=new Di(n);break;default:if(n instanceof Nt)o=new Or(n);else throw new Error("Unexpected content type")}new yt(Le(a,xt(s.store,a)),i,i&&i.lastId,null,null,t,r,o).integrate(e,0)},_o=(e,t)=>{const r=e._map.get(t);return r!==void 0&&!r.deleted?r.content.getContent()[r.length-1]:void 0},_c=e=>{const t={};return e._map.forEach((r,n)=>{r.deleted||(t[n]=r.content.getContent()[r.length-1])}),t},wc=(e,t)=>{const r=e._map.get(t);return r!==void 0&&!r.deleted},Vi=e=>Ky(e.entries(),t=>!t[1].deleted);class xm extends Vs{constructor(t,r){super(t,r),this._transaction=r}}class On extends Nt{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(t){const r=new On;return r.push(t),r}_integrate(t,r){super._integrate(t,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new On}clone(){const t=new On;return t.insert(0,this.toArray().map(r=>r instanceof Nt?r.clone():r)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}_callObserver(t,r){super._callObserver(t,r),Hs(this,t,new xm(this,t))}insert(t,r){this.doc!==null?qe(this.doc,n=>{Ec(n,this,t,r)}):this._prelimContent.splice(t,0,...r)}push(t){this.doc!==null?qe(this.doc,r=>{Tm(r,this,t)}):this._prelimContent.push(...t)}unshift(t){this.insert(0,t)}delete(t,r=1){this.doc!==null?qe(this.doc,n=>{Sc(n,this,t,r)}):this._prelimContent.splice(t,r)}get(t){return Cc(this,t)}toArray(){return mc(this)}slice(t=0,r=this.length){return yc(this,t,r)}toJSON(){return this.map(t=>t instanceof Nt?t.toJSON():t)}map(t){return vc(this,t)}forEach(t){_i(this,t)}[Symbol.iterator](){return wm(this)}_write(t){t.writeTypeRef(Qm)}}const Am=e=>new On;class Im extends Vs{constructor(t,r,n){super(t,r),this.keysChanged=n}}class Hn extends Nt{constructor(t){super(),this._prelimContent=null,t===void 0?this._prelimContent=new Map:this._prelimContent=new Map(t)}_integrate(t,r){super._integrate(t,r),this._prelimContent.forEach((n,i)=>{this.set(i,n)}),this._prelimContent=null}_copy(){return new Hn}clone(){const t=new Hn;return this.forEach((r,n)=>{t.set(n,r instanceof Nt?r.clone():r)}),t}_callObserver(t,r){Hs(this,t,new Im(this,t,r))}toJSON(){const t={};return this._map.forEach((r,n)=>{if(!r.deleted){const i=r.content.getContent()[r.length-1];t[n]=i instanceof Nt?i.toJSON():i}}),t}get size(){return[...Vi(this._map)].length}keys(){return aa(Vi(this._map),t=>t[0])}values(){return aa(Vi(this._map),t=>t[1].content.getContent()[t[1].length-1])}entries(){return aa(Vi(this._map),t=>[t[0],t[1].content.getContent()[t[1].length-1]])}forEach(t){this._map.forEach((r,n)=>{r.deleted||t(r.content.getContent()[r.length-1],n,this)})}[Symbol.iterator](){return this.entries()}delete(t){this.doc!==null?qe(this.doc,r=>{ds(r,this,t)}):this._prelimContent.delete(t)}set(t,r){return this.doc!==null?qe(this.doc,n=>{So(n,this,t,r)}):this._prelimContent.set(t,r),r}get(t){return _o(this,t)}has(t){return wc(this,t)}clear(){this.doc!==null?qe(this.doc,t=>{this.forEach(function(r,n,i){ds(t,i,n)})}):this._prelimContent.clear()}_write(t){t.writeTypeRef(Jm)}}const km=e=>new Hn,$r=(e,t)=>e===t||typeof e=="object"&&typeof t=="object"&&e&&t&&zg(e,t);class Aa{constructor(t,r,n,i){this.left=t,this.right=r,this.index=n,this.currentAttributes=i}forward(){switch(this.right===null&&mr(),this.right.content.constructor){case mt:this.right.deleted||Xn(this.currentAttributes,this.right.content);break;default:this.right.deleted||(this.index+=this.right.length);break}this.left=this.right,this.right=this.right.right}}const Pl=(e,t,r)=>{for(;t.right!==null&&r>0;){switch(t.right.content.constructor){case mt:t.right.deleted||Xn(t.currentAttributes,t.right.content);break;default:t.right.deleted||(r<t.right.length&&Xr(e,Le(t.right.id.client,t.right.id.clock+r)),t.index+=t.right.length,r-=t.right.length);break}t.left=t.right,t.right=t.right.right}return t},Ki=(e,t,r)=>{const n=new Map,i=Ks(t,r);if(i){const s=new Aa(i.p.left,i.p,i.index,n);return Pl(e,s,r-i.index)}else{const s=new Aa(null,t._start,0,n);return Pl(e,s,r)}},Tc=(e,t,r,n)=>{for(;r.right!==null&&(r.right.deleted===!0||r.right.content.constructor===mt&&$r(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();const i=e.doc,s=i.clientID;n.forEach((a,o)=>{const l=r.left,u=r.right,c=new yt(Le(s,xt(i.store,s)),l,l&&l.lastId,u,u&&u.id,t,null,new mt(o,a));c.integrate(e,0),r.right=c,r.forward()})},Xn=(e,t)=>{const{key:r,value:n}=t;n===null?e.delete(r):e.set(r,n)},xc=(e,t)=>{for(;e.right!==null;){if(!(e.right.deleted||e.right.content.constructor===mt&&$r(t[e.right.content.key]||null,e.right.content.value)))break;e.forward()}},Ac=(e,t,r,n)=>{const i=e.doc,s=i.clientID,a=new Map;for(const o in n){const l=n[o],u=r.currentAttributes.get(o)||null;if(!$r(u,l)){a.set(o,u);const{left:c,right:f}=r;r.right=new yt(Le(s,xt(i.store,s)),c,c&&c.lastId,f,f&&f.id,t,null,new mt(o,l)),r.right.integrate(e,0),r.forward()}}return a},la=(e,t,r,n,i)=>{r.currentAttributes.forEach((d,p)=>{i[p]===void 0&&(i[p]=null)});const s=e.doc,a=s.clientID;xc(r,i);const o=Ac(e,t,r,i),l=n.constructor===String?new Cr(n):n instanceof Nt?new Or(n):new En(n);let{left:u,right:c,index:f}=r;t._searchMarker&&Si(t._searchMarker,r.index,l.getLength()),c=new yt(Le(a,xt(s.store,a)),u,u&&u.lastId,c,c&&c.id,t,null,l),c.integrate(e,0),r.right=c,r.index=f,r.forward(),Tc(e,t,r,o)},Fl=(e,t,r,n,i)=>{const s=e.doc,a=s.clientID;xc(r,i);const o=Ac(e,t,r,i);e:for(;r.right!==null&&(n>0||o.size>0&&(r.right.deleted||r.right.content.constructor===mt));){if(!r.right.deleted)switch(r.right.content.constructor){case mt:{const{key:l,value:u}=r.right.content,c=i[l];if(c!==void 0){if($r(c,u))o.delete(l);else{if(n===0)break e;o.set(l,u)}r.right.delete(e)}else r.currentAttributes.set(l,u);break}default:n<r.right.length&&Xr(e,Le(r.right.id.client,r.right.id.clock+n)),n-=r.right.length;break}r.forward()}if(n>0){let l="";for(;n>0;n--)l+=`
`;r.right=new yt(Le(a,xt(s.store,a)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,t,null,new Cr(l)),r.right.integrate(e,0),r.forward()}Tc(e,t,r,o)},Ic=(e,t,r,n,i)=>{let s=r;const a=os(i);for(;s&&(!s.countable||s.deleted);)!s.deleted&&s.content.constructor===mt&&Xn(a,s.content),s=s.right;let o=0,l=!1;for(;t!==s;){if(r===t&&(l=!0),!t.deleted){const u=t.content;switch(u.constructor){case mt:{const{key:c,value:f}=u;((a.get(c)||null)!==f||(n.get(c)||null)===f)&&(t.delete(e),o++,!l&&(i.get(c)||null)===f&&(n.get(c)||null)!==f&&i.delete(c));break}}}t=t.right}return o},Bm=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;const r=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===mt){const n=t.content.key;r.has(n)?t.delete(e):r.add(n)}t=t.left}},Rm=e=>{let t=0;return qe(e.doc,r=>{let n=e._start,i=e._start,s=dr();const a=os(s);for(;i;){if(i.deleted===!1)switch(i.content.constructor){case mt:Xn(a,i.content);break;default:t+=Ic(r,n,i,s,a),s=os(a),n=i;break}i=i.right}}),t},Vl=(e,t,r)=>{const n=r,i=os(t.currentAttributes),s=t.right;for(;r>0&&t.right!==null;){if(t.right.deleted===!1)switch(t.right.content.constructor){case Or:case En:case Cr:r<t.right.length&&Xr(e,Le(t.right.id.client,t.right.id.clock+r)),r-=t.right.length,t.right.delete(e);break}t.forward()}s&&Ic(e,s,t.right,i,t.currentAttributes);const a=(t.left||t.right).parent;return a._searchMarker&&Si(a._searchMarker,t.index,-n+r),t};class Nm extends Vs{constructor(t,r,n){super(t,r),this.childListChanged=!1,this.keysChanged=new Set,n.forEach(i=>{i===null?this.childListChanged=!0:this.keysChanged.add(i)})}get changes(){if(this._changes===null){const t={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=t}return this._changes}get delta(){if(this._delta===null){const t=this.target.doc,r=[];qe(t,n=>{const i=new Map,s=new Map;let a=this.target._start,o=null;const l={};let u="",c=0,f=0;const d=()=>{if(o!==null){let p;switch(o){case"delete":p={delete:f},f=0;break;case"insert":p={insert:u},i.size>0&&(p.attributes={},i.forEach((g,m)=>{g!==null&&(p.attributes[m]=g)})),u="";break;case"retain":if(p={retain:c},Object.keys(l).length>0){p.attributes={};for(const g in l)p.attributes[g]=l[g]}c=0;break}r.push(p),o=null}};for(;a!==null;){switch(a.content.constructor){case Or:case En:this.adds(a)?this.deletes(a)||(d(),o="insert",u=a.content.getContent()[0],d()):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),f+=1):a.deleted||(o!=="retain"&&(d(),o="retain"),c+=1);break;case Cr:this.adds(a)?this.deletes(a)||(o!=="insert"&&(d(),o="insert"),u+=a.content.str):this.deletes(a)?(o!=="delete"&&(d(),o="delete"),f+=a.length):a.deleted||(o!=="retain"&&(d(),o="retain"),c+=a.length);break;case mt:{const{key:p,value:g}=a.content;if(this.adds(a)){if(!this.deletes(a)){const m=i.get(p)||null;$r(m,g)?g!==null&&a.delete(n):(o==="retain"&&d(),$r(g,s.get(p)||null)?delete l[p]:l[p]=g)}}else if(this.deletes(a)){s.set(p,g);const m=i.get(p)||null;$r(m,g)||(o==="retain"&&d(),l[p]=m)}else if(!a.deleted){s.set(p,g);const m=l[p];m!==void 0&&($r(m,g)?m!==null&&a.delete(n):(o==="retain"&&d(),g===null?delete l[p]:l[p]=g))}a.deleted||(o==="insert"&&d(),Xn(i,a.content));break}}a=a.right}for(d();r.length>0;){const p=r[r.length-1];if(p.retain!==void 0&&p.attributes===void 0)r.pop();else break}}),this._delta=r}return this._delta}}class $n extends Nt{constructor(t){super(),this._pending=t!==void 0?[()=>this.insert(0,t)]:[],this._searchMarker=[]}get length(){return this._length}_integrate(t,r){super._integrate(t,r);try{this._pending.forEach(n=>n())}catch(n){console.error(n)}this._pending=null}_copy(){return new $n}clone(){const t=new $n;return t.applyDelta(this.toDelta()),t}_callObserver(t,r){super._callObserver(t,r);const n=new Nm(this,t,r),i=t.doc;if(Hs(this,t,n),!t.local){let s=!1;for(const[a,o]of t.afterState.entries()){const l=t.beforeState.get(a)||0;if(o!==l&&(fc(t,i.store.clients.get(a),l,o,u=>{!u.deleted&&u.content.constructor===mt&&(s=!0)}),s))break}s||wa(t,t.deleteSet,a=>{a instanceof zt||s||a.parent===this&&a.content.constructor===mt&&(s=!0)}),qe(i,a=>{s?Rm(this):wa(a,a.deleteSet,o=>{o instanceof zt||o.parent===this&&Bm(a,o)})})}}toString(){let t="",r=this._start;for(;r!==null;)!r.deleted&&r.countable&&r.content.constructor===Cr&&(t+=r.content.str),r=r.right;return t}toJSON(){return this.toString()}applyDelta(t,{sanitize:r=!0}={}){this.doc!==null?qe(this.doc,n=>{const i=new Aa(null,this._start,0,new Map);for(let s=0;s<t.length;s++){const a=t[s];if(a.insert!==void 0){const o=!r&&typeof a.insert=="string"&&s===t.length-1&&i.right===null&&a.insert.slice(-1)===`
`?a.insert.slice(0,-1):a.insert;(typeof o!="string"||o.length>0)&&la(n,this,i,o,a.attributes||{})}else a.retain!==void 0?Fl(n,this,i,a.retain,a.attributes||{}):a.delete!==void 0&&Vl(n,i,a.delete)}}):this._pending.push(()=>this.applyDelta(t))}toDelta(t,r,n){const i=[],s=new Map,a=this.doc;let o="",l=this._start;function u(){if(o.length>0){const c={};let f=!1;s.forEach((p,g)=>{f=!0,c[g]=p});const d={insert:o};f&&(d.attributes=c),i.push(d),o=""}}return qe(a,c=>{for(t&&Ta(c,t),r&&Ta(c,r);l!==null;){if(si(l,t)||r!==void 0&&si(l,r))switch(l.content.constructor){case Cr:{const f=s.get("ychange");t!==void 0&&!si(l,t)?(f===void 0||f.user!==l.id.client||f.type!=="removed")&&(u(),s.set("ychange",n?n("removed",l.id):{type:"removed"})):r!==void 0&&!si(l,r)?(f===void 0||f.user!==l.id.client||f.type!=="added")&&(u(),s.set("ychange",n?n("added",l.id):{type:"added"})):f!==void 0&&(u(),s.delete("ychange")),o+=l.content.str;break}case Or:case En:{u();const f={insert:l.content.getContent()[0]};if(s.size>0){const d={};f.attributes=d,s.forEach((p,g)=>{d[g]=p})}i.push(f);break}case mt:si(l,t)&&(u(),Xn(s,l.content));break}l=l.right}u()},"cleanup"),i}insert(t,r,n){if(r.length<=0)return;const i=this.doc;i!==null?qe(i,s=>{const a=Ki(s,this,t);n||(n={},a.currentAttributes.forEach((o,l)=>{n[l]=o})),la(s,this,a,r,n)}):this._pending.push(()=>this.insert(t,r,n))}insertEmbed(t,r,n={}){const i=this.doc;i!==null?qe(i,s=>{const a=Ki(s,this,t);la(s,this,a,r,n)}):this._pending.push(()=>this.insertEmbed(t,r,n))}delete(t,r){if(r===0)return;const n=this.doc;n!==null?qe(n,i=>{Vl(i,Ki(i,this,t),r)}):this._pending.push(()=>this.delete(t,r))}format(t,r,n){if(r===0)return;const i=this.doc;i!==null?qe(i,s=>{const a=Ki(s,this,t);a.right!==null&&Fl(s,this,a,r,n)}):this._pending.push(()=>this.format(t,r,n))}removeAttribute(t){this.doc!==null?qe(this.doc,r=>{ds(r,this,t)}):this._pending.push(()=>this.removeAttribute(t))}setAttribute(t,r){this.doc!==null?qe(this.doc,n=>{So(n,this,t,r)}):this._pending.push(()=>this.setAttribute(t,r))}getAttribute(t){return _o(this,t)}getAttributes(t){return _c(this)}_write(t){t.writeTypeRef(Ym)}}const Lm=e=>new $n;class ua{constructor(t,r=()=>!0){this._filter=r,this._root=t,this._currentNode=t._start,this._firstCall=!0}[Symbol.iterator](){return this}next(){let t=this._currentNode,r=t&&t.content&&t.content.type;if(t!==null&&(!this._firstCall||t.deleted||!this._filter(r)))do if(r=t.content.type,!t.deleted&&(r.constructor===wi||r.constructor===mn)&&r._start!==null)t=r._start;else for(;t!==null;)if(t.right!==null){t=t.right;break}else t.parent===this._root?t=null:t=t.parent._item;while(t!==null&&(t.deleted||!this._filter(t.content.type)));return this._firstCall=!1,t===null?{value:void 0,done:!0}:(this._currentNode=t,{value:t.content.type,done:!1})}}class mn extends Nt{constructor(){super(),this._prelimContent=[]}get firstChild(){const t=this._first;return t?t.content.getContent()[0]:null}_integrate(t,r){super._integrate(t,r),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new mn}clone(){const t=new mn;return t.insert(0,this.toArray().map(r=>r instanceof Nt?r.clone():r)),t}get length(){return this._prelimContent===null?this._length:this._prelimContent.length}createTreeWalker(t){return new ua(this,t)}querySelector(t){t=t.toUpperCase();const n=new ua(this,i=>i.nodeName&&i.nodeName.toUpperCase()===t).next();return n.done?null:n.value}querySelectorAll(t){return t=t.toUpperCase(),Array.from(new ua(this,r=>r.nodeName&&r.nodeName.toUpperCase()===t))}_callObserver(t,r){Hs(this,t,new Om(this,r,t))}toString(){return vc(this,t=>t.toString()).join("")}toJSON(){return this.toString()}toDOM(t=document,r={},n){const i=t.createDocumentFragment();return n!==void 0&&n._createAssociation(i,this),_i(this,s=>{i.insertBefore(s.toDOM(t,r,n),null)}),i}insert(t,r){this.doc!==null?qe(this.doc,n=>{Ec(n,this,t,r)}):this._prelimContent.splice(t,0,...r)}insertAfter(t,r){if(this.doc!==null)qe(this.doc,n=>{const i=t&&t instanceof Nt?t._item:t;hs(n,this,i,r)});else{const n=this._prelimContent,i=t===null?0:n.findIndex(s=>s===t)+1;if(i===0&&t!==null)throw tn("Reference item not found");n.splice(i,0,...r)}}delete(t,r=1){this.doc!==null?qe(this.doc,n=>{Sc(n,this,t,r)}):this._prelimContent.splice(t,r)}toArray(){return mc(this)}push(t){this.insert(this.length,t)}unshift(t){this.insert(0,t)}get(t){return Cc(this,t)}slice(t=0,r=this.length){return yc(this,t,r)}forEach(t){_i(this,t)}_write(t){t.writeTypeRef(Zm)}}const Dm=e=>new mn;class wi extends mn{constructor(t="UNDEFINED"){super(),this.nodeName=t,this._prelimAttrs=new Map}get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_integrate(t,r){super._integrate(t,r),this._prelimAttrs.forEach((n,i)=>{this.setAttribute(i,n)}),this._prelimAttrs=null}_copy(){return new wi(this.nodeName)}clone(){const t=new wi(this.nodeName),r=this.getAttributes();for(const n in r)t.setAttribute(n,r[n]);return t.insert(0,this.toArray().map(n=>n instanceof Nt?n.clone():n)),t}toString(){const t=this.getAttributes(),r=[],n=[];for(const o in t)n.push(o);n.sort();const i=n.length;for(let o=0;o<i;o++){const l=n[o];r.push(l+'="'+t[l]+'"')}const s=this.nodeName.toLocaleLowerCase(),a=r.length>0?" "+r.join(" "):"";return`<${s}${a}>${super.toString()}</${s}>`}removeAttribute(t){this.doc!==null?qe(this.doc,r=>{ds(r,this,t)}):this._prelimAttrs.delete(t)}setAttribute(t,r){this.doc!==null?qe(this.doc,n=>{So(n,this,t,r)}):this._prelimAttrs.set(t,r)}getAttribute(t){return _o(this,t)}hasAttribute(t){return wc(this,t)}getAttributes(){return _c(this)}toDOM(t=document,r={},n){const i=t.createElement(this.nodeName),s=this.getAttributes();for(const a in s)i.setAttribute(a,s[a]);return _i(this,a=>{i.appendChild(a.toDOM(t,r,n))}),n!==void 0&&n._createAssociation(i,this),i}_write(t){t.writeTypeRef(Xm),t.writeKey(this.nodeName)}}const Um=e=>new wi(e.readKey());class Om extends Vs{constructor(t,r,n){super(t,n),this.childListChanged=!1,this.attributesChanged=new Set,r.forEach(i=>{i===null?this.childListChanged=!0:this.attributesChanged.add(i)})}}class ps extends Hn{constructor(t){super(),this.hookName=t}_copy(){return new ps(this.hookName)}clone(){const t=new ps(this.hookName);return this.forEach((r,n)=>{t.set(n,r)}),t}toDOM(t=document,r={},n){const i=r[this.hookName];let s;return i!==void 0?s=i.createDom(this):s=document.createElement(this.hookName),s.setAttribute("data-yjs-hook",this.hookName),n!==void 0&&n._createAssociation(s,this),s}_write(t){t.writeTypeRef(ev),t.writeKey(this.hookName)}}const Mm=e=>new ps(e.readKey());class gs extends $n{get nextSibling(){const t=this._item?this._item.next:null;return t?t.content.type:null}get prevSibling(){const t=this._item?this._item.prev:null;return t?t.content.type:null}_copy(){return new gs}clone(){const t=new gs;return t.applyDelta(this.toDelta()),t}toDOM(t=document,r,n){const i=t.createTextNode(this.toString());return n!==void 0&&n._createAssociation(i,this),i}toString(){return this.toDelta().map(t=>{const r=[];for(const i in t.attributes){const s=[];for(const a in t.attributes[i])s.push({key:a,value:t.attributes[i][a]});s.sort((a,o)=>a.key<o.key?-1:1),r.push({nodeName:i,attrs:s})}r.sort((i,s)=>i.nodeName<s.nodeName?-1:1);let n="";for(let i=0;i<r.length;i++){const s=r[i];n+=`<${s.nodeName}`;for(let a=0;a<s.attrs.length;a++){const o=s.attrs[a];n+=` ${o.key}="${o.value}"`}n+=">"}n+=t.insert;for(let i=r.length-1;i>=0;i--)n+=`</${r[i].nodeName}>`;return n}).join("")}toJSON(){return this.toString()}_write(t){t.writeTypeRef(tv)}}const Pm=e=>new gs;class wo{constructor(t,r){this.id=t,this.length=r}get deleted(){throw pr()}mergeWith(t){return!1}write(t,r,n){throw pr()}integrate(t,r){throw pr()}}const Fm=0;class zt extends wo{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,r){r>0&&(this.id.clock+=r,this.length-=r),cc(t.doc.store,this)}write(t,r){t.writeInfo(Fm),t.writeLen(this.length-r)}getMissing(t,r){return null}}class Li{constructor(t){this.content=t}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new Li(this.content)}splice(t){throw pr()}mergeWith(t){return!1}integrate(t,r){}delete(t){}gc(t){}write(t,r){t.writeBuf(this.content)}getRef(){return 3}}const Vm=e=>new Li(e.readBuf());class Ti{constructor(t){this.len=t}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new Ti(this.len)}splice(t){const r=new Ti(this.len-t);return this.len=t,r}mergeWith(t){return this.len+=t.len,!0}integrate(t,r){cs(t.deleteSet,r.id.client,r.id.clock,this.len),r.markDeleted()}delete(t){}gc(t){}write(t,r){t.writeLen(this.len-r)}getRef(){return 1}}const Km=e=>new Ti(e.readLen()),kc=(e,t)=>new Yn({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class Di{constructor(t){t._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=t;const r={};this.opts=r,t.gc||(r.gc=!1),t.autoLoad&&(r.autoLoad=!0),t.meta!==null&&(r.meta=t.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new Di(kc(this.doc.guid,this.opts))}splice(t){throw pr()}mergeWith(t){return!1}integrate(t,r){this.doc._item=r,t.subdocsAdded.add(this.doc),this.doc.shouldLoad&&t.subdocsLoaded.add(this.doc)}delete(t){t.subdocsAdded.has(this.doc)?t.subdocsAdded.delete(this.doc):t.subdocsRemoved.add(this.doc)}gc(t){}write(t,r){t.writeString(this.doc.guid),t.writeAny(this.opts)}getRef(){return 9}}const Hm=e=>new Di(kc(e.readString(),e.readAny()));class En{constructor(t){this.embed=t}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new En(this.embed)}splice(t){throw pr()}mergeWith(t){return!1}integrate(t,r){}delete(t){}gc(t){}write(t,r){t.writeJSON(this.embed)}getRef(){return 5}}const $m=e=>new En(e.readJSON());class mt{constructor(t,r){this.key=t,this.value=r}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new mt(this.key,this.value)}splice(t){throw pr()}mergeWith(t){return!1}integrate(t,r){r.parent._searchMarker=null}delete(t){}gc(t){}write(t,r){t.writeKey(this.key),t.writeJSON(this.value)}getRef(){return 6}}const Gm=e=>new mt(e.readKey(),e.readJSON());class ys{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new ys(this.arr)}splice(t){const r=new ys(this.arr.slice(t));return this.arr=this.arr.slice(0,t),r}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,r){}delete(t){}gc(t){}write(t,r){const n=this.arr.length;t.writeLen(n-r);for(let i=r;i<n;i++){const s=this.arr[i];t.writeString(s===void 0?"undefined":JSON.stringify(s))}}getRef(){return 2}}const qm=e=>{const t=e.readLen(),r=[];for(let n=0;n<t;n++){const i=e.readString();i==="undefined"?r.push(void 0):r.push(JSON.parse(i))}return new ys(r)};class vn{constructor(t){this.arr=t}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new vn(this.arr)}splice(t){const r=new vn(this.arr.slice(t));return this.arr=this.arr.slice(0,t),r}mergeWith(t){return this.arr=this.arr.concat(t.arr),!0}integrate(t,r){}delete(t){}gc(t){}write(t,r){const n=this.arr.length;t.writeLen(n-r);for(let i=r;i<n;i++){const s=this.arr[i];t.writeAny(s)}}getRef(){return 8}}const jm=e=>{const t=e.readLen(),r=[];for(let n=0;n<t;n++)r.push(e.readAny());return new vn(r)};class Cr{constructor(t){this.str=t}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new Cr(this.str)}splice(t){const r=new Cr(this.str.slice(t));this.str=this.str.slice(0,t);const n=this.str.charCodeAt(t-1);return n>=55296&&n<=56319&&(this.str=this.str.slice(0,t-1)+"\uFFFD",r.str="\uFFFD"+r.str.slice(1)),r}mergeWith(t){return this.str+=t.str,!0}integrate(t,r){}delete(t){}gc(t){}write(t,r){t.writeString(r===0?this.str:this.str.slice(r))}getRef(){return 4}}const zm=e=>new Cr(e.readString()),Wm=[Am,km,Lm,Um,Dm,Mm,Pm],Qm=0,Jm=1,Ym=2,Xm=3,Zm=4,ev=5,tv=6;class Or{constructor(t){this.type=t}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new Or(this.type._copy())}splice(t){throw pr()}mergeWith(t){return!1}integrate(t,r){this.type._integrate(t.doc,r)}delete(t){let r=this.type._start;for(;r!==null;)r.deleted?t._mergeStructs.push(r):r.delete(t),r=r.right;this.type._map.forEach(n=>{n.deleted?t._mergeStructs.push(n):n.delete(t)}),t.changed.delete(this.type)}gc(t){let r=this.type._start;for(;r!==null;)r.gc(t,!0),r=r.right;this.type._start=null,this.type._map.forEach(n=>{for(;n!==null;)n.gc(t,!0),n=n.left}),this.type._map=new Map}write(t,r){this.type._write(t)}getRef(){return 7}}const rv=e=>new Or(Wm[e.readTypeRef()](e));const ms=(e,t,r)=>{const{client:n,clock:i}=t.id,s=new yt(Le(n,i+r),t,Le(n,i+r-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(r));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),t.redone!==null&&(s.redone=Le(t.redone.client,t.redone.clock+r)),t.right=s,s.right!==null&&(s.right.left=s),e._mergeStructs.push(s),s.parentSub!==null&&s.right===null&&s.parent._map.set(s.parentSub,s),t.length=r,s};class yt extends wo{constructor(t,r,n,i,s,a,o,l){super(t,l.getLength()),this.origin=n,this.left=r,this.right=i,this.rightOrigin=s,this.parent=a,this.parentSub=o,this.redone=null,this.content=l,this.info=this.content.isCountable()?Sl:0}set marker(t){(this.info&ra)>0!==t&&(this.info^=ra)}get marker(){return(this.info&ra)>0}get keep(){return(this.info&El)>0}set keep(t){this.keep!==t&&(this.info^=El)}get countable(){return(this.info&Sl)>0}get deleted(){return(this.info&ta)>0}set deleted(t){this.deleted!==t&&(this.info^=ta)}markDeleted(){this.info|=ta}getMissing(t,r){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=xt(r,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=xt(r,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===Un&&this.id.client!==this.parent.client&&this.parent.clock>=xt(r,this.parent.client))return this.parent.client;if(this.origin&&(this.left=Ul(t,r,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=Xr(t,this.rightOrigin),this.rightOrigin=this.right.id),(this.left&&this.left.constructor===zt||this.right&&this.right.constructor===zt)&&(this.parent=null),!this.parent)this.left&&this.left.constructor===yt&&(this.parent=this.left.parent,this.parentSub=this.left.parentSub),this.right&&this.right.constructor===yt&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);else if(this.parent.constructor===Un){const n=oa(r,this.parent);n.constructor===zt?this.parent=null:this.parent=n.content.type}return null}integrate(t,r){if(r>0&&(this.id.clock+=r,this.left=Ul(t,t.doc.store,Le(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(r),this.length-=r),this.parent){if(!this.left&&(!this.right||this.right.left!==null)||this.left&&this.left.right!==this.right){let n=this.left,i;if(n!==null)i=n.right;else if(this.parentSub!==null)for(i=this.parent._map.get(this.parentSub)||null;i!==null&&i.left!==null;)i=i.left;else i=this.parent._start;const s=new Set,a=new Set;for(;i!==null&&i!==this.right;){if(a.add(i),s.add(i),Fi(this.origin,i.origin)){if(i.id.client<this.id.client)n=i,s.clear();else if(Fi(this.rightOrigin,i.rightOrigin))break}else if(i.origin!==null&&a.has(oa(t.doc.store,i.origin)))s.has(oa(t.doc.store,i.origin))||(n=i,s.clear());else break;i=i.right}this.left=n}if(this.left!==null){const n=this.left.right;this.right=n,this.left.right=this}else{let n;if(this.parentSub!==null)for(n=this.parent._map.get(this.parentSub)||null;n!==null&&n.left!==null;)n=n.left;else n=this.parent._start,this.parent._start=this;this.right=n}this.right!==null?this.right.left=this:this.parentSub!==null&&(this.parent._map.set(this.parentSub,this),this.left!==null&&this.left.delete(t)),this.parentSub===null&&this.countable&&!this.deleted&&(this.parent._length+=this.length),cc(t.doc.store,this),this.content.integrate(t,this),Ml(t,this.parent,this.parentSub),(this.parent._item!==null&&this.parent._item.deleted||this.parentSub!==null&&this.right!==null)&&this.delete(t)}else new zt(this.id,this.length).integrate(t,0)}get next(){let t=this.right;for(;t!==null&&t.deleted;)t=t.right;return t}get prev(){let t=this.left;for(;t!==null&&t.deleted;)t=t.left;return t}get lastId(){return this.length===1?this.id:Le(this.id.client,this.id.clock+this.length-1)}mergeWith(t){if(this.constructor===t.constructor&&Fi(t.origin,this.lastId)&&this.right===t&&Fi(this.rightOrigin,t.rightOrigin)&&this.id.client===t.id.client&&this.id.clock+this.length===t.id.clock&&this.deleted===t.deleted&&this.redone===null&&t.redone===null&&this.content.constructor===t.content.constructor&&this.content.mergeWith(t.content)){const r=this.parent._searchMarker;return r&&r.forEach(n=>{n.p===t&&(n.p=this,!this.deleted&&this.countable&&(n.index-=this.length))}),t.keep&&(this.keep=!0),this.right=t.right,this.right!==null&&(this.right.left=this),this.length+=t.length,!0}return!1}delete(t){if(!this.deleted){const r=this.parent;this.countable&&this.parentSub===null&&(r._length-=this.length),this.markDeleted(),cs(t.deleteSet,this.id.client,this.id.clock,this.length),Ml(t,r,this.parentSub),this.content.delete(t)}}gc(t,r){if(!this.deleted)throw mr();this.content.gc(t),r?cm(t,this,new zt(this.id,this.length)):this.content=new Ti(this.length)}write(t,r){const n=r>0?Le(this.id.client,this.id.clock+r-1):this.origin,i=this.rightOrigin,s=this.parentSub,a=this.content.getRef()&Ds|(n===null?0:Gt)|(i===null?0:kr)|(s===null?0:bi);if(t.writeInfo(a),n!==null&&t.writeLeftID(n),i!==null&&t.writeRightID(i),n===null&&i===null){const o=this.parent;if(o._item!==void 0){const l=o._item;if(l===null){const u=am(o);t.writeParentInfo(!0),t.writeString(u)}else t.writeParentInfo(!1),t.writeLeftID(l.id)}else o.constructor===String?(t.writeParentInfo(!0),t.writeString(o)):o.constructor===Un?(t.writeParentInfo(!1),t.writeLeftID(o)):mr();s!==null&&t.writeString(s)}this.content.write(t,r)}}const Bc=(e,t)=>nv[t&Ds](e),nv=[()=>{mr()},Km,qm,Vm,zm,$m,Gm,rv,jm,Hm,()=>{mr()}],iv=10;class Wt extends wo{get deleted(){return!0}delete(){}mergeWith(t){return this.constructor!==t.constructor?!1:(this.length+=t.length,!0)}integrate(t,r){mr()}write(t,r){t.writeInfo(iv),fe(t.restEncoder,this.length-r)}getMissing(t,r){return null}}const Rc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:{},Nc="__ $YJS$ __";Rc[Nc]===!0&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");Rc[Nc]=!0;const sv=1200,av=2500,vs=3e4,Ia=e=>{if(e.shouldConnect&&e.ws===null){const t=new WebSocket(e.url),r=e.binaryType;let n=null;r&&(t.binaryType=r),e.ws=t,e.connecting=!0,e.connected=!1,t.onmessage=a=>{e.lastMessageReceived=Nr();const o=a.data,l=typeof o=="string"?JSON.parse(o):o;l&&l.type==="pong"&&(clearTimeout(n),n=setTimeout(s,vs/2)),e.emit("message",[l,e])};const i=a=>{e.ws!==null&&(e.ws=null,e.connecting=!1,e.connected?(e.connected=!1,e.emit("disconnect",[{type:"disconnect",error:a},e])):e.unsuccessfulReconnects++,setTimeout(Ia,to(Ug(e.unsuccessfulReconnects+1)*sv,av),e)),clearTimeout(n)},s=()=>{e.ws===t&&e.send({type:"ping"})};t.onclose=()=>i(null),t.onerror=a=>i(a),t.onopen=()=>{e.lastMessageReceived=Nr(),e.connecting=!1,e.connected=!0,e.unsuccessfulReconnects=0,e.emit("connect",[{type:"connect"},e]),n=setTimeout(s,vs/2)}}};class ov extends Ls{constructor(t,{binaryType:r}={}){super(),this.url=t,this.ws=null,this.binaryType=r||null,this.connected=!1,this.connecting=!1,this.unsuccessfulReconnects=0,this.lastMessageReceived=0,this.shouldConnect=!0,this._checkInterval=setInterval(()=>{this.connected&&vs<Nr()-this.lastMessageReceived&&this.ws.close()},vs/2),Ia(this)}send(t){this.ws&&this.ws.send(JSON.stringify(t))}destroy(){clearInterval(this._checkInterval),this.disconnect(),super.destroy()}disconnect(){this.shouldConnect=!1,this.ws!==null&&this.ws.close()}connect(){this.shouldConnect=!0,!this.connected&&this.ws===null&&Ia(this)}}const lv=new Map;class uv{constructor(t){this.room=t,this.onmessage=null,Gg(r=>r.key===t&&this.onmessage!==null&&this.onmessage({data:ju(r.newValue||"")}))}postMessage(t){Pu.setItem(this.room,qu(fy(t)))}}const cv=typeof BroadcastChannel>"u"?uv:BroadcastChannel,To=e=>Zt(lv,e,()=>{const t=new Set,r=new cv(e);return r.onmessage=n=>t.forEach(i=>i(n.data,"broadcastchannel")),{bc:r,subs:t}}),fv=(e,t)=>To(e).subs.add(t),hv=(e,t)=>To(e).subs.delete(t),dv=(e,t,r=null)=>{const n=To(e);n.bc.postMessage(t),n.subs.forEach(i=>i(t,r))},pv=()=>{let e=!0;return(t,r)=>{if(e){e=!1;try{t()}finally{e=!0}}else r!==void 0&&r()}};var er=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yv(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}function Hi(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Lc={exports:{}};(function(e,t){(function(r){e.exports=r()})(function(){var r=Math.floor,n=Math.abs,i=Math.pow;return function(){function s(a,o,l){function u(d,p){if(!o[d]){if(!a[d]){var g=typeof Hi=="function"&&Hi;if(!p&&g)return g(d,!0);if(c)return c(d,!0);var m=new Error("Cannot find module '"+d+"'");throw m.code="MODULE_NOT_FOUND",m}var T=o[d]={exports:{}};a[d][0].call(T.exports,function(x){var B=a[d][1][x];return u(B||x)},T,T.exports,s,a,o,l)}return o[d].exports}for(var c=typeof Hi=="function"&&Hi,f=0;f<l.length;f++)u(l[f]);return u}return s}()({1:[function(s,a,o){function l(_){var w=_.length;if(0<w%4)throw new Error("Invalid string. Length must be a multiple of 4");var I=_.indexOf("=");I===-1&&(I=w);var k=I===w?0:4-I%4;return[I,k]}function u(_,w,I){return 3*(w+I)/4-I}function c(_){var w,I,k=l(_),M=k[0],K=k[1],N=new T(u(_,M,K)),U=0,H=0<K?M-4:M;for(I=0;I<H;I+=4)w=m[_.charCodeAt(I)]<<18|m[_.charCodeAt(I+1)]<<12|m[_.charCodeAt(I+2)]<<6|m[_.charCodeAt(I+3)],N[U++]=255&w>>16,N[U++]=255&w>>8,N[U++]=255&w;return K===2&&(w=m[_.charCodeAt(I)]<<2|m[_.charCodeAt(I+1)]>>4,N[U++]=255&w),K===1&&(w=m[_.charCodeAt(I)]<<10|m[_.charCodeAt(I+1)]<<4|m[_.charCodeAt(I+2)]>>2,N[U++]=255&w>>8,N[U++]=255&w),N}function f(_){return g[63&_>>18]+g[63&_>>12]+g[63&_>>6]+g[63&_]}function d(_,w,I){for(var k,M=[],K=w;K<I;K+=3)k=(16711680&_[K]<<16)+(65280&_[K+1]<<8)+(255&_[K+2]),M.push(f(k));return M.join("")}function p(_){for(var w,I=_.length,k=I%3,M=[],K=16383,N=0,U=I-k;N<U;N+=K)M.push(d(_,N,N+K>U?U:N+K));return k===1?(w=_[I-1],M.push(g[w>>2]+g[63&w<<4]+"==")):k===2&&(w=(_[I-2]<<8)+_[I-1],M.push(g[w>>10]+g[63&w>>4]+g[63&w<<2]+"=")),M.join("")}o.byteLength=function(_){var w=l(_),I=w[0],k=w[1];return 3*(I+k)/4-k},o.toByteArray=c,o.fromByteArray=p;for(var g=[],m=[],T=typeof Uint8Array>"u"?Array:Uint8Array,x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B=0,v=x.length;B<v;++B)g[B]=x[B],m[x.charCodeAt(B)]=B;m[45]=62,m[95]=63},{}],2:[function(){},{}],3:[function(s,a,o){(function(){(function(){var l=String.fromCharCode,u=Math.min;function c(h){if(2147483647<h)throw new RangeError('The value "'+h+'" is invalid for option "size"');var y=new Uint8Array(h);return y.__proto__=f.prototype,y}function f(h,y,C){if(typeof h=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(h)}return d(h,y,C)}function d(h,y,C){if(typeof h=="string")return T(h,y);if(ArrayBuffer.isView(h))return x(h);if(h==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);if(P(h,ArrayBuffer)||h&&P(h.buffer,ArrayBuffer))return B(h,y,C);if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var D=h.valueOf&&h.valueOf();if(D!=null&&D!==h)return f.from(D,y,C);var F=v(h);if(F)return F;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof h[Symbol.toPrimitive]=="function")return f.from(h[Symbol.toPrimitive]("string"),y,C);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h)}function p(h){if(typeof h!="number")throw new TypeError('"size" argument must be of type number');if(0>h)throw new RangeError('The value "'+h+'" is invalid for option "size"')}function g(h,y,C){return p(h),0>=h||y===void 0?c(h):typeof C=="string"?c(h).fill(y,C):c(h).fill(y)}function m(h){return p(h),c(0>h?0:0|_(h))}function T(h,y){if((typeof y!="string"||y==="")&&(y="utf8"),!f.isEncoding(y))throw new TypeError("Unknown encoding: "+y);var C=0|w(h,y),D=c(C),F=D.write(h,y);return F!==C&&(D=D.slice(0,F)),D}function x(h){for(var y=0>h.length?0:0|_(h.length),C=c(y),D=0;D<y;D+=1)C[D]=255&h[D];return C}function B(h,y,C){if(0>y||h.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(h.byteLength<y+(C||0))throw new RangeError('"length" is outside of buffer bounds');var D;return D=y===void 0&&C===void 0?new Uint8Array(h):C===void 0?new Uint8Array(h,y):new Uint8Array(h,y,C),D.__proto__=f.prototype,D}function v(h){if(f.isBuffer(h)){var y=0|_(h.length),C=c(y);return C.length===0||h.copy(C,0,0,y),C}return h.length===void 0?h.type==="Buffer"&&Array.isArray(h.data)?x(h.data):void 0:typeof h.length!="number"||G(h.length)?c(0):x(h)}function _(h){if(h>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647 .toString(16)+" bytes");return 0|h}function w(h,y){if(f.isBuffer(h))return h.length;if(ArrayBuffer.isView(h)||P(h,ArrayBuffer))return h.byteLength;if(typeof h!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof h);var C=h.length,D=2<arguments.length&&arguments[2]===!0;if(!D&&C===0)return 0;for(var F=!1;;)switch(y){case"ascii":case"latin1":case"binary":return C;case"utf8":case"utf-8":return rt(h).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*C;case"hex":return C>>>1;case"base64":return Ke(h).length;default:if(F)return D?-1:rt(h).length;y=(""+y).toLowerCase(),F=!0}}function I(h,y,C){var D=!1;if((y===void 0||0>y)&&(y=0),y>this.length||((C===void 0||C>this.length)&&(C=this.length),0>=C)||(C>>>=0,y>>>=0,C<=y))return"";for(h||(h="utf8");;)switch(h){case"hex":return Me(this,y,C);case"utf8":case"utf-8":return ee(this,y,C);case"ascii":return de(this,y,C);case"latin1":case"binary":return $e(this,y,C);case"base64":return le(this,y,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Fe(this,y,C);default:if(D)throw new TypeError("Unknown encoding: "+h);h=(h+"").toLowerCase(),D=!0}}function k(h,y,C){var D=h[y];h[y]=h[C],h[C]=D}function M(h,y,C,D,F){if(h.length===0)return-1;if(typeof C=="string"?(D=C,C=0):2147483647<C?C=2147483647:-2147483648>C&&(C=-2147483648),C=+C,G(C)&&(C=F?0:h.length-1),0>C&&(C=h.length+C),C>=h.length){if(F)return-1;C=h.length-1}else if(0>C)if(F)C=0;else return-1;if(typeof y=="string"&&(y=f.from(y,D)),f.isBuffer(y))return y.length===0?-1:K(h,y,C,D,F);if(typeof y=="number")return y&=255,typeof Uint8Array.prototype.indexOf=="function"?F?Uint8Array.prototype.indexOf.call(h,y,C):Uint8Array.prototype.lastIndexOf.call(h,y,C):K(h,[y],C,D,F);throw new TypeError("val must be string, number or Buffer")}function K(h,y,C,D,F){function q(wn,ni){return ae===1?wn[ni]:wn.readUInt16BE(ni*ae)}var ae=1,Be=h.length,nt=y.length;if(D!==void 0&&(D=(D+"").toLowerCase(),D==="ucs2"||D==="ucs-2"||D==="utf16le"||D==="utf-16le")){if(2>h.length||2>y.length)return-1;ae=2,Be/=2,nt/=2,C/=2}var Re;if(F){var Te=-1;for(Re=C;Re<Be;Re++)if(q(h,Re)!==q(y,Te===-1?0:Re-Te))Te!==-1&&(Re-=Re-Te),Te=-1;else if(Te===-1&&(Te=Re),Re-Te+1===nt)return Te*ae}else for(C+nt>Be&&(C=Be-nt),Re=C;0<=Re;Re--){for(var It=!0,rn=0;rn<nt;rn++)if(q(h,Re+rn)!==q(y,rn)){It=!1;break}if(It)return Re}return-1}function N(h,y,C,D){C=+C||0;var F=h.length-C;D?(D=+D,D>F&&(D=F)):D=F;var q=y.length;D>q/2&&(D=q/2);for(var ae,Be=0;Be<D;++Be){if(ae=parseInt(y.substr(2*Be,2),16),G(ae))return Be;h[C+Be]=ae}return Be}function U(h,y,C,D){return He(rt(y,h.length-C),h,C,D)}function H(h,y,C,D){return He(ut(y),h,C,D)}function $(h,y,C,D){return H(h,y,C,D)}function re(h,y,C,D){return He(Ke(y),h,C,D)}function Y(h,y,C,D){return He(Je(y,h.length-C),h,C,D)}function le(h,y,C){return y===0&&C===h.length?J.fromByteArray(h):J.fromByteArray(h.slice(y,C))}function ee(h,y,C){C=u(h.length,C);for(var D=[],F=y;F<C;){var q=h[F],ae=null,Be=239<q?4:223<q?3:191<q?2:1;if(F+Be<=C){var nt,Re,Te,It;Be===1?128>q&&(ae=q):Be===2?(nt=h[F+1],(192&nt)==128&&(It=(31&q)<<6|63&nt,127<It&&(ae=It))):Be===3?(nt=h[F+1],Re=h[F+2],(192&nt)==128&&(192&Re)==128&&(It=(15&q)<<12|(63&nt)<<6|63&Re,2047<It&&(55296>It||57343<It)&&(ae=It))):Be===4&&(nt=h[F+1],Re=h[F+2],Te=h[F+3],(192&nt)==128&&(192&Re)==128&&(192&Te)==128&&(It=(15&q)<<18|(63&nt)<<12|(63&Re)<<6|63&Te,65535<It&&1114112>It&&(ae=It)))}ae===null?(ae=65533,Be=1):65535<ae&&(ae-=65536,D.push(55296|1023&ae>>>10),ae=56320|1023&ae),D.push(ae),F+=Be}return ot(D)}function ot(h){var y=h.length;if(y<=4096)return l.apply(String,h);for(var C="",D=0;D<y;)C+=l.apply(String,h.slice(D,D+=4096));return C}function de(h,y,C){var D="";C=u(h.length,C);for(var F=y;F<C;++F)D+=l(127&h[F]);return D}function $e(h,y,C){var D="";C=u(h.length,C);for(var F=y;F<C;++F)D+=l(h[F]);return D}function Me(h,y,C){var D=h.length;(!y||0>y)&&(y=0),(!C||0>C||C>D)&&(C=D);for(var F="",q=y;q<C;++q)F+=tt(h[q]);return F}function Fe(h,y,C){for(var D=h.slice(y,C),F="",q=0;q<D.length;q+=2)F+=l(D[q]+256*D[q+1]);return F}function _e(h,y,C){if(h%1!=0||0>h)throw new RangeError("offset is not uint");if(h+y>C)throw new RangeError("Trying to access beyond buffer length")}function ve(h,y,C,D,F,q){if(!f.isBuffer(h))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>F||y<q)throw new RangeError('"value" argument is out of bounds');if(C+D>h.length)throw new RangeError("Index out of range")}function Ve(h,y,C,D){if(C+D>h.length)throw new RangeError("Index out of range");if(0>C)throw new RangeError("Index out of range")}function We(h,y,C,D,F){return y=+y,C>>>=0,F||Ve(h,y,C,4),ue.write(h,y,C,D,23,4),C+4}function Qe(h,y,C,D,F){return y=+y,C>>>=0,F||Ve(h,y,C,8),ue.write(h,y,C,D,52,8),C+8}function lt(h){if(h=h.split("=")[0],h=h.trim().replace(A,""),2>h.length)return"";for(;h.length%4!=0;)h+="=";return h}function tt(h){return 16>h?"0"+h.toString(16):h.toString(16)}function rt(h,y){y=y||1/0;for(var C,D=h.length,F=null,q=[],ae=0;ae<D;++ae){if(C=h.charCodeAt(ae),55295<C&&57344>C){if(!F){if(56319<C){-1<(y-=3)&&q.push(239,191,189);continue}else if(ae+1===D){-1<(y-=3)&&q.push(239,191,189);continue}F=C;continue}if(56320>C){-1<(y-=3)&&q.push(239,191,189),F=C;continue}C=(F-55296<<10|C-56320)+65536}else F&&-1<(y-=3)&&q.push(239,191,189);if(F=null,128>C){if(0>(y-=1))break;q.push(C)}else if(2048>C){if(0>(y-=2))break;q.push(192|C>>6,128|63&C)}else if(65536>C){if(0>(y-=3))break;q.push(224|C>>12,128|63&C>>6,128|63&C)}else if(1114112>C){if(0>(y-=4))break;q.push(240|C>>18,128|63&C>>12,128|63&C>>6,128|63&C)}else throw new Error("Invalid code point")}return q}function ut(h){for(var y=[],C=0;C<h.length;++C)y.push(255&h.charCodeAt(C));return y}function Je(h,y){for(var C,D,F,q=[],ae=0;ae<h.length&&!(0>(y-=2));++ae)C=h.charCodeAt(ae),D=C>>8,F=C%256,q.push(F),q.push(D);return q}function Ke(h){return J.toByteArray(lt(h))}function He(h,y,C,D){for(var F=0;F<D&&!(F+C>=y.length||F>=h.length);++F)y[F+C]=h[F];return F}function P(h,y){return h instanceof y||h!=null&&h.constructor!=null&&h.constructor.name!=null&&h.constructor.name===y.name}function G(h){return h!==h}var J=s("base64-js"),ue=s("ieee754");o.Buffer=f,o.SlowBuffer=function(h){return+h!=h&&(h=0),f.alloc(+h)},o.INSPECT_MAX_BYTES=50,o.kMaxLength=2147483647,f.TYPED_ARRAY_SUPPORT=function(){try{var h=new Uint8Array(1);return h.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},h.foo()===42}catch{return!1}}(),f.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(f.prototype,"parent",{enumerable:!0,get:function(){return f.isBuffer(this)?this.buffer:void 0}}),Object.defineProperty(f.prototype,"offset",{enumerable:!0,get:function(){return f.isBuffer(this)?this.byteOffset:void 0}}),typeof Symbol<"u"&&Symbol.species!=null&&f[Symbol.species]===f&&Object.defineProperty(f,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),f.poolSize=8192,f.from=function(h,y,C){return d(h,y,C)},f.prototype.__proto__=Uint8Array.prototype,f.__proto__=Uint8Array,f.alloc=function(h,y,C){return g(h,y,C)},f.allocUnsafe=function(h){return m(h)},f.allocUnsafeSlow=function(h){return m(h)},f.isBuffer=function(h){return h!=null&&h._isBuffer===!0&&h!==f.prototype},f.compare=function(h,y){if(P(h,Uint8Array)&&(h=f.from(h,h.offset,h.byteLength)),P(y,Uint8Array)&&(y=f.from(y,y.offset,y.byteLength)),!f.isBuffer(h)||!f.isBuffer(y))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(h===y)return 0;for(var C=h.length,D=y.length,F=0,q=u(C,D);F<q;++F)if(h[F]!==y[F]){C=h[F],D=y[F];break}return C<D?-1:D<C?1:0},f.isEncoding=function(h){switch((h+"").toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},f.concat=function(h,y){if(!Array.isArray(h))throw new TypeError('"list" argument must be an Array of Buffers');if(h.length===0)return f.alloc(0);var C;if(y===void 0)for(y=0,C=0;C<h.length;++C)y+=h[C].length;var D=f.allocUnsafe(y),F=0;for(C=0;C<h.length;++C){var q=h[C];if(P(q,Uint8Array)&&(q=f.from(q)),!f.isBuffer(q))throw new TypeError('"list" argument must be an Array of Buffers');q.copy(D,F),F+=q.length}return D},f.byteLength=w,f.prototype._isBuffer=!0,f.prototype.swap16=function(){var h=this.length;if(h%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var y=0;y<h;y+=2)k(this,y,y+1);return this},f.prototype.swap32=function(){var h=this.length;if(h%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var y=0;y<h;y+=4)k(this,y,y+3),k(this,y+1,y+2);return this},f.prototype.swap64=function(){var h=this.length;if(h%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var y=0;y<h;y+=8)k(this,y,y+7),k(this,y+1,y+6),k(this,y+2,y+5),k(this,y+3,y+4);return this},f.prototype.toString=function(){var h=this.length;return h===0?"":arguments.length===0?ee(this,0,h):I.apply(this,arguments)},f.prototype.toLocaleString=f.prototype.toString,f.prototype.equals=function(h){if(!f.isBuffer(h))throw new TypeError("Argument must be a Buffer");return this===h||f.compare(this,h)===0},f.prototype.inspect=function(){var h="",y=o.INSPECT_MAX_BYTES;return h=this.toString("hex",0,y).replace(/(.{2})/g,"$1 ").trim(),this.length>y&&(h+=" ... "),"<Buffer "+h+">"},f.prototype.compare=function(h,y,C,D,F){if(P(h,Uint8Array)&&(h=f.from(h,h.offset,h.byteLength)),!f.isBuffer(h))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof h);if(y===void 0&&(y=0),C===void 0&&(C=h?h.length:0),D===void 0&&(D=0),F===void 0&&(F=this.length),0>y||C>h.length||0>D||F>this.length)throw new RangeError("out of range index");if(D>=F&&y>=C)return 0;if(D>=F)return-1;if(y>=C)return 1;if(y>>>=0,C>>>=0,D>>>=0,F>>>=0,this===h)return 0;for(var q=F-D,ae=C-y,Be=u(q,ae),nt=this.slice(D,F),Re=h.slice(y,C),Te=0;Te<Be;++Te)if(nt[Te]!==Re[Te]){q=nt[Te],ae=Re[Te];break}return q<ae?-1:ae<q?1:0},f.prototype.includes=function(h,y,C){return this.indexOf(h,y,C)!==-1},f.prototype.indexOf=function(h,y,C){return M(this,h,y,C,!0)},f.prototype.lastIndexOf=function(h,y,C){return M(this,h,y,C,!1)},f.prototype.write=function(h,y,C,D){if(y===void 0)D="utf8",C=this.length,y=0;else if(C===void 0&&typeof y=="string")D=y,C=this.length,y=0;else if(isFinite(y))y>>>=0,isFinite(C)?(C>>>=0,D===void 0&&(D="utf8")):(D=C,C=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var F=this.length-y;if((C===void 0||C>F)&&(C=F),0<h.length&&(0>C||0>y)||y>this.length)throw new RangeError("Attempt to write outside buffer bounds");D||(D="utf8");for(var q=!1;;)switch(D){case"hex":return N(this,h,y,C);case"utf8":case"utf-8":return U(this,h,y,C);case"ascii":return H(this,h,y,C);case"latin1":case"binary":return $(this,h,y,C);case"base64":return re(this,h,y,C);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Y(this,h,y,C);default:if(q)throw new TypeError("Unknown encoding: "+D);D=(""+D).toLowerCase(),q=!0}},f.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},f.prototype.slice=function(h,y){var C=this.length;h=~~h,y=y===void 0?C:~~y,0>h?(h+=C,0>h&&(h=0)):h>C&&(h=C),0>y?(y+=C,0>y&&(y=0)):y>C&&(y=C),y<h&&(y=h);var D=this.subarray(h,y);return D.__proto__=f.prototype,D},f.prototype.readUIntLE=function(h,y,C){h>>>=0,y>>>=0,C||_e(h,y,this.length);for(var D=this[h],F=1,q=0;++q<y&&(F*=256);)D+=this[h+q]*F;return D},f.prototype.readUIntBE=function(h,y,C){h>>>=0,y>>>=0,C||_e(h,y,this.length);for(var D=this[h+--y],F=1;0<y&&(F*=256);)D+=this[h+--y]*F;return D},f.prototype.readUInt8=function(h,y){return h>>>=0,y||_e(h,1,this.length),this[h]},f.prototype.readUInt16LE=function(h,y){return h>>>=0,y||_e(h,2,this.length),this[h]|this[h+1]<<8},f.prototype.readUInt16BE=function(h,y){return h>>>=0,y||_e(h,2,this.length),this[h]<<8|this[h+1]},f.prototype.readUInt32LE=function(h,y){return h>>>=0,y||_e(h,4,this.length),(this[h]|this[h+1]<<8|this[h+2]<<16)+16777216*this[h+3]},f.prototype.readUInt32BE=function(h,y){return h>>>=0,y||_e(h,4,this.length),16777216*this[h]+(this[h+1]<<16|this[h+2]<<8|this[h+3])},f.prototype.readIntLE=function(h,y,C){h>>>=0,y>>>=0,C||_e(h,y,this.length);for(var D=this[h],F=1,q=0;++q<y&&(F*=256);)D+=this[h+q]*F;return F*=128,D>=F&&(D-=i(2,8*y)),D},f.prototype.readIntBE=function(h,y,C){h>>>=0,y>>>=0,C||_e(h,y,this.length);for(var D=y,F=1,q=this[h+--D];0<D&&(F*=256);)q+=this[h+--D]*F;return F*=128,q>=F&&(q-=i(2,8*y)),q},f.prototype.readInt8=function(h,y){return h>>>=0,y||_e(h,1,this.length),128&this[h]?-1*(255-this[h]+1):this[h]},f.prototype.readInt16LE=function(h,y){h>>>=0,y||_e(h,2,this.length);var C=this[h]|this[h+1]<<8;return 32768&C?4294901760|C:C},f.prototype.readInt16BE=function(h,y){h>>>=0,y||_e(h,2,this.length);var C=this[h+1]|this[h]<<8;return 32768&C?4294901760|C:C},f.prototype.readInt32LE=function(h,y){return h>>>=0,y||_e(h,4,this.length),this[h]|this[h+1]<<8|this[h+2]<<16|this[h+3]<<24},f.prototype.readInt32BE=function(h,y){return h>>>=0,y||_e(h,4,this.length),this[h]<<24|this[h+1]<<16|this[h+2]<<8|this[h+3]},f.prototype.readFloatLE=function(h,y){return h>>>=0,y||_e(h,4,this.length),ue.read(this,h,!0,23,4)},f.prototype.readFloatBE=function(h,y){return h>>>=0,y||_e(h,4,this.length),ue.read(this,h,!1,23,4)},f.prototype.readDoubleLE=function(h,y){return h>>>=0,y||_e(h,8,this.length),ue.read(this,h,!0,52,8)},f.prototype.readDoubleBE=function(h,y){return h>>>=0,y||_e(h,8,this.length),ue.read(this,h,!1,52,8)},f.prototype.writeUIntLE=function(h,y,C,D){if(h=+h,y>>>=0,C>>>=0,!D){var F=i(2,8*C)-1;ve(this,h,y,C,F,0)}var q=1,ae=0;for(this[y]=255&h;++ae<C&&(q*=256);)this[y+ae]=255&h/q;return y+C},f.prototype.writeUIntBE=function(h,y,C,D){if(h=+h,y>>>=0,C>>>=0,!D){var F=i(2,8*C)-1;ve(this,h,y,C,F,0)}var q=C-1,ae=1;for(this[y+q]=255&h;0<=--q&&(ae*=256);)this[y+q]=255&h/ae;return y+C},f.prototype.writeUInt8=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,1,255,0),this[y]=255&h,y+1},f.prototype.writeUInt16LE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,2,65535,0),this[y]=255&h,this[y+1]=h>>>8,y+2},f.prototype.writeUInt16BE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,2,65535,0),this[y]=h>>>8,this[y+1]=255&h,y+2},f.prototype.writeUInt32LE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,4,4294967295,0),this[y+3]=h>>>24,this[y+2]=h>>>16,this[y+1]=h>>>8,this[y]=255&h,y+4},f.prototype.writeUInt32BE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,4,4294967295,0),this[y]=h>>>24,this[y+1]=h>>>16,this[y+2]=h>>>8,this[y+3]=255&h,y+4},f.prototype.writeIntLE=function(h,y,C,D){if(h=+h,y>>>=0,!D){var F=i(2,8*C-1);ve(this,h,y,C,F-1,-F)}var q=0,ae=1,Be=0;for(this[y]=255&h;++q<C&&(ae*=256);)0>h&&Be===0&&this[y+q-1]!==0&&(Be=1),this[y+q]=255&(h/ae>>0)-Be;return y+C},f.prototype.writeIntBE=function(h,y,C,D){if(h=+h,y>>>=0,!D){var F=i(2,8*C-1);ve(this,h,y,C,F-1,-F)}var q=C-1,ae=1,Be=0;for(this[y+q]=255&h;0<=--q&&(ae*=256);)0>h&&Be===0&&this[y+q+1]!==0&&(Be=1),this[y+q]=255&(h/ae>>0)-Be;return y+C},f.prototype.writeInt8=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,1,127,-128),0>h&&(h=255+h+1),this[y]=255&h,y+1},f.prototype.writeInt16LE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,2,32767,-32768),this[y]=255&h,this[y+1]=h>>>8,y+2},f.prototype.writeInt16BE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,2,32767,-32768),this[y]=h>>>8,this[y+1]=255&h,y+2},f.prototype.writeInt32LE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,4,2147483647,-2147483648),this[y]=255&h,this[y+1]=h>>>8,this[y+2]=h>>>16,this[y+3]=h>>>24,y+4},f.prototype.writeInt32BE=function(h,y,C){return h=+h,y>>>=0,C||ve(this,h,y,4,2147483647,-2147483648),0>h&&(h=4294967295+h+1),this[y]=h>>>24,this[y+1]=h>>>16,this[y+2]=h>>>8,this[y+3]=255&h,y+4},f.prototype.writeFloatLE=function(h,y,C){return We(this,h,y,!0,C)},f.prototype.writeFloatBE=function(h,y,C){return We(this,h,y,!1,C)},f.prototype.writeDoubleLE=function(h,y,C){return Qe(this,h,y,!0,C)},f.prototype.writeDoubleBE=function(h,y,C){return Qe(this,h,y,!1,C)},f.prototype.copy=function(h,y,C,D){if(!f.isBuffer(h))throw new TypeError("argument should be a Buffer");if(C||(C=0),D||D===0||(D=this.length),y>=h.length&&(y=h.length),y||(y=0),0<D&&D<C&&(D=C),D===C||h.length===0||this.length===0)return 0;if(0>y)throw new RangeError("targetStart out of bounds");if(0>C||C>=this.length)throw new RangeError("Index out of range");if(0>D)throw new RangeError("sourceEnd out of bounds");D>this.length&&(D=this.length),h.length-y<D-C&&(D=h.length-y+C);var F=D-C;if(this===h&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(y,C,D);else if(this===h&&C<y&&y<D)for(var q=F-1;0<=q;--q)h[q+y]=this[q+C];else Uint8Array.prototype.set.call(h,this.subarray(C,D),y);return F},f.prototype.fill=function(h,y,C,D){if(typeof h=="string"){if(typeof y=="string"?(D=y,y=0,C=this.length):typeof C=="string"&&(D=C,C=this.length),D!==void 0&&typeof D!="string")throw new TypeError("encoding must be a string");if(typeof D=="string"&&!f.isEncoding(D))throw new TypeError("Unknown encoding: "+D);if(h.length===1){var F=h.charCodeAt(0);(D==="utf8"&&128>F||D==="latin1")&&(h=F)}}else typeof h=="number"&&(h&=255);if(0>y||this.length<y||this.length<C)throw new RangeError("Out of range index");if(C<=y)return this;y>>>=0,C=C===void 0?this.length:C>>>0,h||(h=0);var q;if(typeof h=="number")for(q=y;q<C;++q)this[q]=h;else{var ae=f.isBuffer(h)?h:f.from(h,D),Be=ae.length;if(Be===0)throw new TypeError('The value "'+h+'" is invalid for argument "value"');for(q=0;q<C-y;++q)this[q+y]=ae[q%Be]}return this};var A=/[^+/0-9A-Za-z-_]/g}).call(this)}).call(this,s("buffer").Buffer)},{"base64-js":1,buffer:3,ieee754:9}],4:[function(s,a,o){(function(l){(function(){function u(){let f;try{f=o.storage.getItem("debug")}catch{}return!f&&typeof l<"u"&&"env"in l&&(f=l.env.DEBUG),f}o.formatArgs=function(f){if(f[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+f[0]+(this.useColors?"%c ":" ")+"+"+a.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;f.splice(1,0,d,"color: inherit");let p=0,g=0;f[0].replace(/%[a-zA-Z%]/g,m=>{m==="%%"||(p++,m==="%c"&&(g=p))}),f.splice(g,0,d)},o.save=function(f){try{f?o.storage.setItem("debug",f):o.storage.removeItem("debug")}catch{}},o.load=u,o.useColors=function(){return!!(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))||!(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&(typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},o.storage=function(){try{return localStorage}catch{}}(),o.destroy=(()=>{let f=!1;return()=>{f||(f=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),o.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.log=console.debug||console.log||(()=>{}),a.exports=s("./common")(o);const{formatters:c}=a.exports;c.j=function(f){try{return JSON.stringify(f)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}).call(this)}).call(this,s("_process"))},{"./common":5,_process:12}],5:[function(s,a){a.exports=function(o){function l(f){function d(...m){if(!d.enabled)return;const T=d,x=+new Date,B=x-(p||x);T.diff=B,T.prev=p,T.curr=x,p=x,m[0]=l.coerce(m[0]),typeof m[0]!="string"&&m.unshift("%O");let v=0;m[0]=m[0].replace(/%([a-zA-Z%])/g,(w,I)=>{if(w==="%%")return"%";v++;const k=l.formatters[I];if(typeof k=="function"){const M=m[v];w=k.call(T,M),m.splice(v,1),v--}return w}),l.formatArgs.call(T,m),(T.log||l.log).apply(T,m)}let p,g=null;return d.namespace=f,d.useColors=l.useColors(),d.color=l.selectColor(f),d.extend=u,d.destroy=l.destroy,Object.defineProperty(d,"enabled",{enumerable:!0,configurable:!1,get:()=>g===null?l.enabled(f):g,set:m=>{g=m}}),typeof l.init=="function"&&l.init(d),d}function u(f,d){const p=l(this.namespace+(typeof d>"u"?":":d)+f);return p.log=this.log,p}function c(f){return f.toString().substring(2,f.toString().length-2).replace(/\.\*\?$/,"*")}return l.debug=l,l.default=l,l.coerce=function(f){return f instanceof Error?f.stack||f.message:f},l.disable=function(){const f=[...l.names.map(c),...l.skips.map(c).map(d=>"-"+d)].join(",");return l.enable(""),f},l.enable=function(f){l.save(f),l.names=[],l.skips=[];let d;const p=(typeof f=="string"?f:"").split(/[\s,]+/),g=p.length;for(d=0;d<g;d++)p[d]&&(f=p[d].replace(/\*/g,".*?"),f[0]==="-"?l.skips.push(new RegExp("^"+f.substr(1)+"$")):l.names.push(new RegExp("^"+f+"$")))},l.enabled=function(f){if(f[f.length-1]==="*")return!0;let d,p;for(d=0,p=l.skips.length;d<p;d++)if(l.skips[d].test(f))return!1;for(d=0,p=l.names.length;d<p;d++)if(l.names[d].test(f))return!0;return!1},l.humanize=s("ms"),l.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(o).forEach(f=>{l[f]=o[f]}),l.names=[],l.skips=[],l.formatters={},l.selectColor=function(f){let d=0;for(let p=0;p<f.length;p++)d=(d<<5)-d+f.charCodeAt(p),d|=0;return l.colors[n(d)%l.colors.length]},l.enable(l.load()),l}},{ms:11}],6:[function(s,a){function o(l,u){for(const c in u)Object.defineProperty(l,c,{value:u[c],enumerable:!0,configurable:!0});return l}a.exports=function(l,u,c){if(!l||typeof l=="string")throw new TypeError("Please pass an Error to err-code");c||(c={}),typeof u=="object"&&(c=u,u=""),u&&(c.code=u);try{return o(l,c)}catch{c.message=l.message,c.stack=l.stack;const d=function(){};return d.prototype=Object.create(Object.getPrototypeOf(l)),o(new d,c)}}},{}],7:[function(s,a){function o(N){console&&console.warn&&console.warn(N)}function l(){l.init.call(this)}function u(N){if(typeof N!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof N)}function c(N){return N._maxListeners===void 0?l.defaultMaxListeners:N._maxListeners}function f(N,U,H,$){var re,Y,le;if(u(H),Y=N._events,Y===void 0?(Y=N._events=Object.create(null),N._eventsCount=0):(Y.newListener!==void 0&&(N.emit("newListener",U,H.listener?H.listener:H),Y=N._events),le=Y[U]),le===void 0)le=Y[U]=H,++N._eventsCount;else if(typeof le=="function"?le=Y[U]=$?[H,le]:[le,H]:$?le.unshift(H):le.push(H),re=c(N),0<re&&le.length>re&&!le.warned){le.warned=!0;var ee=new Error("Possible EventEmitter memory leak detected. "+le.length+" "+(U+" listeners added. Use emitter.setMaxListeners() to increase limit"));ee.name="MaxListenersExceededWarning",ee.emitter=N,ee.type=U,ee.count=le.length,o(ee)}return N}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(N,U,H){var $={fired:!1,wrapFn:void 0,target:N,type:U,listener:H},re=d.bind($);return re.listener=H,$.wrapFn=re,re}function g(N,U,H){var $=N._events;if($===void 0)return[];var re=$[U];return re===void 0?[]:typeof re=="function"?H?[re.listener||re]:[re]:H?B(re):T(re,re.length)}function m(N){var U=this._events;if(U!==void 0){var H=U[N];if(typeof H=="function")return 1;if(H!==void 0)return H.length}return 0}function T(N,U){for(var H=Array(U),$=0;$<U;++$)H[$]=N[$];return H}function x(N,U){for(;U+1<N.length;U++)N[U]=N[U+1];N.pop()}function B(N){for(var U=Array(N.length),H=0;H<U.length;++H)U[H]=N[H].listener||N[H];return U}function v(N,U,H){typeof N.on=="function"&&_(N,"error",U,H)}function _(N,U,H,$){if(typeof N.on=="function")$.once?N.once(U,H):N.on(U,H);else if(typeof N.addEventListener=="function")N.addEventListener(U,function re(Y){$.once&&N.removeEventListener(U,re),H(Y)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof N)}var w,I=typeof Reflect=="object"?Reflect:null,k=I&&typeof I.apply=="function"?I.apply:function(N,U,H){return Function.prototype.apply.call(N,U,H)};w=I&&typeof I.ownKeys=="function"?I.ownKeys:Object.getOwnPropertySymbols?function(N){return Object.getOwnPropertyNames(N).concat(Object.getOwnPropertySymbols(N))}:function(N){return Object.getOwnPropertyNames(N)};var M=Number.isNaN||function(N){return N!==N};a.exports=l,a.exports.once=function(N,U){return new Promise(function(H,$){function re(le){N.removeListener(U,Y),$(le)}function Y(){typeof N.removeListener=="function"&&N.removeListener("error",re),H([].slice.call(arguments))}_(N,U,Y,{once:!0}),U!=="error"&&v(N,re,{once:!0})})},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var K=10;Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return K},set:function(N){if(typeof N!="number"||0>N||M(N))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+N+".");K=N}}),l.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(N){if(typeof N!="number"||0>N||M(N))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+N+".");return this._maxListeners=N,this},l.prototype.getMaxListeners=function(){return c(this)},l.prototype.emit=function(N){for(var U=[],H=1;H<arguments.length;H++)U.push(arguments[H]);var $=N==="error",re=this._events;if(re!==void 0)$=$&&re.error===void 0;else if(!$)return!1;if($){var Y;if(0<U.length&&(Y=U[0]),Y instanceof Error)throw Y;var le=new Error("Unhandled error."+(Y?" ("+Y.message+")":""));throw le.context=Y,le}var ee=re[N];if(ee===void 0)return!1;if(typeof ee=="function")k(ee,this,U);else for(var ot=ee.length,de=T(ee,ot),H=0;H<ot;++H)k(de[H],this,U);return!0},l.prototype.addListener=function(N,U){return f(this,N,U,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(N,U){return f(this,N,U,!0)},l.prototype.once=function(N,U){return u(U),this.on(N,p(this,N,U)),this},l.prototype.prependOnceListener=function(N,U){return u(U),this.prependListener(N,p(this,N,U)),this},l.prototype.removeListener=function(N,U){var H,$,re,Y,le;if(u(U),$=this._events,$===void 0)return this;if(H=$[N],H===void 0)return this;if(H===U||H.listener===U)--this._eventsCount==0?this._events=Object.create(null):(delete $[N],$.removeListener&&this.emit("removeListener",N,H.listener||U));else if(typeof H!="function"){for(re=-1,Y=H.length-1;0<=Y;Y--)if(H[Y]===U||H[Y].listener===U){le=H[Y].listener,re=Y;break}if(0>re)return this;re===0?H.shift():x(H,re),H.length===1&&($[N]=H[0]),$.removeListener!==void 0&&this.emit("removeListener",N,le||U)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(N){var U,H,$;if(H=this._events,H===void 0)return this;if(H.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):H[N]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete H[N]),this;if(arguments.length===0){var re,Y=Object.keys(H);for($=0;$<Y.length;++$)re=Y[$],re!=="removeListener"&&this.removeAllListeners(re);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(U=H[N],typeof U=="function")this.removeListener(N,U);else if(U!==void 0)for($=U.length-1;0<=$;$--)this.removeListener(N,U[$]);return this},l.prototype.listeners=function(N){return g(this,N,!0)},l.prototype.rawListeners=function(N){return g(this,N,!1)},l.listenerCount=function(N,U){return typeof N.listenerCount=="function"?N.listenerCount(U):m.call(N,U)},l.prototype.listenerCount=m,l.prototype.eventNames=function(){return 0<this._eventsCount?w(this._events):[]}},{}],8:[function(s,a){a.exports=function(){if(typeof globalThis>"u")return null;var o={RTCPeerConnection:globalThis.RTCPeerConnection||globalThis.mozRTCPeerConnection||globalThis.webkitRTCPeerConnection,RTCSessionDescription:globalThis.RTCSessionDescription||globalThis.mozRTCSessionDescription||globalThis.webkitRTCSessionDescription,RTCIceCandidate:globalThis.RTCIceCandidate||globalThis.mozRTCIceCandidate||globalThis.webkitRTCIceCandidate};return o.RTCPeerConnection?o:null}},{}],9:[function(s,a,o){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */o.read=function(l,u,c,f,d){var p,g,m=8*d-f-1,T=(1<<m)-1,x=T>>1,B=-7,v=c?d-1:0,_=c?-1:1,w=l[u+v];for(v+=_,p=w&(1<<-B)-1,w>>=-B,B+=m;0<B;p=256*p+l[u+v],v+=_,B-=8);for(g=p&(1<<-B)-1,p>>=-B,B+=f;0<B;g=256*g+l[u+v],v+=_,B-=8);if(p===0)p=1-x;else{if(p===T)return g?NaN:(w?-1:1)*(1/0);g+=i(2,f),p-=x}return(w?-1:1)*g*i(2,p-f)},o.write=function(l,u,c,f,d,p){var g,m,T,x=Math.LN2,B=Math.log,v=8*p-d-1,_=(1<<v)-1,w=_>>1,I=d===23?i(2,-24)-i(2,-77):0,k=f?0:p-1,M=f?1:-1,K=0>u||u===0&&0>1/u?1:0;for(u=n(u),isNaN(u)||u===1/0?(m=isNaN(u)?1:0,g=_):(g=r(B(u)/x),1>u*(T=i(2,-g))&&(g--,T*=2),u+=1<=g+w?I/T:I*i(2,1-w),2<=u*T&&(g++,T/=2),g+w>=_?(m=0,g=_):1<=g+w?(m=(u*T-1)*i(2,d),g+=w):(m=u*i(2,w-1)*i(2,d),g=0));8<=d;l[c+k]=255&m,k+=M,m/=256,d-=8);for(g=g<<d|m,v+=d;0<v;l[c+k]=255&g,k+=M,g/=256,v-=8);l[c+k-M]|=128*K}},{}],10:[function(s,a){a.exports=typeof Object.create=="function"?function(o,l){l&&(o.super_=l,o.prototype=Object.create(l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,l){if(l){o.super_=l;var u=function(){};u.prototype=l.prototype,o.prototype=new u,o.prototype.constructor=o}}},{}],11:[function(s,a){var o=Math.round;function l(d){if(d+="",!(100<d.length)){var p=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(d);if(p){var g=parseFloat(p[1]),m=(p[2]||"ms").toLowerCase();return m==="years"||m==="year"||m==="yrs"||m==="yr"||m==="y"?315576e5*g:m==="weeks"||m==="week"||m==="w"?6048e5*g:m==="days"||m==="day"||m==="d"?864e5*g:m==="hours"||m==="hour"||m==="hrs"||m==="hr"||m==="h"?36e5*g:m==="minutes"||m==="minute"||m==="mins"||m==="min"||m==="m"?6e4*g:m==="seconds"||m==="second"||m==="secs"||m==="sec"||m==="s"?1e3*g:m==="milliseconds"||m==="millisecond"||m==="msecs"||m==="msec"||m==="ms"?g:void 0}}}function u(d){var p=n(d);return 864e5<=p?o(d/864e5)+"d":36e5<=p?o(d/36e5)+"h":6e4<=p?o(d/6e4)+"m":1e3<=p?o(d/1e3)+"s":d+"ms"}function c(d){var p=n(d);return 864e5<=p?f(d,p,864e5,"day"):36e5<=p?f(d,p,36e5,"hour"):6e4<=p?f(d,p,6e4,"minute"):1e3<=p?f(d,p,1e3,"second"):d+" ms"}function f(d,p,g,m){return o(d/g)+" "+m+(p>=1.5*g?"s":"")}a.exports=function(d,p){p=p||{};var g=typeof d;if(g=="string"&&0<d.length)return l(d);if(g==="number"&&isFinite(d))return p.long?c(d):u(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},{}],12:[function(s,a){function o(){throw new Error("setTimeout has not been defined")}function l(){throw new Error("clearTimeout has not been defined")}function u(I){if(m===setTimeout)return setTimeout(I,0);if((m===o||!m)&&setTimeout)return m=setTimeout,setTimeout(I,0);try{return m(I,0)}catch{try{return m.call(null,I,0)}catch{return m.call(this,I,0)}}}function c(I){if(T===clearTimeout)return clearTimeout(I);if((T===l||!T)&&clearTimeout)return T=clearTimeout,clearTimeout(I);try{return T(I)}catch{try{return T.call(null,I)}catch{return T.call(this,I)}}}function f(){_&&B&&(_=!1,B.length?v=B.concat(v):w=-1,v.length&&d())}function d(){if(!_){var I=u(f);_=!0;for(var k=v.length;k;){for(B=v,v=[];++w<k;)B&&B[w].run();w=-1,k=v.length}B=null,_=!1,c(I)}}function p(I,k){this.fun=I,this.array=k}function g(){}var m,T,x=a.exports={};(function(){try{m=typeof setTimeout=="function"?setTimeout:o}catch{m=o}try{T=typeof clearTimeout=="function"?clearTimeout:l}catch{T=l}})();var B,v=[],_=!1,w=-1;x.nextTick=function(I){var k=Array(arguments.length-1);if(1<arguments.length)for(var M=1;M<arguments.length;M++)k[M-1]=arguments[M];v.push(new p(I,k)),v.length!==1||_||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},x.title="browser",x.browser=!0,x.env={},x.argv=[],x.version="",x.versions={},x.on=g,x.addListener=g,x.once=g,x.off=g,x.removeListener=g,x.removeAllListeners=g,x.emit=g,x.prependListener=g,x.prependOnceListener=g,x.listeners=function(){return[]},x.binding=function(){throw new Error("process.binding is not supported")},x.cwd=function(){return"/"},x.chdir=function(){throw new Error("process.chdir is not supported")},x.umask=function(){return 0}},{}],13:[function(s,a){(function(o){(function(){/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */let l;a.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window>"u"?o:window):u=>(l||(l=Promise.resolve())).then(u).catch(c=>setTimeout(()=>{throw c},0))}).call(this)}).call(this,typeof er>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:er)},{}],14:[function(s,a){(function(o,l){(function(){var u=s("safe-buffer").Buffer,c=l.crypto||l.msCrypto;a.exports=c&&c.getRandomValues?function(f,d){if(f>4294967295)throw new RangeError("requested too many random bytes");var p=u.allocUnsafe(f);if(0<f)if(65536<f)for(var g=0;g<f;g+=65536)c.getRandomValues(p.slice(g,g+65536));else c.getRandomValues(p);return typeof d=="function"?o.nextTick(function(){d(null,p)}):p}:function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,s("_process"),typeof er>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:er)},{_process:12,"safe-buffer":30}],15:[function(s,a){function o(g,m){g.prototype=Object.create(m.prototype),g.prototype.constructor=g,g.__proto__=m}function l(g,m,T){function x(v,_,w){return typeof m=="string"?m:m(v,_,w)}T||(T=Error);var B=function(v){function _(w,I,k){return v.call(this,x(w,I,k))||this}return o(_,v),_}(T);B.prototype.name=T.name,B.prototype.code=g,p[g]=B}function u(g,m){if(Array.isArray(g)){var T=g.length;return g=g.map(function(x){return x+""}),2<T?"one of ".concat(m," ").concat(g.slice(0,T-1).join(", "),", or ")+g[T-1]:T===2?"one of ".concat(m," ").concat(g[0]," or ").concat(g[1]):"of ".concat(m," ").concat(g[0])}return"of ".concat(m," ").concat(g+"")}function c(g,m,T){return g.substr(!T||0>T?0:+T,m.length)===m}function f(g,m,T){return(T===void 0||T>g.length)&&(T=g.length),g.substring(T-m.length,T)===m}function d(g,m,T){return typeof T!="number"&&(T=0),!(T+m.length>g.length)&&g.indexOf(m,T)!==-1}var p={};l("ERR_INVALID_OPT_VALUE",function(g,m){return'The value "'+m+'" is invalid for option "'+g+'"'},TypeError),l("ERR_INVALID_ARG_TYPE",function(g,m,T){var x;typeof m=="string"&&c(m,"not ")?(x="must not be",m=m.replace(/^not /,"")):x="must be";var B;if(f(g," argument"))B="The ".concat(g," ").concat(x," ").concat(u(m,"type"));else{var v=d(g,".")?"property":"argument";B='The "'.concat(g,'" ').concat(v," ").concat(x," ").concat(u(m,"type"))}return B+=". Received type ".concat(typeof T),B},TypeError),l("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),l("ERR_METHOD_NOT_IMPLEMENTED",function(g){return"The "+g+" method is not implemented"}),l("ERR_STREAM_PREMATURE_CLOSE","Premature close"),l("ERR_STREAM_DESTROYED",function(g){return"Cannot call "+g+" after a stream was destroyed"}),l("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),l("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),l("ERR_STREAM_WRITE_AFTER_END","write after end"),l("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),l("ERR_UNKNOWN_ENCODING",function(g){return"Unknown encoding: "+g},TypeError),l("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),a.exports.codes=p},{}],16:[function(s,a){(function(o){(function(){function l(x){return this instanceof l?(d.call(this,x),p.call(this,x),this.allowHalfOpen=!0,void(x&&(x.readable===!1&&(this.readable=!1),x.writable===!1&&(this.writable=!1),x.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",u))))):new l(x)}function u(){this._writableState.ended||o.nextTick(c,this)}function c(x){x.end()}var f=Object.keys||function(x){var B=[];for(var v in x)B.push(v);return B};a.exports=l;var d=s("./_stream_readable"),p=s("./_stream_writable");s("inherits")(l,d);for(var g,m=f(p.prototype),T=0;T<m.length;T++)g=m[T],l.prototype[g]||(l.prototype[g]=p.prototype[g]);Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(x){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=x,this._writableState.destroyed=x)}})}).call(this)}).call(this,s("_process"))},{"./_stream_readable":18,"./_stream_writable":20,_process:12,inherits:10}],17:[function(s,a){function o(u){return this instanceof o?void l.call(this,u):new o(u)}a.exports=o;var l=s("./_stream_transform");s("inherits")(o,l),o.prototype._transform=function(u,c,f){f(null,u)}},{"./_stream_transform":19,inherits:10}],18:[function(s,a){(function(o,l){(function(){function u(A){return Fe.from(A)}function c(A){return Fe.isBuffer(A)||A instanceof _e}function f(A,h,y){return typeof A.prependListener=="function"?A.prependListener(h,y):void(A._events&&A._events[h]?Array.isArray(A._events[h])?A._events[h].unshift(y):A._events[h]=[y,A._events[h]]:A.on(h,y))}function d(A,h,y){ot=ot||s("./_stream_duplex"),A=A||{},typeof y!="boolean"&&(y=h instanceof ot),this.objectMode=!!A.objectMode,y&&(this.objectMode=this.objectMode||!!A.readableObjectMode),this.highWaterMark=ut(this,A,"readableHighWaterMark",y),this.buffer=new lt,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=A.emitClose!==!1,this.autoDestroy=!!A.autoDestroy,this.destroyed=!1,this.defaultEncoding=A.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,A.encoding&&(!Ve&&(Ve=s("string_decoder/").StringDecoder),this.decoder=new Ve(A.encoding),this.encoding=A.encoding)}function p(A){if(ot=ot||s("./_stream_duplex"),!(this instanceof p))return new p(A);var h=this instanceof ot;this._readableState=new d(A,this,h),this.readable=!0,A&&(typeof A.read=="function"&&(this._read=A.read),typeof A.destroy=="function"&&(this._destroy=A.destroy)),Me.call(this)}function g(A,h,y,C,D){de("readableAddChunk",h);var F=A._readableState;if(h===null)F.reading=!1,v(A,F);else{var q;if(D||(q=T(F,h)),q)J(A,q);else if(!(F.objectMode||h&&0<h.length))C||(F.reading=!1,I(A,F));else if(typeof h=="string"||F.objectMode||Object.getPrototypeOf(h)===Fe.prototype||(h=u(h)),C)F.endEmitted?J(A,new G):m(A,F,h,!0);else if(F.ended)J(A,new He);else{if(F.destroyed)return!1;F.reading=!1,F.decoder&&!y?(h=F.decoder.write(h),F.objectMode||h.length!==0?m(A,F,h,!1):I(A,F)):m(A,F,h,!1)}}return!F.ended&&(F.length<F.highWaterMark||F.length===0)}function m(A,h,y,C){h.flowing&&h.length===0&&!h.sync?(h.awaitDrain=0,A.emit("data",y)):(h.length+=h.objectMode?1:y.length,C?h.buffer.unshift(y):h.buffer.push(y),h.needReadable&&_(A)),I(A,h)}function T(A,h){var y;return c(h)||typeof h=="string"||h===void 0||A.objectMode||(y=new Ke("chunk",["string","Buffer","Uint8Array"],h)),y}function x(A){return 1073741824<=A?A=1073741824:(A--,A|=A>>>1,A|=A>>>2,A|=A>>>4,A|=A>>>8,A|=A>>>16,A++),A}function B(A,h){return 0>=A||h.length===0&&h.ended?0:h.objectMode?1:A===A?(A>h.highWaterMark&&(h.highWaterMark=x(A)),A<=h.length?A:h.ended?h.length:(h.needReadable=!0,0)):h.flowing&&h.length?h.buffer.head.data.length:h.length}function v(A,h){if(de("onEofChunk"),!h.ended){if(h.decoder){var y=h.decoder.end();y&&y.length&&(h.buffer.push(y),h.length+=h.objectMode?1:y.length)}h.ended=!0,h.sync?_(A):(h.needReadable=!1,!h.emittedReadable&&(h.emittedReadable=!0,w(A)))}}function _(A){var h=A._readableState;de("emitReadable",h.needReadable,h.emittedReadable),h.needReadable=!1,h.emittedReadable||(de("emitReadable",h.flowing),h.emittedReadable=!0,o.nextTick(w,A))}function w(A){var h=A._readableState;de("emitReadable_",h.destroyed,h.length,h.ended),!h.destroyed&&(h.length||h.ended)&&(A.emit("readable"),h.emittedReadable=!1),h.needReadable=!h.flowing&&!h.ended&&h.length<=h.highWaterMark,$(A)}function I(A,h){h.readingMore||(h.readingMore=!0,o.nextTick(k,A,h))}function k(A,h){for(;!h.reading&&!h.ended&&(h.length<h.highWaterMark||h.flowing&&h.length===0);){var y=h.length;if(de("maybeReadMore read 0"),A.read(0),y===h.length)break}h.readingMore=!1}function M(A){return function(){var h=A._readableState;de("pipeOnDrain",h.awaitDrain),h.awaitDrain&&h.awaitDrain--,h.awaitDrain===0&&$e(A,"data")&&(h.flowing=!0,$(A))}}function K(A){var h=A._readableState;h.readableListening=0<A.listenerCount("readable"),h.resumeScheduled&&!h.paused?h.flowing=!0:0<A.listenerCount("data")&&A.resume()}function N(A){de("readable nexttick read 0"),A.read(0)}function U(A,h){h.resumeScheduled||(h.resumeScheduled=!0,o.nextTick(H,A,h))}function H(A,h){de("resume",h.reading),h.reading||A.read(0),h.resumeScheduled=!1,A.emit("resume"),$(A),h.flowing&&!h.reading&&A.read(0)}function $(A){var h=A._readableState;for(de("flow",h.flowing);h.flowing&&A.read()!==null;);}function re(A,h){if(h.length===0)return null;var y;return h.objectMode?y=h.buffer.shift():!A||A>=h.length?(y=h.decoder?h.buffer.join(""):h.buffer.length===1?h.buffer.first():h.buffer.concat(h.length),h.buffer.clear()):y=h.buffer.consume(A,h.decoder),y}function Y(A){var h=A._readableState;de("endReadable",h.endEmitted),h.endEmitted||(h.ended=!0,o.nextTick(le,h,A))}function le(A,h){if(de("endReadableNT",A.endEmitted,A.length),!A.endEmitted&&A.length===0&&(A.endEmitted=!0,h.readable=!1,h.emit("end"),A.autoDestroy)){var y=h._writableState;(!y||y.autoDestroy&&y.finished)&&h.destroy()}}function ee(A,h){for(var y=0,C=A.length;y<C;y++)if(A[y]===h)return y;return-1}a.exports=p;var ot;p.ReadableState=d;var de;s("events").EventEmitter;var $e=function(A,h){return A.listeners(h).length},Me=s("./internal/streams/stream"),Fe=s("buffer").Buffer,_e=l.Uint8Array||function(){},ve=s("util");de=ve&&ve.debuglog?ve.debuglog("stream"):function(){};var Ve,We,Qe,lt=s("./internal/streams/buffer_list"),tt=s("./internal/streams/destroy"),rt=s("./internal/streams/state"),ut=rt.getHighWaterMark,Je=s("../errors").codes,Ke=Je.ERR_INVALID_ARG_TYPE,He=Je.ERR_STREAM_PUSH_AFTER_EOF,P=Je.ERR_METHOD_NOT_IMPLEMENTED,G=Je.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;s("inherits")(p,Me);var J=tt.errorOrDestroy,ue=["error","close","destroy","pause","resume"];Object.defineProperty(p.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(A){this._readableState&&(this._readableState.destroyed=A)}}),p.prototype.destroy=tt.destroy,p.prototype._undestroy=tt.undestroy,p.prototype._destroy=function(A,h){h(A)},p.prototype.push=function(A,h){var y,C=this._readableState;return C.objectMode?y=!0:typeof A=="string"&&(h=h||C.defaultEncoding,h!==C.encoding&&(A=Fe.from(A,h),h=""),y=!0),g(this,A,h,!1,y)},p.prototype.unshift=function(A){return g(this,A,null,!0,!1)},p.prototype.isPaused=function(){return this._readableState.flowing===!1},p.prototype.setEncoding=function(A){Ve||(Ve=s("string_decoder/").StringDecoder);var h=new Ve(A);this._readableState.decoder=h,this._readableState.encoding=this._readableState.decoder.encoding;for(var y=this._readableState.buffer.head,C="";y!==null;)C+=h.write(y.data),y=y.next;return this._readableState.buffer.clear(),C!==""&&this._readableState.buffer.push(C),this._readableState.length=C.length,this},p.prototype.read=function(A){de("read",A),A=parseInt(A,10);var h=this._readableState,y=A;if(A!==0&&(h.emittedReadable=!1),A===0&&h.needReadable&&((h.highWaterMark===0?0<h.length:h.length>=h.highWaterMark)||h.ended))return de("read: emitReadable",h.length,h.ended),h.length===0&&h.ended?Y(this):_(this),null;if(A=B(A,h),A===0&&h.ended)return h.length===0&&Y(this),null;var C=h.needReadable;de("need readable",C),(h.length===0||h.length-A<h.highWaterMark)&&(C=!0,de("length less than watermark",C)),h.ended||h.reading?(C=!1,de("reading or ended",C)):C&&(de("do read"),h.reading=!0,h.sync=!0,h.length===0&&(h.needReadable=!0),this._read(h.highWaterMark),h.sync=!1,!h.reading&&(A=B(y,h)));var D;return D=0<A?re(A,h):null,D===null?(h.needReadable=h.length<=h.highWaterMark,A=0):(h.length-=A,h.awaitDrain=0),h.length===0&&(!h.ended&&(h.needReadable=!0),y!==A&&h.ended&&Y(this)),D!==null&&this.emit("data",D),D},p.prototype._read=function(){J(this,new P("_read()"))},p.prototype.pipe=function(A,h){function y(Tn,xn){de("onunpipe"),Tn===Re&&xn&&xn.hasUnpiped===!1&&(xn.hasUnpiped=!0,D())}function C(){de("onend"),A.end()}function D(){de("cleanup"),A.removeListener("close",ae),A.removeListener("finish",Be),A.removeListener("drain",wn),A.removeListener("error",q),A.removeListener("unpipe",y),Re.removeListener("end",C),Re.removeListener("end",nt),Re.removeListener("data",F),ni=!0,Te.awaitDrain&&(!A._writableState||A._writableState.needDrain)&&wn()}function F(Tn){de("ondata");var xn=A.write(Tn);de("dest.write",xn),xn===!1&&((Te.pipesCount===1&&Te.pipes===A||1<Te.pipesCount&&ee(Te.pipes,A)!==-1)&&!ni&&(de("false write response, pause",Te.awaitDrain),Te.awaitDrain++),Re.pause())}function q(Tn){de("onerror",Tn),nt(),A.removeListener("error",q),$e(A,"error")===0&&J(A,Tn)}function ae(){A.removeListener("finish",Be),nt()}function Be(){de("onfinish"),A.removeListener("close",ae),nt()}function nt(){de("unpipe"),Re.unpipe(A)}var Re=this,Te=this._readableState;switch(Te.pipesCount){case 0:Te.pipes=A;break;case 1:Te.pipes=[Te.pipes,A];break;default:Te.pipes.push(A)}Te.pipesCount+=1,de("pipe count=%d opts=%j",Te.pipesCount,h);var It=(!h||h.end!==!1)&&A!==o.stdout&&A!==o.stderr,rn=It?C:nt;Te.endEmitted?o.nextTick(rn):Re.once("end",rn),A.on("unpipe",y);var wn=M(Re);A.on("drain",wn);var ni=!1;return Re.on("data",F),f(A,"error",q),A.once("close",ae),A.once("finish",Be),A.emit("pipe",Re),Te.flowing||(de("pipe resume"),Re.resume()),A},p.prototype.unpipe=function(A){var h=this._readableState,y={hasUnpiped:!1};if(h.pipesCount===0)return this;if(h.pipesCount===1)return A&&A!==h.pipes?this:(A||(A=h.pipes),h.pipes=null,h.pipesCount=0,h.flowing=!1,A&&A.emit("unpipe",this,y),this);if(!A){var C=h.pipes,D=h.pipesCount;h.pipes=null,h.pipesCount=0,h.flowing=!1;for(var F=0;F<D;F++)C[F].emit("unpipe",this,{hasUnpiped:!1});return this}var q=ee(h.pipes,A);return q===-1?this:(h.pipes.splice(q,1),h.pipesCount-=1,h.pipesCount===1&&(h.pipes=h.pipes[0]),A.emit("unpipe",this,y),this)},p.prototype.on=function(A,h){var y=Me.prototype.on.call(this,A,h),C=this._readableState;return A==="data"?(C.readableListening=0<this.listenerCount("readable"),C.flowing!==!1&&this.resume()):A=="readable"&&!C.endEmitted&&!C.readableListening&&(C.readableListening=C.needReadable=!0,C.flowing=!1,C.emittedReadable=!1,de("on readable",C.length,C.reading),C.length?_(this):!C.reading&&o.nextTick(N,this)),y},p.prototype.addListener=p.prototype.on,p.prototype.removeListener=function(A,h){var y=Me.prototype.removeListener.call(this,A,h);return A==="readable"&&o.nextTick(K,this),y},p.prototype.removeAllListeners=function(A){var h=Me.prototype.removeAllListeners.apply(this,arguments);return(A==="readable"||A===void 0)&&o.nextTick(K,this),h},p.prototype.resume=function(){var A=this._readableState;return A.flowing||(de("resume"),A.flowing=!A.readableListening,U(this,A)),A.paused=!1,this},p.prototype.pause=function(){return de("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(de("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},p.prototype.wrap=function(A){var h=this,y=this._readableState,C=!1;for(var D in A.on("end",function(){if(de("wrapped end"),y.decoder&&!y.ended){var q=y.decoder.end();q&&q.length&&h.push(q)}h.push(null)}),A.on("data",function(q){if(de("wrapped data"),y.decoder&&(q=y.decoder.write(q)),!(y.objectMode&&q==null)&&(y.objectMode||q&&q.length)){var ae=h.push(q);ae||(C=!0,A.pause())}}),A)this[D]===void 0&&typeof A[D]=="function"&&(this[D]=function(q){return function(){return A[q].apply(A,arguments)}}(D));for(var F=0;F<ue.length;F++)A.on(ue[F],this.emit.bind(this,ue[F]));return this._read=function(q){de("wrapped _read",q),C&&(C=!1,A.resume())},this},typeof Symbol=="function"&&(p.prototype[Symbol.asyncIterator]=function(){return We===void 0&&(We=s("./internal/streams/async_iterator")),We(this)}),Object.defineProperty(p.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(p.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(p.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(A){this._readableState&&(this._readableState.flowing=A)}}),p._fromList=re,Object.defineProperty(p.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(p.from=function(A,h){return Qe===void 0&&(Qe=s("./internal/streams/from")),Qe(p,A,h)})}).call(this)}).call(this,s("_process"),typeof er>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:er)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/async_iterator":21,"./internal/streams/buffer_list":22,"./internal/streams/destroy":23,"./internal/streams/from":25,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,events:7,inherits:10,"string_decoder/":31,util:2}],19:[function(s,a){function o(x,B){var v=this._transformState;v.transforming=!1;var _=v.writecb;if(_===null)return this.emit("error",new p);v.writechunk=null,v.writecb=null,B!=null&&this.push(B),_(x);var w=this._readableState;w.reading=!1,(w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}function l(x){return this instanceof l?(T.call(this,x),this._transformState={afterTransform:o.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,x&&(typeof x.transform=="function"&&(this._transform=x.transform),typeof x.flush=="function"&&(this._flush=x.flush)),void this.on("prefinish",u)):new l(x)}function u(){var x=this;typeof this._flush!="function"||this._readableState.destroyed?c(this,null,null):this._flush(function(B,v){c(x,B,v)})}function c(x,B,v){if(B)return x.emit("error",B);if(v!=null&&x.push(v),x._writableState.length)throw new m;if(x._transformState.transforming)throw new g;return x.push(null)}a.exports=l;var f=s("../errors").codes,d=f.ERR_METHOD_NOT_IMPLEMENTED,p=f.ERR_MULTIPLE_CALLBACK,g=f.ERR_TRANSFORM_ALREADY_TRANSFORMING,m=f.ERR_TRANSFORM_WITH_LENGTH_0,T=s("./_stream_duplex");s("inherits")(l,T),l.prototype.push=function(x,B){return this._transformState.needTransform=!1,T.prototype.push.call(this,x,B)},l.prototype._transform=function(x,B,v){v(new d("_transform()"))},l.prototype._write=function(x,B,v){var _=this._transformState;if(_.writecb=v,_.writechunk=x,_.writeencoding=B,!_.transforming){var w=this._readableState;(_.needTransform||w.needReadable||w.length<w.highWaterMark)&&this._read(w.highWaterMark)}},l.prototype._read=function(){var x=this._transformState;x.writechunk===null||x.transforming?x.needTransform=!0:(x.transforming=!0,this._transform(x.writechunk,x.writeencoding,x.afterTransform))},l.prototype._destroy=function(x,B){T.prototype._destroy.call(this,x,function(v){B(v)})}},{"../errors":15,"./_stream_duplex":16,inherits:10}],20:[function(s,a){(function(o,l){(function(){function u(P){var G=this;this.next=null,this.entry=null,this.finish=function(){Y(G,P)}}function c(P){return de.from(P)}function f(P){return de.isBuffer(P)||P instanceof $e}function d(){}function p(P,G,J){le=le||s("./_stream_duplex"),P=P||{},typeof J!="boolean"&&(J=G instanceof le),this.objectMode=!!P.objectMode,J&&(this.objectMode=this.objectMode||!!P.writableObjectMode),this.highWaterMark=_e(this,P,"writableHighWaterMark",J),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var ue=P.decodeStrings===!1;this.decodeStrings=!ue,this.defaultEncoding=P.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(A){I(G,A)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=P.emitClose!==!1,this.autoDestroy=!!P.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new u(this)}function g(P){le=le||s("./_stream_duplex");var G=this instanceof le;return G||He.call(g,this)?(this._writableState=new p(P,this,G),this.writable=!0,P&&(typeof P.write=="function"&&(this._write=P.write),typeof P.writev=="function"&&(this._writev=P.writev),typeof P.destroy=="function"&&(this._destroy=P.destroy),typeof P.final=="function"&&(this._final=P.final)),void ot.call(this)):new g(P)}function m(P,G){var J=new ut;Ke(P,J),o.nextTick(G,J)}function T(P,G,J,ue){var A;return J===null?A=new rt:typeof J!="string"&&!G.objectMode&&(A=new Ve("chunk",["string","Buffer"],J)),!A||(Ke(P,A),o.nextTick(ue,A),!1)}function x(P,G,J){return P.objectMode||P.decodeStrings===!1||typeof G!="string"||(G=de.from(G,J)),G}function B(P,G,J,ue,A,h){if(!J){var y=x(G,ue,A);ue!==y&&(J=!0,A="buffer",ue=y)}var C=G.objectMode?1:ue.length;G.length+=C;var D=G.length<G.highWaterMark;if(D||(G.needDrain=!0),G.writing||G.corked){var F=G.lastBufferedRequest;G.lastBufferedRequest={chunk:ue,encoding:A,isBuf:J,callback:h,next:null},F?F.next=G.lastBufferedRequest:G.bufferedRequest=G.lastBufferedRequest,G.bufferedRequestCount+=1}else v(P,G,!1,C,ue,A,h);return D}function v(P,G,J,ue,A,h,y){G.writelen=ue,G.writecb=y,G.writing=!0,G.sync=!0,G.destroyed?G.onwrite(new tt("write")):J?P._writev(A,G.onwrite):P._write(A,h,G.onwrite),G.sync=!1}function _(P,G,J,ue,A){--G.pendingcb,J?(o.nextTick(A,ue),o.nextTick($,P,G),P._writableState.errorEmitted=!0,Ke(P,ue)):(A(ue),P._writableState.errorEmitted=!0,Ke(P,ue),$(P,G))}function w(P){P.writing=!1,P.writecb=null,P.length-=P.writelen,P.writelen=0}function I(P,G){var J=P._writableState,ue=J.sync,A=J.writecb;if(typeof A!="function")throw new Qe;if(w(J),G)_(P,J,ue,G,A);else{var h=N(J)||P.destroyed;h||J.corked||J.bufferProcessing||!J.bufferedRequest||K(P,J),ue?o.nextTick(k,P,J,h,A):k(P,J,h,A)}}function k(P,G,J,ue){J||M(P,G),G.pendingcb--,ue(),$(P,G)}function M(P,G){G.length===0&&G.needDrain&&(G.needDrain=!1,P.emit("drain"))}function K(P,G){G.bufferProcessing=!0;var J=G.bufferedRequest;if(P._writev&&J&&J.next){var ue=G.bufferedRequestCount,A=Array(ue),h=G.corkedRequestsFree;h.entry=J;for(var y=0,C=!0;J;)A[y]=J,J.isBuf||(C=!1),J=J.next,y+=1;A.allBuffers=C,v(P,G,!0,G.length,A,"",h.finish),G.pendingcb++,G.lastBufferedRequest=null,h.next?(G.corkedRequestsFree=h.next,h.next=null):G.corkedRequestsFree=new u(G),G.bufferedRequestCount=0}else{for(;J;){var D=J.chunk,F=J.encoding,q=J.callback,ae=G.objectMode?1:D.length;if(v(P,G,!1,ae,D,F,q),J=J.next,G.bufferedRequestCount--,G.writing)break}J===null&&(G.lastBufferedRequest=null)}G.bufferedRequest=J,G.bufferProcessing=!1}function N(P){return P.ending&&P.length===0&&P.bufferedRequest===null&&!P.finished&&!P.writing}function U(P,G){P._final(function(J){G.pendingcb--,J&&Ke(P,J),G.prefinished=!0,P.emit("prefinish"),$(P,G)})}function H(P,G){G.prefinished||G.finalCalled||(typeof P._final!="function"||G.destroyed?(G.prefinished=!0,P.emit("prefinish")):(G.pendingcb++,G.finalCalled=!0,o.nextTick(U,P,G)))}function $(P,G){var J=N(G);if(J&&(H(P,G),G.pendingcb===0&&(G.finished=!0,P.emit("finish"),G.autoDestroy))){var ue=P._readableState;(!ue||ue.autoDestroy&&ue.endEmitted)&&P.destroy()}return J}function re(P,G,J){G.ending=!0,$(P,G),J&&(G.finished?o.nextTick(J):P.once("finish",J)),G.ended=!0,P.writable=!1}function Y(P,G,J){var ue=P.entry;for(P.entry=null;ue;){var A=ue.callback;G.pendingcb--,A(J),ue=ue.next}G.corkedRequestsFree.next=P}a.exports=g;var le;g.WritableState=p;var ee={deprecate:s("util-deprecate")},ot=s("./internal/streams/stream"),de=s("buffer").Buffer,$e=l.Uint8Array||function(){},Me=s("./internal/streams/destroy"),Fe=s("./internal/streams/state"),_e=Fe.getHighWaterMark,ve=s("../errors").codes,Ve=ve.ERR_INVALID_ARG_TYPE,We=ve.ERR_METHOD_NOT_IMPLEMENTED,Qe=ve.ERR_MULTIPLE_CALLBACK,lt=ve.ERR_STREAM_CANNOT_PIPE,tt=ve.ERR_STREAM_DESTROYED,rt=ve.ERR_STREAM_NULL_VALUES,ut=ve.ERR_STREAM_WRITE_AFTER_END,Je=ve.ERR_UNKNOWN_ENCODING,Ke=Me.errorOrDestroy;s("inherits")(g,ot),p.prototype.getBuffer=function(){for(var P=this.bufferedRequest,G=[];P;)G.push(P),P=P.next;return G},function(){try{Object.defineProperty(p.prototype,"buffer",{get:ee.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var He;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(He=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(P){return!!He.call(this,P)||this===g&&P&&P._writableState instanceof p}})):He=function(P){return P instanceof this},g.prototype.pipe=function(){Ke(this,new lt)},g.prototype.write=function(P,G,J){var ue=this._writableState,A=!1,h=!ue.objectMode&&f(P);return h&&!de.isBuffer(P)&&(P=c(P)),typeof G=="function"&&(J=G,G=null),h?G="buffer":!G&&(G=ue.defaultEncoding),typeof J!="function"&&(J=d),ue.ending?m(this,J):(h||T(this,ue,P,J))&&(ue.pendingcb++,A=B(this,ue,h,P,G,J)),A},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var P=this._writableState;P.corked&&(P.corked--,!P.writing&&!P.corked&&!P.bufferProcessing&&P.bufferedRequest&&K(this,P))},g.prototype.setDefaultEncoding=function(P){if(typeof P=="string"&&(P=P.toLowerCase()),!(-1<["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((P+"").toLowerCase())))throw new Je(P);return this._writableState.defaultEncoding=P,this},Object.defineProperty(g.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(P,G,J){J(new We("_write()"))},g.prototype._writev=null,g.prototype.end=function(P,G,J){var ue=this._writableState;return typeof P=="function"?(J=P,P=null,G=null):typeof G=="function"&&(J=G,G=null),P!=null&&this.write(P,G),ue.corked&&(ue.corked=1,this.uncork()),ue.ending||re(this,ue,J),this},Object.defineProperty(g.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(g.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(P){this._writableState&&(this._writableState.destroyed=P)}}),g.prototype.destroy=Me.destroy,g.prototype._undestroy=Me.undestroy,g.prototype._destroy=function(P,G){G(P)}}).call(this)}).call(this,s("_process"),typeof er>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:er)},{"../errors":15,"./_stream_duplex":16,"./internal/streams/destroy":23,"./internal/streams/state":27,"./internal/streams/stream":28,_process:12,buffer:3,inherits:10,"util-deprecate":32}],21:[function(s,a){(function(o){(function(){function l(M,K,N){return K in M?Object.defineProperty(M,K,{value:N,enumerable:!0,configurable:!0,writable:!0}):M[K]=N,M}function u(M,K){return{value:M,done:K}}function c(M){var K=M[m];if(K!==null){var N=M[w].read();N!==null&&(M[v]=null,M[m]=null,M[T]=null,K(u(N,!1)))}}function f(M){o.nextTick(c,M)}function d(M,K){return function(N,U){M.then(function(){return K[B]?void N(u(void 0,!0)):void K[_](N,U)},U)}}var p,g=s("./end-of-stream"),m=Symbol("lastResolve"),T=Symbol("lastReject"),x=Symbol("error"),B=Symbol("ended"),v=Symbol("lastPromise"),_=Symbol("handlePromise"),w=Symbol("stream"),I=Object.getPrototypeOf(function(){}),k=Object.setPrototypeOf((p={get stream(){return this[w]},next:function(){var M=this,K=this[x];if(K!==null)return Promise.reject(K);if(this[B])return Promise.resolve(u(void 0,!0));if(this[w].destroyed)return new Promise(function($,re){o.nextTick(function(){M[x]?re(M[x]):$(u(void 0,!0))})});var N,U=this[v];if(U)N=new Promise(d(U,this));else{var H=this[w].read();if(H!==null)return Promise.resolve(u(H,!1));N=new Promise(this[_])}return this[v]=N,N}},l(p,Symbol.asyncIterator,function(){return this}),l(p,"return",function(){var M=this;return new Promise(function(K,N){M[w].destroy(null,function(U){return U?void N(U):void K(u(void 0,!0))})})}),p),I);a.exports=function(M){var K,N=Object.create(k,(K={},l(K,w,{value:M,writable:!0}),l(K,m,{value:null,writable:!0}),l(K,T,{value:null,writable:!0}),l(K,x,{value:null,writable:!0}),l(K,B,{value:M._readableState.endEmitted,writable:!0}),l(K,_,{value:function(U,H){var $=N[w].read();$?(N[v]=null,N[m]=null,N[T]=null,U(u($,!1))):(N[m]=U,N[T]=H)},writable:!0}),K));return N[v]=null,g(M,function(U){if(U&&U.code!=="ERR_STREAM_PREMATURE_CLOSE"){var H=N[T];return H!==null&&(N[v]=null,N[m]=null,N[T]=null,H(U)),void(N[x]=U)}var $=N[m];$!==null&&(N[v]=null,N[m]=null,N[T]=null,$(u(void 0,!0))),N[B]=!0}),M.on("readable",f.bind(null,N)),N}}).call(this)}).call(this,s("_process"))},{"./end-of-stream":24,_process:12}],22:[function(s,a){function o(v,_){var w=Object.keys(v);if(Object.getOwnPropertySymbols){var I=Object.getOwnPropertySymbols(v);_&&(I=I.filter(function(k){return Object.getOwnPropertyDescriptor(v,k).enumerable})),w.push.apply(w,I)}return w}function l(v){for(var _,w=1;w<arguments.length;w++)_=arguments[w]==null?{}:arguments[w],w%2?o(Object(_),!0).forEach(function(I){u(v,I,_[I])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(_)):o(Object(_)).forEach(function(I){Object.defineProperty(v,I,Object.getOwnPropertyDescriptor(_,I))});return v}function u(v,_,w){return _ in v?Object.defineProperty(v,_,{value:w,enumerable:!0,configurable:!0,writable:!0}):v[_]=w,v}function c(v,_){if(!(v instanceof _))throw new TypeError("Cannot call a class as a function")}function f(v,_){for(var w,I=0;I<_.length;I++)w=_[I],w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(v,w.key,w)}function d(v,_,w){return _&&f(v.prototype,_),w&&f(v,w),v}function p(v,_,w){m.prototype.copy.call(v,_,w)}var g=s("buffer"),m=g.Buffer,T=s("util"),x=T.inspect,B=x&&x.custom||"inspect";a.exports=function(){function v(){c(this,v),this.head=null,this.tail=null,this.length=0}return d(v,[{key:"push",value:function(_){var w={data:_,next:null};0<this.length?this.tail.next=w:this.head=w,this.tail=w,++this.length}},{key:"unshift",value:function(_){var w={data:_,next:this.head};this.length===0&&(this.tail=w),this.head=w,++this.length}},{key:"shift",value:function(){if(this.length!==0){var _=this.head.data;return this.head=this.length===1?this.tail=null:this.head.next,--this.length,_}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(_){if(this.length===0)return"";for(var w=this.head,I=""+w.data;w=w.next;)I+=_+w.data;return I}},{key:"concat",value:function(_){if(this.length===0)return m.alloc(0);for(var w=m.allocUnsafe(_>>>0),I=this.head,k=0;I;)p(I.data,w,k),k+=I.data.length,I=I.next;return w}},{key:"consume",value:function(_,w){var I;return _<this.head.data.length?(I=this.head.data.slice(0,_),this.head.data=this.head.data.slice(_)):_===this.head.data.length?I=this.shift():I=w?this._getString(_):this._getBuffer(_),I}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(_){var w=this.head,I=1,k=w.data;for(_-=k.length;w=w.next;){var M=w.data,K=_>M.length?M.length:_;if(k+=K===M.length?M:M.slice(0,_),_-=K,_===0){K===M.length?(++I,this.head=w.next?w.next:this.tail=null):(this.head=w,w.data=M.slice(K));break}++I}return this.length-=I,k}},{key:"_getBuffer",value:function(_){var w=m.allocUnsafe(_),I=this.head,k=1;for(I.data.copy(w),_-=I.data.length;I=I.next;){var M=I.data,K=_>M.length?M.length:_;if(M.copy(w,w.length-_,0,K),_-=K,_===0){K===M.length?(++k,this.head=I.next?I.next:this.tail=null):(this.head=I,I.data=M.slice(K));break}++k}return this.length-=k,w}},{key:B,value:function(_,w){return x(this,l({},w,{depth:0,customInspect:!1}))}}]),v}()},{buffer:3,util:2}],23:[function(s,a){(function(o){(function(){function l(f,d){c(f,d),u(f)}function u(f){f._writableState&&!f._writableState.emitClose||f._readableState&&!f._readableState.emitClose||f.emit("close")}function c(f,d){f.emit("error",d)}a.exports={destroy:function(f,d){var p=this,g=this._readableState&&this._readableState.destroyed,m=this._writableState&&this._writableState.destroyed;return g||m?(d?d(f):f&&(this._writableState?!this._writableState.errorEmitted&&(this._writableState.errorEmitted=!0,o.nextTick(c,this,f)):o.nextTick(c,this,f)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(f||null,function(T){!d&&T?p._writableState?p._writableState.errorEmitted?o.nextTick(u,p):(p._writableState.errorEmitted=!0,o.nextTick(l,p,T)):o.nextTick(l,p,T):d?(o.nextTick(u,p),d(T)):o.nextTick(u,p)}),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(f,d){var p=f._readableState,g=f._writableState;p&&p.autoDestroy||g&&g.autoDestroy?f.destroy(d):f.emit("error",d)}}}).call(this)}).call(this,s("_process"))},{_process:12}],24:[function(s,a){function o(d){var p=!1;return function(){if(!p){p=!0;for(var g=arguments.length,m=Array(g),T=0;T<g;T++)m[T]=arguments[T];d.apply(this,m)}}}function l(){}function u(d){return d.setHeader&&typeof d.abort=="function"}function c(d,p,g){if(typeof p=="function")return c(d,null,p);p||(p={}),g=o(g||l);var m=p.readable||p.readable!==!1&&d.readable,T=p.writable||p.writable!==!1&&d.writable,x=function(){d.writable||v()},B=d._writableState&&d._writableState.finished,v=function(){T=!1,B=!0,m||g.call(d)},_=d._readableState&&d._readableState.endEmitted,w=function(){m=!1,_=!0,T||g.call(d)},I=function(K){g.call(d,K)},k=function(){var K;return m&&!_?(d._readableState&&d._readableState.ended||(K=new f),g.call(d,K)):T&&!B?(d._writableState&&d._writableState.ended||(K=new f),g.call(d,K)):void 0},M=function(){d.req.on("finish",v)};return u(d)?(d.on("complete",v),d.on("abort",k),d.req?M():d.on("request",M)):T&&!d._writableState&&(d.on("end",x),d.on("close",x)),d.on("end",w),d.on("finish",v),p.error!==!1&&d.on("error",I),d.on("close",k),function(){d.removeListener("complete",v),d.removeListener("abort",k),d.removeListener("request",M),d.req&&d.req.removeListener("finish",v),d.removeListener("end",x),d.removeListener("close",x),d.removeListener("finish",v),d.removeListener("end",w),d.removeListener("error",I),d.removeListener("close",k)}}var f=s("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;a.exports=c},{"../../../errors":15}],25:[function(s,a){a.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],26:[function(s,a){function o(B){var v=!1;return function(){v||(v=!0,B.apply(void 0,arguments))}}function l(B){if(B)throw B}function u(B){return B.setHeader&&typeof B.abort=="function"}function c(B,v,_,w){w=o(w);var I=!1;B.on("close",function(){I=!0}),g===void 0&&(g=s("./end-of-stream")),g(B,{readable:v,writable:_},function(M){return M?w(M):(I=!0,void w())});var k=!1;return function(M){if(!I)return k?void 0:(k=!0,u(B)?B.abort():typeof B.destroy=="function"?B.destroy():void w(M||new x("pipe")))}}function f(B){B()}function d(B,v){return B.pipe(v)}function p(B){return B.length&&typeof B[B.length-1]=="function"?B.pop():l}var g,m=s("../../../errors").codes,T=m.ERR_MISSING_ARGS,x=m.ERR_STREAM_DESTROYED;a.exports=function(){for(var B=arguments.length,v=Array(B),_=0;_<B;_++)v[_]=arguments[_];var w=p(v);if(Array.isArray(v[0])&&(v=v[0]),2>v.length)throw new T("streams");var I,k=v.map(function(M,K){var N=K<v.length-1;return c(M,N,0<K,function(U){I||(I=U),U&&k.forEach(f),N||(k.forEach(f),w(I))})});return v.reduce(d)}},{"../../../errors":15,"./end-of-stream":24}],27:[function(s,a){function o(u,c,f){return u.highWaterMark==null?c?u[f]:null:u.highWaterMark}var l=s("../../../errors").codes.ERR_INVALID_OPT_VALUE;a.exports={getHighWaterMark:function(u,c,f,d){var p=o(c,d,f);if(p!=null){if(!(isFinite(p)&&r(p)===p)||0>p){var g=d?f:"highWaterMark";throw new l(g,p)}return r(p)}return u.objectMode?16:16384}}},{"../../../errors":15}],28:[function(s,a){a.exports=s("events").EventEmitter},{events:7}],29:[function(s,a,o){o=a.exports=s("./lib/_stream_readable.js"),o.Stream=o,o.Readable=o,o.Writable=s("./lib/_stream_writable.js"),o.Duplex=s("./lib/_stream_duplex.js"),o.Transform=s("./lib/_stream_transform.js"),o.PassThrough=s("./lib/_stream_passthrough.js"),o.finished=s("./lib/internal/streams/end-of-stream.js"),o.pipeline=s("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":16,"./lib/_stream_passthrough.js":17,"./lib/_stream_readable.js":18,"./lib/_stream_transform.js":19,"./lib/_stream_writable.js":20,"./lib/internal/streams/end-of-stream.js":24,"./lib/internal/streams/pipeline.js":26}],30:[function(s,a,o){function l(d,p){for(var g in d)p[g]=d[g]}function u(d,p,g){return f(d,p,g)}/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var c=s("buffer"),f=c.Buffer;f.from&&f.alloc&&f.allocUnsafe&&f.allocUnsafeSlow?a.exports=c:(l(c,o),o.Buffer=u),u.prototype=Object.create(f.prototype),l(f,u),u.from=function(d,p,g){if(typeof d=="number")throw new TypeError("Argument must not be a number");return f(d,p,g)},u.alloc=function(d,p,g){if(typeof d!="number")throw new TypeError("Argument must be a number");var m=f(d);return p===void 0?m.fill(0):typeof g=="string"?m.fill(p,g):m.fill(p),m},u.allocUnsafe=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return f(d)},u.allocUnsafeSlow=function(d){if(typeof d!="number")throw new TypeError("Argument must be a number");return c.SlowBuffer(d)}},{buffer:3}],31:[function(s,a,o){function l(k){if(!k)return"utf8";for(var M;;)switch(k){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return k;default:if(M)return;k=(""+k).toLowerCase(),M=!0}}function u(k){var M=l(k);if(typeof M!="string"&&(w.isEncoding===I||!I(k)))throw new Error("Unknown encoding: "+k);return M||k}function c(k){this.encoding=u(k);var M;switch(this.encoding){case"utf16le":this.text=m,this.end=T,M=4;break;case"utf8":this.fillLast=g,M=4;break;case"base64":this.text=x,this.end=B,M=3;break;default:return this.write=v,void(this.end=_)}this.lastNeed=0,this.lastTotal=0,this.lastChar=w.allocUnsafe(M)}function f(k){return 127>=k?0:k>>5==6?2:k>>4==14?3:k>>3==30?4:k>>6==2?-1:-2}function d(k,M,K){var N=M.length-1;if(N<K)return 0;var U=f(M[N]);return 0<=U?(0<U&&(k.lastNeed=U-1),U):--N<K||U===-2?0:(U=f(M[N]),0<=U?(0<U&&(k.lastNeed=U-2),U):--N<K||U===-2?0:(U=f(M[N]),0<=U?(0<U&&(U===2?U=0:k.lastNeed=U-3),U):0))}function p(k,M){if((192&M[0])!=128)return k.lastNeed=0,"\uFFFD";if(1<k.lastNeed&&1<M.length){if((192&M[1])!=128)return k.lastNeed=1,"\uFFFD";if(2<k.lastNeed&&2<M.length&&(192&M[2])!=128)return k.lastNeed=2,"\uFFFD"}}function g(k){var M=this.lastTotal-this.lastNeed,K=p(this,k);return K===void 0?this.lastNeed<=k.length?(k.copy(this.lastChar,M,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(k.copy(this.lastChar,M,0,k.length),void(this.lastNeed-=k.length)):K}function m(k,M){if((k.length-M)%2==0){var K=k.toString("utf16le",M);if(K){var N=K.charCodeAt(K.length-1);if(55296<=N&&56319>=N)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=k[k.length-2],this.lastChar[1]=k[k.length-1],K.slice(0,-1)}return K}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=k[k.length-1],k.toString("utf16le",M,k.length-1)}function T(k){var M=k&&k.length?this.write(k):"";if(this.lastNeed){var K=this.lastTotal-this.lastNeed;return M+this.lastChar.toString("utf16le",0,K)}return M}function x(k,M){var K=(k.length-M)%3;return K==0?k.toString("base64",M):(this.lastNeed=3-K,this.lastTotal=3,K==1?this.lastChar[0]=k[k.length-1]:(this.lastChar[0]=k[k.length-2],this.lastChar[1]=k[k.length-1]),k.toString("base64",M,k.length-K))}function B(k){var M=k&&k.length?this.write(k):"";return this.lastNeed?M+this.lastChar.toString("base64",0,3-this.lastNeed):M}function v(k){return k.toString(this.encoding)}function _(k){return k&&k.length?this.write(k):""}var w=s("safe-buffer").Buffer,I=w.isEncoding||function(k){switch(k=""+k,k&&k.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};o.StringDecoder=c,c.prototype.write=function(k){if(k.length===0)return"";var M,K;if(this.lastNeed){if(M=this.fillLast(k),M===void 0)return"";K=this.lastNeed,this.lastNeed=0}else K=0;return K<k.length?M?M+this.text(k,K):this.text(k,K):M||""},c.prototype.end=function(k){var M=k&&k.length?this.write(k):"";return this.lastNeed?M+"\uFFFD":M},c.prototype.text=function(k,M){var K=d(this,k,M);if(!this.lastNeed)return k.toString("utf8",M);this.lastTotal=K;var N=k.length-(K-this.lastNeed);return k.copy(this.lastChar,0,N),k.toString("utf8",M,N)},c.prototype.fillLast=function(k){return this.lastNeed<=k.length?(k.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(k.copy(this.lastChar,this.lastTotal-this.lastNeed,0,k.length),void(this.lastNeed-=k.length))}},{"safe-buffer":30}],32:[function(s,a){(function(o){(function(){function l(u){try{if(!o.localStorage)return!1}catch{return!1}var c=o.localStorage[u];return c!=null&&(c+"").toLowerCase()==="true"}a.exports=function(u,c){function f(){if(!d){if(l("throwDeprecation"))throw new Error(c);l("traceDeprecation")?console.trace(c):console.warn(c),d=!0}return u.apply(this,arguments)}if(l("noDeprecation"))return u;var d=!1;return f}}).call(this)}).call(this,typeof er>"u"?typeof self>"u"?typeof window>"u"?{}:window:self:er)},{}],"/":[function(s,a){function o(B){return B.replace(/a=ice-options:trickle\s\n/g,"")}function l(B){console.warn(B)}/*! simple-peer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */const u=s("debug")("simple-peer"),c=s("get-browser-rtc"),f=s("randombytes"),d=s("readable-stream"),p=s("queue-microtask"),g=s("err-code"),{Buffer:m}=s("buffer"),T=65536;class x extends d.Duplex{constructor(v){if(v=Object.assign({allowHalfOpen:!1},v),super(v),this._id=f(4).toString("hex").slice(0,7),this._debug("new peer %o",v),this.channelName=v.initiator?v.channelName||f(20).toString("hex"):null,this.initiator=v.initiator||!1,this.channelConfig=v.channelConfig||x.channelConfig,this.channelNegotiated=this.channelConfig.negotiated,this.config=Object.assign({},x.config,v.config),this.offerOptions=v.offerOptions||{},this.answerOptions=v.answerOptions||{},this.sdpTransform=v.sdpTransform||(_=>_),this.streams=v.streams||(v.stream?[v.stream]:[]),this.trickle=v.trickle===void 0||v.trickle,this.allowHalfTrickle=v.allowHalfTrickle!==void 0&&v.allowHalfTrickle,this.iceCompleteTimeout=v.iceCompleteTimeout||5e3,this.destroyed=!1,this.destroying=!1,this._connected=!1,this.remoteAddress=void 0,this.remoteFamily=void 0,this.remotePort=void 0,this.localAddress=void 0,this.localFamily=void 0,this.localPort=void 0,this._wrtc=v.wrtc&&typeof v.wrtc=="object"?v.wrtc:c(),!this._wrtc)throw g(typeof window>"u"?new Error("No WebRTC support: Specify `opts.wrtc` option in this environment"):new Error("No WebRTC support: Not a supported browser"),"ERR_WEBRTC_SUPPORT");this._pcReady=!1,this._channelReady=!1,this._iceComplete=!1,this._iceCompleteTimer=null,this._channel=null,this._pendingCandidates=[],this._isNegotiating=!1,this._firstNegotiation=!0,this._batchedNegotiation=!1,this._queuedNegotiation=!1,this._sendersAwaitingStable=[],this._senderMap=new Map,this._closingInterval=null,this._remoteTracks=[],this._remoteStreams=[],this._chunk=null,this._cb=null,this._interval=null;try{this._pc=new this._wrtc.RTCPeerConnection(this.config)}catch(_){return void this.destroy(g(_,"ERR_PC_CONSTRUCTOR"))}this._isReactNativeWebrtc=typeof this._pc._peerConnectionId=="number",this._pc.oniceconnectionstatechange=()=>{this._onIceStateChange()},this._pc.onicegatheringstatechange=()=>{this._onIceStateChange()},this._pc.onconnectionstatechange=()=>{this._onConnectionStateChange()},this._pc.onsignalingstatechange=()=>{this._onSignalingStateChange()},this._pc.onicecandidate=_=>{this._onIceCandidate(_)},typeof this._pc.peerIdentity=="object"&&this._pc.peerIdentity.catch(_=>{this.destroy(g(_,"ERR_PC_PEER_IDENTITY"))}),this.initiator||this.channelNegotiated?this._setupData({channel:this._pc.createDataChannel(this.channelName,this.channelConfig)}):this._pc.ondatachannel=_=>{this._setupData(_)},this.streams&&this.streams.forEach(_=>{this.addStream(_)}),this._pc.ontrack=_=>{this._onTrack(_)},this._debug("initial negotiation"),this._needsNegotiation(),this._onFinishBound=()=>{this._onFinish()},this.once("finish",this._onFinishBound)}get bufferSize(){return this._channel&&this._channel.bufferedAmount||0}get connected(){return this._connected&&this._channel.readyState==="open"}address(){return{port:this.localPort,family:this.localFamily,address:this.localAddress}}signal(v){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot signal after peer is destroyed"),"ERR_DESTROYED");if(typeof v=="string")try{v=JSON.parse(v)}catch{v={}}this._debug("signal()"),v.renegotiate&&this.initiator&&(this._debug("got request to renegotiate"),this._needsNegotiation()),v.transceiverRequest&&this.initiator&&(this._debug("got request for transceiver"),this.addTransceiver(v.transceiverRequest.kind,v.transceiverRequest.init)),v.candidate&&(this._pc.remoteDescription&&this._pc.remoteDescription.type?this._addIceCandidate(v.candidate):this._pendingCandidates.push(v.candidate)),v.sdp&&this._pc.setRemoteDescription(new this._wrtc.RTCSessionDescription(v)).then(()=>{this.destroyed||(this._pendingCandidates.forEach(_=>{this._addIceCandidate(_)}),this._pendingCandidates=[],this._pc.remoteDescription.type==="offer"&&this._createAnswer())}).catch(_=>{this.destroy(g(_,"ERR_SET_REMOTE_DESCRIPTION"))}),v.sdp||v.candidate||v.renegotiate||v.transceiverRequest||this.destroy(g(new Error("signal() called with invalid signal data"),"ERR_SIGNALING"))}}_addIceCandidate(v){const _=new this._wrtc.RTCIceCandidate(v);this._pc.addIceCandidate(_).catch(w=>{!_.address||_.address.endsWith(".local")?l("Ignoring unsupported ICE candidate."):this.destroy(g(w,"ERR_ADD_ICE_CANDIDATE"))})}send(v){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot send after peer is destroyed"),"ERR_DESTROYED");this._channel.send(v)}}addTransceiver(v,_){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addTransceiver after peer is destroyed"),"ERR_DESTROYED");if(this._debug("addTransceiver()"),this.initiator)try{this._pc.addTransceiver(v,_),this._needsNegotiation()}catch(w){this.destroy(g(w,"ERR_ADD_TRANSCEIVER"))}else this.emit("signal",{type:"transceiverRequest",transceiverRequest:{kind:v,init:_}})}}addStream(v){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot addStream after peer is destroyed"),"ERR_DESTROYED");this._debug("addStream()"),v.getTracks().forEach(_=>{this.addTrack(_,v)})}}addTrack(v,_){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot addTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("addTrack()");const w=this._senderMap.get(v)||new Map;let I=w.get(_);if(!I)I=this._pc.addTrack(v,_),w.set(_,I),this._senderMap.set(v,w),this._needsNegotiation();else throw I.removed?g(new Error("Track has been removed. You should enable/disable tracks that you want to re-add."),"ERR_SENDER_REMOVED"):g(new Error("Track has already been added to that stream."),"ERR_SENDER_ALREADY_ADDED")}replaceTrack(v,_,w){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot replaceTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("replaceTrack()");const I=this._senderMap.get(v),k=I?I.get(w):null;if(!k)throw g(new Error("Cannot replace track that was never added."),"ERR_TRACK_NOT_ADDED");_&&this._senderMap.set(_,I),k.replaceTrack==null?this.destroy(g(new Error("replaceTrack is not supported in this browser"),"ERR_UNSUPPORTED_REPLACETRACK")):k.replaceTrack(_)}removeTrack(v,_){if(this.destroying)return;if(this.destroyed)throw g(new Error("cannot removeTrack after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSender()");const w=this._senderMap.get(v),I=w?w.get(_):null;if(!I)throw g(new Error("Cannot remove track that was never added."),"ERR_TRACK_NOT_ADDED");try{I.removed=!0,this._pc.removeTrack(I)}catch(k){k.name==="NS_ERROR_UNEXPECTED"?this._sendersAwaitingStable.push(I):this.destroy(g(k,"ERR_REMOVE_TRACK"))}this._needsNegotiation()}removeStream(v){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot removeStream after peer is destroyed"),"ERR_DESTROYED");this._debug("removeSenders()"),v.getTracks().forEach(_=>{this.removeTrack(_,v)})}}_needsNegotiation(){this._debug("_needsNegotiation"),this._batchedNegotiation||(this._batchedNegotiation=!0,p(()=>{this._batchedNegotiation=!1,this.initiator||!this._firstNegotiation?(this._debug("starting batched negotiation"),this.negotiate()):this._debug("non-initiator initial negotiation request discarded"),this._firstNegotiation=!1}))}negotiate(){if(!this.destroying){if(this.destroyed)throw g(new Error("cannot negotiate after peer is destroyed"),"ERR_DESTROYED");this.initiator?this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("start negotiation"),setTimeout(()=>{this._createOffer()},0)):this._isNegotiating?(this._queuedNegotiation=!0,this._debug("already negotiating, queueing")):(this._debug("requesting negotiation from initiator"),this.emit("signal",{type:"renegotiate",renegotiate:!0})),this._isNegotiating=!0}}destroy(v){this._destroy(v,()=>{})}_destroy(v,_){this.destroyed||this.destroying||(this.destroying=!0,this._debug("destroying (error: %s)",v&&(v.message||v)),p(()=>{if(this.destroyed=!0,this.destroying=!1,this._debug("destroy (error: %s)",v&&(v.message||v)),this.readable=this.writable=!1,this._readableState.ended||this.push(null),this._writableState.finished||this.end(),this._connected=!1,this._pcReady=!1,this._channelReady=!1,this._remoteTracks=null,this._remoteStreams=null,this._senderMap=null,clearInterval(this._closingInterval),this._closingInterval=null,clearInterval(this._interval),this._interval=null,this._chunk=null,this._cb=null,this._onFinishBound&&this.removeListener("finish",this._onFinishBound),this._onFinishBound=null,this._channel){try{this._channel.close()}catch{}this._channel.onmessage=null,this._channel.onopen=null,this._channel.onclose=null,this._channel.onerror=null}if(this._pc){try{this._pc.close()}catch{}this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ontrack=null,this._pc.ondatachannel=null}this._pc=null,this._channel=null,v&&this.emit("error",v),this.emit("close"),_()}))}_setupData(v){if(!v.channel)return this.destroy(g(new Error("Data channel event is missing `channel` property"),"ERR_DATA_CHANNEL"));this._channel=v.channel,this._channel.binaryType="arraybuffer",typeof this._channel.bufferedAmountLowThreshold=="number"&&(this._channel.bufferedAmountLowThreshold=T),this.channelName=this._channel.label,this._channel.onmessage=w=>{this._onChannelMessage(w)},this._channel.onbufferedamountlow=()=>{this._onChannelBufferedAmountLow()},this._channel.onopen=()=>{this._onChannelOpen()},this._channel.onclose=()=>{this._onChannelClose()},this._channel.onerror=w=>{const I=w.error instanceof Error?w.error:new Error(`Datachannel error: ${w.message} ${w.filename}:${w.lineno}:${w.colno}`);this.destroy(g(I,"ERR_DATA_CHANNEL"))};let _=!1;this._closingInterval=setInterval(()=>{this._channel&&this._channel.readyState==="closing"?(_&&this._onChannelClose(),_=!0):_=!1},5e3)}_read(){}_write(v,_,w){if(this.destroyed)return w(g(new Error("cannot write after peer is destroyed"),"ERR_DATA_CHANNEL"));if(this._connected){try{this.send(v)}catch(I){return this.destroy(g(I,"ERR_DATA_CHANNEL"))}this._channel.bufferedAmount>T?(this._debug("start backpressure: bufferedAmount %d",this._channel.bufferedAmount),this._cb=w):w(null)}else this._debug("write before connect"),this._chunk=v,this._cb=w}_onFinish(){if(!this.destroyed){const v=()=>{setTimeout(()=>this.destroy(),1e3)};this._connected?v():this.once("connect",v)}}_startIceCompleteTimeout(){this.destroyed||this._iceCompleteTimer||(this._debug("started iceComplete timeout"),this._iceCompleteTimer=setTimeout(()=>{this._iceComplete||(this._iceComplete=!0,this._debug("iceComplete timeout completed"),this.emit("iceTimeout"),this.emit("_iceComplete"))},this.iceCompleteTimeout))}_createOffer(){this.destroyed||this._pc.createOffer(this.offerOptions).then(v=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(v.sdp=o(v.sdp)),v.sdp=this.sdpTransform(v.sdp);const _=()=>{if(!this.destroyed){const w=this._pc.localDescription||v;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp})}};this._pc.setLocalDescription(v).then(()=>{this._debug("createOffer success"),this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(w=>{this.destroy(g(w,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(v=>{this.destroy(g(v,"ERR_CREATE_OFFER"))})}_requestMissingTransceivers(){this._pc.getTransceivers&&this._pc.getTransceivers().forEach(v=>{v.mid||!v.sender.track||v.requested||(v.requested=!0,this.addTransceiver(v.sender.track.kind))})}_createAnswer(){this.destroyed||this._pc.createAnswer(this.answerOptions).then(v=>{if(this.destroyed)return;this.trickle||this.allowHalfTrickle||(v.sdp=o(v.sdp)),v.sdp=this.sdpTransform(v.sdp);const _=()=>{if(!this.destroyed){const w=this._pc.localDescription||v;this._debug("signal"),this.emit("signal",{type:w.type,sdp:w.sdp}),this.initiator||this._requestMissingTransceivers()}};this._pc.setLocalDescription(v).then(()=>{this.destroyed||(this.trickle||this._iceComplete?_():this.once("_iceComplete",_))}).catch(w=>{this.destroy(g(w,"ERR_SET_LOCAL_DESCRIPTION"))})}).catch(v=>{this.destroy(g(v,"ERR_CREATE_ANSWER"))})}_onConnectionStateChange(){this.destroyed||this._pc.connectionState==="failed"&&this.destroy(g(new Error("Connection failed."),"ERR_CONNECTION_FAILURE"))}_onIceStateChange(){if(this.destroyed)return;const v=this._pc.iceConnectionState,_=this._pc.iceGatheringState;this._debug("iceStateChange (connection: %s) (gathering: %s)",v,_),this.emit("iceStateChange",v,_),(v==="connected"||v==="completed")&&(this._pcReady=!0,this._maybeReady()),v==="failed"&&this.destroy(g(new Error("Ice connection failed."),"ERR_ICE_CONNECTION_FAILURE")),v==="closed"&&this.destroy(g(new Error("Ice connection closed."),"ERR_ICE_CONNECTION_CLOSED"))}getStats(v){const _=w=>(Object.prototype.toString.call(w.values)==="[object Array]"&&w.values.forEach(I=>{Object.assign(w,I)}),w);this._pc.getStats.length===0||this._isReactNativeWebrtc?this._pc.getStats().then(w=>{const I=[];w.forEach(k=>{I.push(_(k))}),v(null,I)},w=>v(w)):0<this._pc.getStats.length?this._pc.getStats(w=>{if(this.destroyed)return;const I=[];w.result().forEach(k=>{const M={};k.names().forEach(K=>{M[K]=k.stat(K)}),M.id=k.id,M.type=k.type,M.timestamp=k.timestamp,I.push(_(M))}),v(null,I)},w=>v(w)):v(null,[])}_maybeReady(){if(this._debug("maybeReady pc %s channel %s",this._pcReady,this._channelReady),this._connected||this._connecting||!this._pcReady||!this._channelReady)return;this._connecting=!0;const v=()=>{this.destroyed||this.getStats((_,w)=>{if(this.destroyed)return;_&&(w=[]);const I={},k={},M={};let K=!1;w.forEach(U=>{(U.type==="remotecandidate"||U.type==="remote-candidate")&&(I[U.id]=U),(U.type==="localcandidate"||U.type==="local-candidate")&&(k[U.id]=U),(U.type==="candidatepair"||U.type==="candidate-pair")&&(M[U.id]=U)});const N=U=>{K=!0;let H=k[U.localCandidateId];H&&(H.ip||H.address)?(this.localAddress=H.ip||H.address,this.localPort=+H.port):H&&H.ipAddress?(this.localAddress=H.ipAddress,this.localPort=+H.portNumber):typeof U.googLocalAddress=="string"&&(H=U.googLocalAddress.split(":"),this.localAddress=H[0],this.localPort=+H[1]),this.localAddress&&(this.localFamily=this.localAddress.includes(":")?"IPv6":"IPv4");let $=I[U.remoteCandidateId];$&&($.ip||$.address)?(this.remoteAddress=$.ip||$.address,this.remotePort=+$.port):$&&$.ipAddress?(this.remoteAddress=$.ipAddress,this.remotePort=+$.portNumber):typeof U.googRemoteAddress=="string"&&($=U.googRemoteAddress.split(":"),this.remoteAddress=$[0],this.remotePort=+$[1]),this.remoteAddress&&(this.remoteFamily=this.remoteAddress.includes(":")?"IPv6":"IPv4"),this._debug("connect local: %s:%s remote: %s:%s",this.localAddress,this.localPort,this.remoteAddress,this.remotePort)};if(w.forEach(U=>{U.type==="transport"&&U.selectedCandidatePairId&&N(M[U.selectedCandidatePairId]),(U.type==="googCandidatePair"&&U.googActiveConnection==="true"||(U.type==="candidatepair"||U.type==="candidate-pair")&&U.selected)&&N(U)}),!K&&(!Object.keys(M).length||Object.keys(k).length))return void setTimeout(v,100);if(this._connecting=!1,this._connected=!0,this._chunk){try{this.send(this._chunk)}catch(H){return this.destroy(g(H,"ERR_DATA_CHANNEL"))}this._chunk=null,this._debug('sent chunk from "write before connect"');const U=this._cb;this._cb=null,U(null)}typeof this._channel.bufferedAmountLowThreshold!="number"&&(this._interval=setInterval(()=>this._onInterval(),150),this._interval.unref&&this._interval.unref()),this._debug("connect"),this.emit("connect")})};v()}_onInterval(){this._cb&&this._channel&&!(this._channel.bufferedAmount>T)&&this._onChannelBufferedAmountLow()}_onSignalingStateChange(){this.destroyed||(this._pc.signalingState==="stable"&&(this._isNegotiating=!1,this._debug("flushing sender queue",this._sendersAwaitingStable),this._sendersAwaitingStable.forEach(v=>{this._pc.removeTrack(v),this._queuedNegotiation=!0}),this._sendersAwaitingStable=[],this._queuedNegotiation?(this._debug("flushing negotiation queue"),this._queuedNegotiation=!1,this._needsNegotiation()):(this._debug("negotiated"),this.emit("negotiated"))),this._debug("signalingStateChange %s",this._pc.signalingState),this.emit("signalingStateChange",this._pc.signalingState))}_onIceCandidate(v){this.destroyed||(v.candidate&&this.trickle?this.emit("signal",{type:"candidate",candidate:{candidate:v.candidate.candidate,sdpMLineIndex:v.candidate.sdpMLineIndex,sdpMid:v.candidate.sdpMid}}):!v.candidate&&!this._iceComplete&&(this._iceComplete=!0,this.emit("_iceComplete")),v.candidate&&this._startIceCompleteTimeout())}_onChannelMessage(v){if(this.destroyed)return;let _=v.data;_ instanceof ArrayBuffer&&(_=m.from(_)),this.push(_)}_onChannelBufferedAmountLow(){if(!this.destroyed&&this._cb){this._debug("ending backpressure: bufferedAmount %d",this._channel.bufferedAmount);const v=this._cb;this._cb=null,v(null)}}_onChannelOpen(){this._connected||this.destroyed||(this._debug("on channel open"),this._channelReady=!0,this._maybeReady())}_onChannelClose(){this.destroyed||(this._debug("on channel close"),this.destroy())}_onTrack(v){this.destroyed||v.streams.forEach(_=>{this._debug("on track"),this.emit("track",v.track,_),this._remoteTracks.push({track:v.track,stream:_}),this._remoteStreams.some(w=>w.id===_.id)||(this._remoteStreams.push(_),p(()=>{this._debug("on stream"),this.emit("stream",_)}))})}_debug(){const v=[].slice.call(arguments);v[0]="["+this._id+"] "+v[0],u.apply(null,v)}}x.WEBRTC_SUPPORT=!!c(),x.config={iceServers:[{urls:["stun:stun.l.google.com:19302","stun:global.stun.twilio.com:3478"]}],sdpSemantics:"unified-plan"},x.channelConfig={},a.exports=x},{buffer:3,debug:4,"err-code":6,"get-browser-rtc":8,"queue-microtask":13,randombytes:14,"readable-stream":29}]},{},[])("/")})})(Lc);const mv=Lc.exports,xo=0,Ao=1,Dc=2,Uc=(e,t)=>{fe(e,xo);const r=im(t);ct(e,r)},Oc=(e,t,r)=>{fe(e,Ao),ct(e,em(t,r))},vv=(e,t,r)=>Oc(t,r,bt(e)),Mc=(e,t,r)=>{try{Yy(t,bt(e),r)}catch(n){console.error("Caught error while handling a Yjs update",n)}},Cv=(e,t)=>{fe(e,Dc),ct(e,t)},bv=Mc,Ev=(e,t,r,n)=>{const i=be(e);switch(i){case xo:vv(e,t,r);break;case Ao:Mc(e,r,n);break;case Dc:bv(e,r,n);break;default:throw new Error("Unknown message type")}return i},ca=3e4;class Sv extends Ls{constructor(t){super(),this.doc=t,this.clientID=t.clientID,this.states=new Map,this.meta=new Map,this._checkInterval=setInterval(()=>{const r=Nr();this.getLocalState()!==null&&ca/2<=r-this.meta.get(this.clientID).lastUpdated&&this.setLocalState(this.getLocalState());const n=[];this.meta.forEach((i,s)=>{s!==this.clientID&&ca<=r-i.lastUpdated&&this.states.has(s)&&n.push(s)}),n.length>0&&ka(this,n,"timeout")},yr(ca/10)),t.on("destroy",()=>{this.destroy()}),this.setLocalState({})}destroy(){this.emit("destroy",[this]),this.setLocalState(null),super.destroy(),clearInterval(this._checkInterval)}getLocalState(){return this.states.get(this.clientID)||null}setLocalState(t){const r=this.clientID,n=this.meta.get(r),i=n===void 0?0:n.clock+1,s=this.states.get(r);t===null?this.states.delete(r):this.states.set(r,t),this.meta.set(r,{clock:i,lastUpdated:Nr()});const a=[],o=[],l=[],u=[];t===null?u.push(r):s==null?t!=null&&a.push(r):(o.push(r),pi(s,t)||l.push(r)),(a.length>0||l.length>0||u.length>0)&&this.emit("change",[{added:a,updated:l,removed:u},"local"]),this.emit("update",[{added:a,updated:o,removed:u},"local"])}setLocalStateField(t,r){const n=this.getLocalState();n!==null&&this.setLocalState({...n,[t]:r})}getStates(){return this.states}}const ka=(e,t,r)=>{const n=[];for(let i=0;i<t.length;i++){const s=t[i];if(e.states.has(s)){if(e.states.delete(s),s===e.clientID){const a=e.meta.get(s);e.meta.set(s,{clock:a.clock+1,lastUpdated:Nr()})}n.push(s)}}n.length>0&&(e.emit("change",[{added:[],updated:[],removed:n},r]),e.emit("update",[{added:[],updated:[],removed:n},r]))},Cs=(e,t,r=e.states)=>{const n=t.length,i=St();fe(i,n);for(let s=0;s<n;s++){const a=t[s],o=r.get(a)||null,l=e.meta.get(a).clock;fe(i,a),fe(i,l),gr(i,JSON.stringify(o))}return at(i)},_v=(e,t,r)=>{const n=_r(t),i=Nr(),s=[],a=[],o=[],l=[],u=be(n);for(let c=0;c<u;c++){const f=be(n);let d=be(n);const p=JSON.parse(Br(n)),g=e.meta.get(f),m=e.states.get(f),T=g===void 0?0:g.clock;(T<d||T===d&&p===null&&e.states.has(f))&&(p===null?f===e.clientID&&e.getLocalState()!=null?d++:e.states.delete(f):e.states.set(f,p),e.meta.set(f,{clock:d,lastUpdated:i}),g===void 0&&p!==null?s.push(f):g!==void 0&&p===null?l.push(f):p!==null&&(pi(p,m)||o.push(f),a.push(f)))}(s.length>0||o.length>0||l.length>0)&&e.emit("change",[{added:s,updated:o,removed:l},r]),(s.length>0||a.length>0||l.length>0)&&e.emit("update",[{added:s,updated:a,removed:l},r])},wv=(e,t)=>{const r=ba(e).buffer,n=ba(t).buffer;return crypto.subtle.importKey("raw",r,"PBKDF2",!1,["deriveKey"]).then(i=>crypto.subtle.deriveKey({name:"PBKDF2",salt:n,iterations:1e5,hash:"SHA-256"},i,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]))},Pc=(e,t)=>{if(!t)return lo(e);const r=crypto.getRandomValues(new Uint8Array(12));return crypto.subtle.encrypt({name:"AES-GCM",iv:r},t,e).then(n=>{const i=St();return gr(i,"AES-GCM"),ct(i,r),ct(i,new Uint8Array(n)),at(i)})},Tv=(e,t)=>{const r=St();return Vn(r,e),Pc(at(r),t)},Fc=(e,t)=>{if(!t)return lo(e);const r=_r(e);Br(r)!=="AES-GCM"&&Ry(tn("Unknown encryption algorithm"));const i=bt(r),s=bt(r);return crypto.subtle.decrypt({name:"AES-GCM",iv:i},t,s).then(a=>new Uint8Array(a))},xv=(e,t)=>Fc(e,t).then(r=>Fn(_r(new Uint8Array(r)))),rr=Vy("y-webrtc"),Mn=0,Vc=3,xi=1,Io=4,bs=new Map,fn=new Map,Kc=e=>{let t=!0;e.webrtcConns.forEach(r=>{r.synced||(t=!1)}),(!t&&e.synced||t&&!e.synced)&&(e.synced=t,e.provider.emit("synced",[{synced:t}]),rr("synced ",$t,e.name,Yr," with all peers"))},Hc=(e,t,r)=>{const n=_r(t),i=St(),s=be(n);if(e===void 0)return null;const a=e.awareness,o=e.doc;let l=!1;switch(s){case Mn:{fe(i,Mn);const u=Ev(n,i,o,e);u===Ao&&!e.synced&&r(),u===xo&&(l=!0);break}case Vc:fe(i,xi),ct(i,Cs(a,Array.from(a.getStates().keys()))),l=!0;break;case xi:_v(a,bt(n),e);break;case Io:{const u=gn(n)===1,c=Br(n);if(c!==e.peerId&&(e.bcConns.has(c)&&!u||!e.bcConns.has(c)&&u)){const f=[],d=[];u?(e.bcConns.add(c),d.push(c)):(e.bcConns.delete(c),f.push(c)),e.provider.emit("peers",[{added:d,removed:f,webrtcPeers:Array.from(e.webrtcConns.keys()),bcPeers:Array.from(e.bcConns)}]),$c(e)}break}default:return console.error("Unable to compute message"),i}return l?i:null},Av=(e,t)=>{const r=e.room;return rr("received message from ",$t,e.remotePeerId,Ms," (",r.name,")",Yr,Bi),Hc(r,t,()=>{e.synced=!0,rr("synced ",$t,r.name,Yr," with ",$t,e.remotePeerId),Kc(r)})},fa=(e,t)=>{rr("send message to ",$t,e.remotePeerId,Yr,Ms," (",e.room.name,")",Bi);try{e.peer.send(at(t))}catch{}},Iv=(e,t)=>{rr("broadcast message in ",$t,e.name,Yr),e.webrtcConns.forEach(r=>{try{r.peer.send(t)}catch{}})};class Kl{constructor(t,r,n,i){rr("establishing connection to ",$t,n),this.room=i,this.remotePeerId=n,this.closed=!1,this.connected=!1,this.synced=!1,this.peer=new mv({initiator:r,...i.provider.peerOpts}),this.peer.on("signal",s=>{ko(t,i,{to:n,from:i.peerId,type:"signal",signal:s})}),this.peer.on("connect",()=>{rr("connected to ",$t,n),this.connected=!0;const a=i.provider.doc,o=i.awareness,l=St();fe(l,Mn),Uc(l,a),fa(this,l);const u=o.getStates();if(u.size>0){const c=St();fe(c,xi),ct(c,Cs(o,Array.from(u.keys()))),fa(this,c)}}),this.peer.on("close",()=>{this.connected=!1,this.closed=!0,i.webrtcConns.has(this.remotePeerId)&&(i.webrtcConns.delete(this.remotePeerId),i.provider.emit("peers",[{removed:[this.remotePeerId],added:[],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}])),Kc(i),this.peer.destroy(),rr("closed connection to ",$t,n),Ba(i)}),this.peer.on("error",s=>{rr("Error in connection to ",$t,n,": ",s),Ba(i)}),this.peer.on("data",s=>{const a=Av(this,s);a!==null&&fa(this,a)})}destroy(){this.peer.destroy()}}const Vr=(e,t)=>Pc(t,e.key).then(r=>e.mux(()=>dv(e.name,r))),Hl=(e,t)=>{e.bcconnected&&Vr(e,t),Iv(e,t)},Ba=e=>{bs.forEach(t=>{t.connected&&(t.send({type:"subscribe",topics:[e.name]}),e.webrtcConns.size<e.provider.maxConns&&ko(t,e,{type:"announce",from:e.peerId}))})},$c=e=>{if(e.provider.filterBcConns){const t=St();fe(t,Io),Ei(t,1),gr(t,e.peerId),Vr(e,at(t))}};class kv{constructor(t,r,n,i){this.peerId=Wu(),this.doc=t,this.awareness=r.awareness,this.provider=r,this.synced=!1,this.name=n,this.key=i,this.webrtcConns=new Map,this.bcConns=new Set,this.mux=pv(),this.bcconnected=!1,this._bcSubscriber=s=>Fc(new Uint8Array(s),i).then(a=>this.mux(()=>{const o=Hc(this,a,()=>{});o&&Vr(this,at(o))})),this._docUpdateHandler=(s,a)=>{const o=St();fe(o,Mn),Cv(o,s),Hl(this,at(o))},this._awarenessUpdateHandler=({added:s,updated:a,removed:o},l)=>{const u=s.concat(a).concat(o),c=St();fe(c,xi),ct(c,Cs(this.awareness,u)),Hl(this,at(c))},this._beforeUnloadHandler=()=>{ka(this.awareness,[t.clientID],"window unload"),fn.forEach(s=>{s.disconnect()})},typeof window<"u"?window.addEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.on("exit",this._beforeUnloadHandler)}connect(){this.doc.on("update",this._docUpdateHandler),this.awareness.on("update",this._awarenessUpdateHandler),Ba(this);const t=this.name;fv(t,this._bcSubscriber),this.bcconnected=!0,$c(this);const r=St();fe(r,Mn),Uc(r,this.doc),Vr(this,at(r));const n=St();fe(n,Mn),Oc(n,this.doc),Vr(this,at(n));const i=St();fe(i,Vc),Vr(this,at(i));const s=St();fe(s,xi),ct(s,Cs(this.awareness,[this.doc.clientID])),Vr(this,at(s))}disconnect(){bs.forEach(r=>{r.connected&&r.send({type:"unsubscribe",topics:[this.name]})}),ka(this.awareness,[this.doc.clientID],"disconnect");const t=St();fe(t,Io),Ei(t,0),gr(t,this.peerId),Vr(this,at(t)),hv(this.name,this._bcSubscriber),this.bcconnected=!1,this.doc.off("update",this._docUpdateHandler),this.awareness.off("update",this._awarenessUpdateHandler),this.webrtcConns.forEach(r=>r.destroy())}destroy(){this.disconnect(),typeof window<"u"?window.removeEventListener("beforeunload",this._beforeUnloadHandler):typeof process<"u"&&process.off("exit",this._beforeUnloadHandler)}}const Bv=(e,t,r,n)=>{if(fn.has(r))throw tn(`A Yjs Doc connected to room "${r}" already exists!`);const i=new kv(e,t,r,n);return fn.set(r,i),i},ko=(e,t,r)=>{t.key?Tv(r,t.key).then(n=>{e.send({type:"publish",topic:t.name,data:qu(n)})}):e.send({type:"publish",topic:t.name,data:r})};class Rv extends ov{constructor(t){super(t),this.providers=new Set,this.on("connect",()=>{rr(`connected (${t})`);const r=Array.from(fn.keys());this.send({type:"subscribe",topics:r}),fn.forEach(n=>ko(this,n,{type:"announce",from:n.peerId}))}),this.on("message",r=>{switch(r.type){case"publish":{const n=r.topic,i=fn.get(n);if(i==null||typeof n!="string")return;const s=a=>{const o=i.webrtcConns,l=i.peerId;if(a==null||a.from===l||a.to!==void 0&&a.to!==l||i.bcConns.has(a.from))return;const u=o.has(a.from)?()=>{}:()=>i.provider.emit("peers",[{removed:[],added:[a.from],webrtcPeers:Array.from(i.webrtcConns.keys()),bcPeers:Array.from(i.bcConns)}]);switch(a.type){case"announce":o.size<i.provider.maxConns&&(Zt(o,a.from,()=>new Kl(this,!0,a.from,i)),u());break;case"signal":a.to===l&&(Zt(o,a.from,()=>new Kl(this,!1,a.from,i)).peer.signal(a.signal),u());break}};i.key?typeof r.data=="string"&&xv(ju(r.data),i.key).then(s):s(r.data)}}}),this.on("disconnect",()=>rr(`disconnect (${t})`))}}class Nv extends Ls{constructor(t,r,{signaling:n=["wss://signaling.yjs.dev","wss://y-webrtc-signaling-eu.herokuapp.com","wss://y-webrtc-signaling-us.herokuapp.com"],password:i=null,awareness:s=new Sv(r),maxConns:a=20+yr(Iy()*15),filterBcConns:o=!0,peerOpts:l={}}={}){super(),this.roomName=t,this.doc=r,this.filterBcConns=o,this.awareness=s,this.shouldConnect=!1,this.signalingUrls=n,this.signalingConns=[],this.maxConns=a,this.peerOpts=l,this.key=i?wv(i,t):lo(null),this.room=null,this.key.then(u=>{this.room=Bv(r,this,t,u),this.shouldConnect?this.room.connect():this.room.disconnect()}),this.connect(),this.destroy=this.destroy.bind(this),r.on("destroy",this.destroy)}get connected(){return this.room!==null&&this.shouldConnect}connect(){this.shouldConnect=!0,this.signalingUrls.forEach(t=>{const r=Zt(bs,t,()=>new Rv(t));this.signalingConns.push(r),r.providers.add(this)}),this.room&&this.room.connect()}disconnect(){this.shouldConnect=!1,this.signalingConns.forEach(t=>{t.providers.delete(this),t.providers.size===0&&(t.destroy(),bs.delete(t.url))}),this.room&&this.room.disconnect()}destroy(){this.doc.off("destroy",this.destroy),this.key.then(()=>{this.room.destroy(),fn.delete(this.roomName)}),super.destroy()}}var Gc={exports:{}},we={options:{usePureJavaScript:!1}},Bo={},Lv=Bo,$l={};Bo.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=Dv(e,t);else{var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var l=0,u=e[i];l<o.length;++l)u+=o[l]<<8,o[l]=u%s,u=u/s|0;for(;u>0;)o.push(u%s),u=u/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var c=new RegExp(".{1,"+r+"}","g");n=n.match(c).join(`\r
`)}return n};Bo.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=$l[t];if(!r){r=$l[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),a=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var l=0,u=o;l<a.length;++l)u+=a[l]*i,a[l]=u&255,u>>=8;for(;u>0;)a.push(u&255),u>>=8}for(var c=0;e[c]===s&&c<e.length-1;++c)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function Dv(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var l="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)l+=i;for(r=s.length-1;r>=0;--r)l+=t[s[r]];return l}var Gl=we,ql=Lv,O=Gl.util=Gl.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){O.nextTick=process.nextTick,typeof setImmediate=="function"?O.setImmediate=setImmediate:O.setImmediate=O.nextTick;return}if(typeof setImmediate=="function"){O.setImmediate=function(){return setImmediate.apply(void 0,arguments)},O.nextTick=function(o){return setImmediate(o)};return}if(O.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(l){if(l.source===window&&l.data===e){l.stopPropagation();var u=t.slice();t.length=0,u.forEach(function(c){c()})}};var a=o,e="forge.setImmediate",t=[];O.setImmediate=function(l){t.push(l),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var l=t.slice();t.length=0,l.forEach(function(u){u()})}).observe(i,{attributes:!0});var s=O.setImmediate;O.setImmediate=function(l){Date.now()-r>15?(r=Date.now(),s(l)):(t.push(l),t.length===1&&i.setAttribute("a",n=!n))}}O.nextTick=O.setImmediate})();O.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;O.globalScope=function(){return O.isNodejs?er:typeof self>"u"?window:self}();O.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};O.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};O.isArrayBufferView=function(e){return e&&O.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Ui(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}O.ByteBuffer=Ro;function Ro(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(O.isArrayBuffer(e)||O.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof Ro||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}O.ByteStringBuffer=Ro;var Uv=4096;O.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>Uv&&(this.data.substr(0,1),this._constructedStringLength=0)};O.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};O.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};O.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};O.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};O.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};O.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(O.encodeUtf8(e))};O.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};O.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};O.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};O.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};O.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};O.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};O.ByteStringBuffer.prototype.putInt=function(e,t){Ui(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};O.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};O.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};O.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};O.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};O.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};O.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};O.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};O.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};O.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};O.ByteStringBuffer.prototype.getInt=function(e){Ui(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};O.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};O.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};O.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};O.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};O.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};O.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};O.ByteStringBuffer.prototype.copy=function(){var e=O.createBuffer(this.data);return e.read=this.read,e};O.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};O.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};O.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};O.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};O.ByteStringBuffer.prototype.toString=function(){return O.decodeUtf8(this.bytes())};function Ov(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=O.isArrayBuffer(e),n=O.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}O.DataBuffer=Ov;O.DataBuffer.prototype.length=function(){return this.write-this.read};O.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};O.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};O.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};O.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};O.DataBuffer.prototype.putBytes=function(e,t){if(O.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(O.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof O.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&O.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof O.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=O.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=O.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=O.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=O.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=O.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};O.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};O.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};O.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};O.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};O.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};O.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};O.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};O.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};O.DataBuffer.prototype.putInt=function(e,t){Ui(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};O.DataBuffer.prototype.putSignedInt=function(e,t){return Ui(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};O.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};O.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};O.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};O.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};O.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};O.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};O.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};O.DataBuffer.prototype.getInt=function(e){Ui(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};O.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};O.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};O.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};O.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};O.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};O.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};O.DataBuffer.prototype.copy=function(){return new O.DataBuffer(this)};O.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};O.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};O.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};O.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};O.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return O.binary.raw.encode(t);if(e==="hex")return O.binary.hex.encode(t);if(e==="base64")return O.binary.base64.encode(t);if(e==="utf8")return O.text.utf8.decode(t);if(e==="utf16")return O.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};O.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=O.encodeUtf8(e)),new O.ByteBuffer(e)};O.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};O.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};O.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};O.bytesToHex=function(e){return O.createBuffer(e).toHex()};O.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var Gr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",qr=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],qc="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";O.encode64=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),a=e.charCodeAt(o++),r+=Gr.charAt(i>>2),r+=Gr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Gr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Gr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};O.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,a=0;a<e.length;)r=qr[e.charCodeAt(a++)-43],n=qr[e.charCodeAt(a++)-43],i=qr[e.charCodeAt(a++)-43],s=qr[e.charCodeAt(a++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};O.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};O.decodeUtf8=function(e){return decodeURIComponent(escape(e))};O.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:ql.encode,decode:ql.decode}};O.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};O.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};O.binary.hex.encode=O.bytesToHex;O.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};O.binary.base64.encode=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.byteLength;)i=e[o++],s=e[o++],a=e[o++],r+=Gr.charAt(i>>2),r+=Gr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=Gr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":Gr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};O.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,l=0,u=r;l<e.length;)i=qr[e.charCodeAt(l++)-43],s=qr[e.charCodeAt(l++)-43],a=qr[e.charCodeAt(l++)-43],o=qr[e.charCodeAt(l++)-43],n[u++]=i<<2|s>>4,a!==64&&(n[u++]=(s&15)<<4|a>>2,o!==64&&(n[u++]=(a&3)<<6|o));return t?u-r:n.subarray(0,u)};O.binary.base58.encode=function(e,t){return O.binary.baseN.encode(e,qc,t)};O.binary.base58.decode=function(e,t){return O.binary.baseN.decode(e,qc,t)};O.text={utf8:{},utf16:{}};O.text.utf8.encode=function(e,t,r){e=O.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};O.text.utf8.decode=function(e){return O.decodeUtf8(String.fromCharCode.apply(null,e))};O.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n};O.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};O.deflate=function(e,t,r){if(t=O.decode64(e.deflate(O.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};O.inflate=function(e,t,r){var n=e.inflate(O.encode64(t)).rval;return n===null?null:O.decode64(n)};var No=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=O.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},Lo=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(O.decode64(r))),r},Mv=function(e,t,r,n){var i=Lo(e,t);i===null&&(i={}),i[r]=n,No(e,t,i)},Pv=function(e,t,r){var n=Lo(e,t);return n!==null&&(n=r in n?n[r]:null),n},Fv=function(e,t,r){var n=Lo(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),No(e,t,n)}},Vv=function(e,t){No(e,t,null)},$s=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(l){a=l}if(s)break}if(!s)throw a;return n};O.setItem=function(e,t,r,n,i){$s(Mv,arguments,i)};O.getItem=function(e,t,r,n){return $s(Pv,arguments,n)};O.removeItem=function(e,t,r,n){$s(Fv,arguments,n)};O.clearItems=function(e,t,r){$s(Vv,arguments,r)};O.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};O.format=function(e){for(var t=/%./g,r,n,i=0,s=[],a=0;r=t.exec(e);){n=e.substring(a,t.lastIndex-2),n.length>0&&s.push(n),a=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")};O.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=r===void 0?",":r,o=n===void 0?".":n,l=i<0?"-":"",u=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",c=u.length>3?u.length%3:0;return l+(c?u.substr(0,c)+o:"")+u.substr(c).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-u).toFixed(s).slice(2):"")};O.formatSize=function(e){return e>=1073741824?e=O.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=O.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=O.formatNumber(e/1024,0)+" KiB":e=O.formatNumber(e,0)+" bytes",e};O.bytesFromIP=function(e){return e.indexOf(".")!==-1?O.bytesFromIPv4(e):e.indexOf(":")!==-1?O.bytesFromIPv6(e):null};O.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=O.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};O.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(a){return a.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=O.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=O.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};O.bytesToIP=function(e){return e.length===4?O.bytesToIPv4(e):e.length===16?O.bytesToIPv6(e):null};O.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};O.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=O.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=t.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var l=r[n];l.end-l.start>0&&(t.splice(l.start,l.end-l.start+1,""),l.start===0&&t.unshift(""),l.end===7&&t.push(""))}return t.join(":")};O.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in O&&!e.update)return t(null,O.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return O.cores=navigator.hardwareConcurrency,t(null,O.cores);if(typeof Worker>"u")return O.cores=1,t(null,O.cores);if(typeof Blob>"u")return O.cores=2,t(null,O.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){var o=Date.now(),l=o+4;self.postMessage({st:o,et:l})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,l){if(o===0){var u=Math.floor(a.reduce(function(c,f){return c+f},0)/a.length);return O.cores=Math.max(1,u),URL.revokeObjectURL(r),t(null,O.cores)}i(l,function(c,f){a.push(s(l,f)),n(a,o-1,l)})}function i(a,o){for(var l=[],u=[],c=0;c<a;++c){var f=new Worker(r);f.addEventListener("message",function(d){if(u.push(d.data),u.length===a){for(var p=0;p<a;++p)l[p].terminate();o(null,u)}}),l.push(f)}for(var c=0;c<a;++c)l[c].postMessage(c)}function s(a,o){for(var l=[],u=0;u<a;++u)for(var c=o[u],f=l[u]=[],d=0;d<a;++d)if(u!==d){var p=o[d];(c.st>p.st&&c.st<p.et||p.st>c.st&&p.st<c.et)&&f.push(d)}return l.reduce(function(g,m){return Math.max(g,m.length)},0)}};var At=we;At.cipher=At.cipher||{};At.cipher.algorithms=At.cipher.algorithms||{};At.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=At.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};At.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=At.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new At.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};At.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),At.cipher.algorithms[e]=t};At.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in At.cipher.algorithms?At.cipher.algorithms[e]:null};var Do=At.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};Do.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=At.util.createBuffer(),this.output=e.output||At.util.createBuffer(),this.mode.start(t)};Do.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Do.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))};var wt=we;wt.cipher=wt.cipher||{};var ke=wt.cipher.modes=wt.cipher.modes||{};ke.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ke.ecb.prototype.start=function(e){};ke.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};ke.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};ke.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};ke.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};ke.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};ke.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=Gs(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};ke.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};ke.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};ke.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};ke.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};ke.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=wt.util.createBuffer(),this._partialBytes=0};ke.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Gs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ke.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ke.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ke.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=wt.util.createBuffer(),this._partialBytes=0};ke.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Gs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ke.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};ke.ofb.prototype.decrypt=ke.ofb.prototype.encrypt;ke.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=wt.util.createBuffer(),this._partialBytes=0};ke.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=Gs(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};ke.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}qs(this._inBlock)};ke.ctr.prototype.decrypt=ke.ctr.prototype.encrypt;ke.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=wt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};ke.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=wt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=wt.util.createBuffer(e.additionalData):r=wt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=wt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Ra(n*8)))}this._inBlock=this._j0.slice(0),qs(this._inBlock),this._partialBytes=0,r=wt.util.createBuffer(r),this._aDataLength=Ra(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};ke.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),qs(this._inBlock)};ke.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),qs(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};ke.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=wt.util.createBuffer();var n=this._aDataLength.concat(Ra(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};ke.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};ke.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};ke.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};ke.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};ke.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],l=a/n|0,u=(n-1-a%n)*t;o[l]=1<<t-1<<u,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s};ke.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],l=i[a];i[s+a]=[o[0]^l[0],o[1]^l[1],o[2]^l[2],o[3]^l[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var u=i[s^n];i[s]=[e[0]^u[0],e[1]^u[1],e[2]^u[2],e[3]^u[3]]}return i};function Gs(e,t){if(typeof e=="string"&&(e=wt.util.createBuffer(e)),wt.util.isArray(e)&&e.length>4){var r=e;e=wt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!wt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function qs(e){e[e.length-1]=e[e.length-1]+1&4294967295}function Ra(e){return[e/4294967296|0,e&4294967295]}var ze=we;ze.aes=ze.aes||{};ze.aes.startEncrypting=function(e,t,r,n){var i=js({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};ze.aes.createEncryptionCipher=function(e,t){return js({key:e,output:null,decrypt:!1,mode:t})};ze.aes.startDecrypting=function(e,t,r,n){var i=js({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};ze.aes.createDecryptionCipher=function(e,t){return js({key:e,output:null,decrypt:!0,mode:t})};ze.aes.Algorithm=function(e,t){Uo||zc();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return La(r._w,n,i,!1)},decrypt:function(n,i){return La(r._w,n,i,!0)}}}),r._init=!1};ze.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=ze.util.createBuffer(t);else if(ze.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=ze.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!ze.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!ze.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Wc(t,e.decrypt&&!a),this._init=!0}};ze.aes._expandKey=function(e,t){return Uo||zc(),Wc(e,t)};ze.aes._updateBlock=La;Zn("AES-ECB",ze.cipher.modes.ecb);Zn("AES-CBC",ze.cipher.modes.cbc);Zn("AES-CFB",ze.cipher.modes.cfb);Zn("AES-OFB",ze.cipher.modes.ofb);Zn("AES-CTR",ze.cipher.modes.ctr);Zn("AES-GCM",ze.cipher.modes.gcm);function Zn(e,t){var r=function(){return new ze.aes.Algorithm(e,t)};ze.cipher.registerAlgorithm(e,r)}var Uo=!1,In=4,Ut,Na,jc,un,nr;function zc(){Uo=!0,jc=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;Ut=new Array(256),Na=new Array(256),un=new Array(4),nr=new Array(4);for(var t=0;t<4;++t)un[t]=new Array(256),nr[t]=new Array(256);for(var r=0,n=0,i,s,a,o,l,u,c,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Ut[r]=o,Na[o]=r,l=e[o],i=e[r],s=e[i],a=e[s],u=l<<24^o<<16^o<<8^(o^l),c=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var f=0;f<4;++f)un[f][r]=u,nr[f][o]=c,u=u<<24|u>>>8,c=c<<24|c>>>8;r===0?r=n=1:(r=i^e[e[e[i^a]]],n^=e[e[n]])}}function Wc(e,t){for(var r=e.slice(0),n,i=1,s=r.length,a=s+6+1,o=In*a,l=s;l<o;++l)n=r[l-1],l%s===0?(n=Ut[n>>>16&255]<<24^Ut[n>>>8&255]<<16^Ut[n&255]<<8^Ut[n>>>24]^jc[i]<<24,i++):s>6&&l%s===4&&(n=Ut[n>>>24]<<24^Ut[n>>>16&255]<<16^Ut[n>>>8&255]<<8^Ut[n&255]),r[l]=r[l-s]^n;if(t){var u,c=nr[0],f=nr[1],d=nr[2],p=nr[3],g=r.slice(0);o=r.length;for(var l=0,m=o-In;l<o;l+=In,m-=In)if(l===0||l===o-In)g[l]=r[m],g[l+1]=r[m+3],g[l+2]=r[m+2],g[l+3]=r[m+1];else for(var T=0;T<In;++T)u=r[m+T],g[l+(3&-T)]=c[Ut[u>>>24]]^f[Ut[u>>>16&255]]^d[Ut[u>>>8&255]]^p[Ut[u&255]];r=g}return r}function La(e,t,r,n){var i=e.length/4-1,s,a,o,l,u;n?(s=nr[0],a=nr[1],o=nr[2],l=nr[3],u=Na):(s=un[0],a=un[1],o=un[2],l=un[3],u=Ut);var c,f,d,p,g,m,T;c=t[0]^e[0],f=t[n?3:1]^e[1],d=t[2]^e[2],p=t[n?1:3]^e[3];for(var x=3,B=1;B<i;++B)g=s[c>>>24]^a[f>>>16&255]^o[d>>>8&255]^l[p&255]^e[++x],m=s[f>>>24]^a[d>>>16&255]^o[p>>>8&255]^l[c&255]^e[++x],T=s[d>>>24]^a[p>>>16&255]^o[c>>>8&255]^l[f&255]^e[++x],p=s[p>>>24]^a[c>>>16&255]^o[f>>>8&255]^l[d&255]^e[++x],c=g,f=m,d=T;r[0]=u[c>>>24]<<24^u[f>>>16&255]<<16^u[d>>>8&255]<<8^u[p&255]^e[++x],r[n?3:1]=u[f>>>24]<<24^u[d>>>16&255]<<16^u[p>>>8&255]<<8^u[c&255]^e[++x],r[2]=u[d>>>24]<<24^u[p>>>16&255]<<16^u[c>>>8&255]<<8^u[f&255]^e[++x],r[n?1:3]=u[p>>>24]<<24^u[c>>>16&255]<<16^u[f>>>8&255]<<8^u[d&255]^e[++x]}function js(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=ze.cipher.createDecipher(r,e.key):n=ze.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof ze.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}var gi=we;gi.pki=gi.pki||{};var Da=gi.pki.oids=gi.oids=gi.oids||{};function Q(e,t){Da[e]=t,Da[t]=e}function Pe(e,t){Da[e]=t}Q("1.2.840.113549.1.1.1","rsaEncryption");Q("1.2.840.113549.1.1.4","md5WithRSAEncryption");Q("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Q("1.2.840.113549.1.1.7","RSAES-OAEP");Q("1.2.840.113549.1.1.8","mgf1");Q("1.2.840.113549.1.1.9","pSpecified");Q("1.2.840.113549.1.1.10","RSASSA-PSS");Q("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Q("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Q("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Q("1.3.101.112","EdDSA25519");Q("1.2.840.10040.4.3","dsa-with-sha1");Q("1.3.14.3.2.7","desCBC");Q("1.3.14.3.2.26","sha1");Q("1.3.14.3.2.29","sha1WithRSASignature");Q("2.16.840.1.101.3.4.2.1","sha256");Q("2.16.840.1.101.3.4.2.2","sha384");Q("2.16.840.1.101.3.4.2.3","sha512");Q("2.16.840.1.101.3.4.2.4","sha224");Q("2.16.840.1.101.3.4.2.5","sha512-224");Q("2.16.840.1.101.3.4.2.6","sha512-256");Q("1.2.840.113549.2.2","md2");Q("1.2.840.113549.2.5","md5");Q("1.2.840.113549.1.7.1","data");Q("1.2.840.113549.1.7.2","signedData");Q("1.2.840.113549.1.7.3","envelopedData");Q("1.2.840.113549.1.7.4","signedAndEnvelopedData");Q("1.2.840.113549.1.7.5","digestedData");Q("1.2.840.113549.1.7.6","encryptedData");Q("1.2.840.113549.1.9.1","emailAddress");Q("1.2.840.113549.1.9.2","unstructuredName");Q("1.2.840.113549.1.9.3","contentType");Q("1.2.840.113549.1.9.4","messageDigest");Q("1.2.840.113549.1.9.5","signingTime");Q("1.2.840.113549.1.9.6","counterSignature");Q("1.2.840.113549.1.9.7","challengePassword");Q("1.2.840.113549.1.9.8","unstructuredAddress");Q("1.2.840.113549.1.9.14","extensionRequest");Q("1.2.840.113549.1.9.20","friendlyName");Q("1.2.840.113549.1.9.21","localKeyId");Q("1.2.840.113549.1.9.22.1","x509Certificate");Q("1.2.840.113549.1.12.10.1.1","keyBag");Q("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Q("1.2.840.113549.1.12.10.1.3","certBag");Q("1.2.840.113549.1.12.10.1.4","crlBag");Q("1.2.840.113549.1.12.10.1.5","secretBag");Q("1.2.840.113549.1.12.10.1.6","safeContentsBag");Q("1.2.840.113549.1.5.13","pkcs5PBES2");Q("1.2.840.113549.1.5.12","pkcs5PBKDF2");Q("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Q("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Q("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Q("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Q("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Q("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Q("1.2.840.113549.2.7","hmacWithSHA1");Q("1.2.840.113549.2.8","hmacWithSHA224");Q("1.2.840.113549.2.9","hmacWithSHA256");Q("1.2.840.113549.2.10","hmacWithSHA384");Q("1.2.840.113549.2.11","hmacWithSHA512");Q("1.2.840.113549.3.7","des-EDE3-CBC");Q("2.16.840.1.101.3.4.1.2","aes128-CBC");Q("2.16.840.1.101.3.4.1.22","aes192-CBC");Q("2.16.840.1.101.3.4.1.42","aes256-CBC");Q("2.5.4.3","commonName");Q("2.5.4.4","surname");Q("2.5.4.5","serialNumber");Q("2.5.4.6","countryName");Q("2.5.4.7","localityName");Q("2.5.4.8","stateOrProvinceName");Q("2.5.4.9","streetAddress");Q("2.5.4.10","organizationName");Q("2.5.4.11","organizationalUnitName");Q("2.5.4.12","title");Q("2.5.4.13","description");Q("2.5.4.15","businessCategory");Q("2.5.4.17","postalCode");Q("2.5.4.42","givenName");Q("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Q("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Q("2.16.840.1.113730.1.1","nsCertType");Q("2.16.840.1.113730.1.13","nsComment");Pe("2.5.29.1","authorityKeyIdentifier");Pe("2.5.29.2","keyAttributes");Pe("2.5.29.3","certificatePolicies");Pe("2.5.29.4","keyUsageRestriction");Pe("2.5.29.5","policyMapping");Pe("2.5.29.6","subtreesConstraint");Pe("2.5.29.7","subjectAltName");Pe("2.5.29.8","issuerAltName");Pe("2.5.29.9","subjectDirectoryAttributes");Pe("2.5.29.10","basicConstraints");Pe("2.5.29.11","nameConstraints");Pe("2.5.29.12","policyConstraints");Pe("2.5.29.13","basicConstraints");Q("2.5.29.14","subjectKeyIdentifier");Q("2.5.29.15","keyUsage");Pe("2.5.29.16","privateKeyUsagePeriod");Q("2.5.29.17","subjectAltName");Q("2.5.29.18","issuerAltName");Q("2.5.29.19","basicConstraints");Pe("2.5.29.20","cRLNumber");Pe("2.5.29.21","cRLReason");Pe("2.5.29.22","expirationDate");Pe("2.5.29.23","instructionCode");Pe("2.5.29.24","invalidityDate");Pe("2.5.29.25","cRLDistributionPoints");Pe("2.5.29.26","issuingDistributionPoint");Pe("2.5.29.27","deltaCRLIndicator");Pe("2.5.29.28","issuingDistributionPoint");Pe("2.5.29.29","certificateIssuer");Pe("2.5.29.30","nameConstraints");Q("2.5.29.31","cRLDistributionPoints");Q("2.5.29.32","certificatePolicies");Pe("2.5.29.33","policyMappings");Pe("2.5.29.34","policyConstraints");Q("2.5.29.35","authorityKeyIdentifier");Pe("2.5.29.36","policyConstraints");Q("2.5.29.37","extKeyUsage");Pe("2.5.29.46","freshestCRL");Pe("2.5.29.54","inhibitAnyPolicy");Q("1.3.6.1.4.1.11129.2.4.2","timestampList");Q("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Q("1.3.6.1.5.5.7.3.1","serverAuth");Q("1.3.6.1.5.5.7.3.2","clientAuth");Q("1.3.6.1.5.5.7.3.3","codeSigning");Q("1.3.6.1.5.5.7.3.4","emailProtection");Q("1.3.6.1.5.5.7.3.8","timeStamping");var Ye=we,te=Ye.asn1=Ye.asn1||{};te.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};te.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};te.create=function(e,t,r,n,i){if(Ye.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:e,type:t,constructed:r,composed:r||Ye.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=te.copy(o)),o};te.copy=function(e,t){var r;if(Ye.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(te.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:te.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};te.equals=function(e,t,r){if(Ye.util.isArray(e)){if(!Ye.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!te.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&te.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};te.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function ci(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var Kv=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;ci(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};te.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=Ye.util.createBuffer(e));var r=e.length(),n=Zi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Zi(e,t,r,n){var i;ci(e,t,2);var s=e.getByte();t--;var a=s&192,o=s&31;i=e.length();var l=Kv(e,t);if(t-=i-e.length(),l!==void 0&&l>t){if(n.strict){var u=new Error("Too few bytes to read ASN.1 value.");throw u.available=e.length(),u.remaining=t,u.requested=l,u}l=t}var c,f,d=(s&32)===32;if(d)if(c=[],l===void 0)for(;;){if(ci(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),c.push(Zi(e,t,r+1,n)),t-=i-e.length()}else for(;l>0;)i=e.length(),c.push(Zi(e,l,r+1,n)),t-=i-e.length(),l-=i-e.length();if(c===void 0&&a===te.Class.UNIVERSAL&&o===te.Type.BITSTRING&&(f=e.bytes(l)),c===void 0&&n.decodeBitStrings&&a===te.Class.UNIVERSAL&&o===te.Type.BITSTRING&&l>1){var p=e.read,g=t,m=0;if(o===te.Type.BITSTRING&&(ci(e,t,1),m=e.getByte(),t--),m===0)try{i=e.length();var T={strict:!0,decodeBitStrings:!0},x=Zi(e,t,r+1,T),B=i-e.length();t-=B,o==te.Type.BITSTRING&&B++;var v=x.tagClass;B===l&&(v===te.Class.UNIVERSAL||v===te.Class.CONTEXT_SPECIFIC)&&(c=[x])}catch{}c===void 0&&(e.read=p,t=g)}if(c===void 0){if(l===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");l=t}if(o===te.Type.BMPSTRING)for(c="";l>0;l-=2)ci(e,t,2),c+=String.fromCharCode(e.getInt16()),t-=2;else c=e.getBytes(l),t-=l}var _=f===void 0?null:{bitStringContents:f};return te.create(a,o,d,c,_)}te.toDer=function(e){var t=Ye.util.createBuffer(),r=e.tagClass|e.type,n=Ye.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=te.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(te.toDer(e.value[s]))}else if(e.type===te.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===te.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&(e.value.charCodeAt(1)&128)===0||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);t.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)t.putByte(o.charCodeAt(s))}return t.putBuffer(n),t};te.oidToDer=function(e){var t=e.split("."),r=Ye.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,a,o=2;o<t.length;++o){n=!0,i=[],s=parseInt(t[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var l=i.length-1;l>=0;--l)r.putByte(i[l])}return r};te.derToOid=function(e){var t;typeof e=="string"&&(e=Ye.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};te.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var l=e.charAt(10),u=10;l!=="+"&&l!=="-"&&(o=parseInt(e.substr(10,2),10),u+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),u&&(l=e.charAt(u),l==="+"||l==="-")){var c=parseInt(e.substr(u+1,2),10),f=parseInt(e.substr(u+4,2),10),d=c*60+f;d*=6e4,l==="+"?t.setTime(+t-d):t.setTime(+t+d)}return t};te.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),l=0,u=0,c=!1;e.charAt(e.length-1)==="Z"&&(c=!0);var f=e.length-5,d=e.charAt(f);if(d==="+"||d==="-"){var p=parseInt(e.substr(f+1,2),10),g=parseInt(e.substr(f+4,2),10);u=p*60+g,u*=6e4,d==="+"&&(u*=-1),c=!0}return e.charAt(14)==="."&&(l=parseFloat(e.substr(14),10)*1e3),c?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,l),t.setTime(+t+u)):(t.setFullYear(r,n,i),t.setHours(s,a,o,l)),t};te.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};te.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};te.integerToDer=function(e){var t=Ye.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};te.derToInteger=function(e){typeof e=="string"&&(e=Ye.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};te.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&Ye.util.isArray(t.value))for(var s=0,a=0;i&&a<t.value.length;++a)i=t.value[a].optional||!1,e.value[s]&&(i=te.validate(e.value[s],t.value[a],r,n),i?++s:t.value[a].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e))if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var o=e.bitStringContents.charCodeAt(0);if(o!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var jl=/[^\\u0000-\\u00ff]/;te.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case te.Class.UNIVERSAL:n+="Universal:";break;case te.Class.APPLICATION:n+="Application:";break;case te.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case te.Class.PRIVATE:n+="Private:";break}if(e.tagClass===te.Class.UNIVERSAL)switch(n+=e.type,e.type){case te.Type.NONE:n+=" (None)";break;case te.Type.BOOLEAN:n+=" (Boolean)";break;case te.Type.INTEGER:n+=" (Integer)";break;case te.Type.BITSTRING:n+=" (Bit string)";break;case te.Type.OCTETSTRING:n+=" (Octet string)";break;case te.Type.NULL:n+=" (Null)";break;case te.Type.OID:n+=" (Object Identifier)";break;case te.Type.ODESC:n+=" (Object Descriptor)";break;case te.Type.EXTERNAL:n+=" (External or Instance of)";break;case te.Type.REAL:n+=" (Real)";break;case te.Type.ENUMERATED:n+=" (Enumerated)";break;case te.Type.EMBEDDED:n+=" (Embedded PDV)";break;case te.Type.UTF8:n+=" (UTF8)";break;case te.Type.ROID:n+=" (Relative Object Identifier)";break;case te.Type.SEQUENCE:n+=" (Sequence)";break;case te.Type.SET:n+=" (Set)";break;case te.Type.PRINTABLESTRING:n+=" (Printable String)";break;case te.Type.IA5String:n+=" (IA5String (ASCII))";break;case te.Type.UTCTIME:n+=" (UTC time)";break;case te.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case te.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var a=0,o="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(a+=1,o+=te.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",e.type===te.Type.OID){var l=te.derToOid(e.value);n+=l,Ye.pki&&Ye.pki.oids&&l in Ye.pki.oids&&(n+=" ("+Ye.pki.oids[l]+") ")}if(e.type===te.Type.INTEGER)try{n+=te.derToInteger(e.value)}catch{n+="0x"+Ye.util.bytesToHex(e.value)}else if(e.type===te.Type.BITSTRING){if(e.value.length>1?n+="0x"+Ye.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var u=e.value.charCodeAt(0);u==1?n+=" (1 unused bit shown)":u>1&&(n+=" ("+u+" unused bits shown)")}}else if(e.type===te.Type.OCTETSTRING)jl.test(e.value)||(n+="("+e.value+") "),n+="0x"+Ye.util.bytesToHex(e.value);else if(e.type===te.Type.UTF8)try{n+=Ye.util.decodeUtf8(e.value)}catch(c){if(c.message==="URI malformed")n+="0x"+Ye.util.bytesToHex(e.value)+" (malformed UTF8)";else throw c}else e.type===te.Type.PRINTABLESTRING||e.type===te.Type.IA5String?n+=e.value:jl.test(e.value)?n+="0x"+Ye.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n};var Es=we,Hv=Es.md=Es.md||{};Es.md.algorithms=Es.md.algorithms||{};var Ar=we,$v=Ar.hmac=Ar.hmac||{};$v.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ar.md.algorithms)t=Ar.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(a===null)a=e;else{if(typeof a=="string")a=Ar.util.createBuffer(a);else if(Ar.util.isArray(a)){var o=a;a=Ar.util.createBuffer();for(var l=0;l<o.length;++l)a.putByte(o[l])}var u=a.length();u>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=Ar.util.createBuffer(),n=Ar.util.createBuffer(),u=a.length();for(var l=0;l<u;++l){var o=a.at(l);r.putByte(54^o),n.putByte(92^o)}if(u<t.blockLength)for(var o=t.blockLength-u,l=0;l<o;++l)r.putByte(54),n.putByte(92);e=a,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i};var lr=we,Qc=lr.md5=lr.md5||{};lr.md.md5=lr.md.algorithms.md5=Qc;Qc.create=function(){Jc||Gv();var e=null,t=lr.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=lr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=lr.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),zl(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=lr.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Ua.substr(0,n.blockLength-a));for(var o,l=0,u=n.fullMessageLength.length-1;u>=0;--u)o=n.fullMessageLength[u]*8+l,l=o/4294967296>>>0,i.putInt32Le(o>>>0);var c={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3};zl(c,r,i);var f=lr.util.createBuffer();return f.putInt32Le(c.h0),f.putInt32Le(c.h1),f.putInt32Le(c.h2),f.putInt32Le(c.h3),f},n};var Ua=null,es=null,fi=null,Rn=null,Jc=!1;function Gv(){Ua=String.fromCharCode(128),Ua+=lr.util.fillString(String.fromCharCode(0),64),es=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],fi=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],Rn=new Array(64);for(var e=0;e<64;++e)Rn[e]=Math.floor(Math.abs(Math.sin(e+1))*4294967296);Jc=!0}function zl(e,t,r){for(var n,i,s,a,o,l,u,c,f=r.length();f>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,c=0;c<16;++c)t[c]=r.getInt32Le(),l=o^s&(a^o),n=i+l+Rn[c]+t[c],u=fi[c],i=o,o=a,a=s,s+=n<<u|n>>>32-u;for(;c<32;++c)l=a^o&(s^a),n=i+l+Rn[c]+t[es[c]],u=fi[c],i=o,o=a,a=s,s+=n<<u|n>>>32-u;for(;c<48;++c)l=s^a^o,n=i+l+Rn[c]+t[es[c]],u=fi[c],i=o,o=a,a=s,s+=n<<u|n>>>32-u;for(;c<64;++c)l=a^(s|~o),n=i+l+Rn[c]+t[es[c]],u=fi[c],i=o,o=a,a=s,s+=n<<u|n>>>32-u;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,f-=64}}var Ss=we,Yc=Ss.pem=Ss.pem||{};Yc.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=$i(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=$i(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=$i(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=$i(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Ss.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Yc.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Ss.util.decode64(s[3])};if(t.push(o),!!s[2]){for(var l=s[2].split(i),u=0;s&&u<l.length;){for(var c=l[u].replace(/\s+$/,""),f=u+1;f<l.length;++f){var d=l[f];if(!/\s/.test(d[0]))break;c+=d,u=f}if(s=c.match(n),s){for(var p={name:s[1],values:[]},g=s[2].split(","),m=0;m<g.length;++m)p.values.push(qv(g[m]));if(o.procType)if(!o.contentDomain&&p.name==="Content-Domain")o.contentDomain=g[0]||"";else if(!o.dekInfo&&p.name==="DEK-Info"){if(p.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:g[0],parameters:g[1]||null}}else o.headers.push(p);else{if(p.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(p.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:g[0],type:g[1]}}}++u}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function $i(e){for(var t=e.name+": ",r=[],n=function(l,u){return" "+u},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<t.length;++i,++s)if(s>65&&a!==-1){var o=t[a];o===","?(++a,t=t.substr(0,a)+`\r
 `+t.substr(a)):t=t.substr(0,a)+`\r
`+o+t.substr(a+1),s=i-a-1,a=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(a=i);return t}function qv(e){return e.replace(/^\s+/,"")}var st=we;st.des=st.des||{};st.des.startEncrypting=function(e,t,r,n){var i=zs({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};st.des.createEncryptionCipher=function(e,t){return zs({key:e,output:null,decrypt:!1,mode:t})};st.des.startDecrypting=function(e,t,r,n){var i=zs({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};st.des.createDecryptionCipher=function(e,t){return zs({key:e,output:null,decrypt:!0,mode:t})};st.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Wl(r._keys,n,i,!1)},decrypt:function(n,i){return Wl(r._keys,n,i,!0)}}}),r._init=!1};st.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=st.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=e1(t),this._init=!0}};wr("DES-ECB",st.cipher.modes.ecb);wr("DES-CBC",st.cipher.modes.cbc);wr("DES-CFB",st.cipher.modes.cfb);wr("DES-OFB",st.cipher.modes.ofb);wr("DES-CTR",st.cipher.modes.ctr);wr("3DES-ECB",st.cipher.modes.ecb);wr("3DES-CBC",st.cipher.modes.cbc);wr("3DES-CFB",st.cipher.modes.cfb);wr("3DES-OFB",st.cipher.modes.ofb);wr("3DES-CTR",st.cipher.modes.ctr);function wr(e,t){var r=function(){return new st.des.Algorithm(e,t)};st.cipher.registerAlgorithm(e,r)}var jv=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],zv=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Wv=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],Qv=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],Jv=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Yv=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Xv=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Zv=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function e1(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],l=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],u=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],c=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],f=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],d=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],p=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],g=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],m=e.length()>8?3:1,T=[],x=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],B=0,v,_=0;_<m;_++){var w=e.getInt32(),I=e.getInt32();v=(w>>>4^I)&252645135,I^=v,w^=v<<4,v=(I>>>-16^w)&65535,w^=v,I^=v<<-16,v=(w>>>2^I)&858993459,I^=v,w^=v<<2,v=(I>>>-16^w)&65535,w^=v,I^=v<<-16,v=(w>>>1^I)&1431655765,I^=v,w^=v<<1,v=(I>>>8^w)&16711935,w^=v,I^=v<<8,v=(w>>>1^I)&1431655765,I^=v,w^=v<<1,v=w<<8|I>>>20&240,w=I<<24|I<<8&16711680|I>>>8&65280|I>>>24&240,I=v;for(var k=0;k<x.length;++k){x[k]?(w=w<<2|w>>>26,I=I<<2|I>>>26):(w=w<<1|w>>>27,I=I<<1|I>>>27),w&=-15,I&=-15;var M=t[w>>>28]|r[w>>>24&15]|n[w>>>20&15]|i[w>>>16&15]|s[w>>>12&15]|a[w>>>8&15]|o[w>>>4&15],K=l[I>>>28]|u[I>>>24&15]|c[I>>>20&15]|f[I>>>16&15]|d[I>>>12&15]|p[I>>>8&15]|g[I>>>4&15];v=(K>>>16^M)&65535,T[B++]=M^v,T[B++]=K^v<<16}}return T}function Wl(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=t[0],l=t[1];a=(o>>>4^l)&252645135,l^=a,o^=a<<4,a=(o>>>16^l)&65535,l^=a,o^=a<<16,a=(l>>>2^o)&858993459,o^=a,l^=a<<2,a=(l>>>8^o)&16711935,o^=a,l^=a<<8,a=(o>>>1^l)&1431655765,l^=a,o^=a<<1,o=o<<1|o>>>31,l=l<<1|l>>>31;for(var u=0;u<i;u+=3){for(var c=s[u+1],f=s[u+2],d=s[u];d!=c;d+=f){var p=l^e[d],g=(l>>>4|l<<28)^e[d+1];a=o,o=l,l=a^(zv[p>>>24&63]|Qv[p>>>16&63]|Yv[p>>>8&63]|Zv[p&63]|jv[g>>>24&63]|Wv[g>>>16&63]|Jv[g>>>8&63]|Xv[g&63])}a=o,o=l,l=a}o=o>>>1|o<<31,l=l>>>1|l<<31,a=(o>>>1^l)&1431655765,l^=a,o^=a<<1,a=(l>>>8^o)&16711935,o^=a,l^=a<<8,a=(l>>>2^o)&858993459,o^=a,l^=a<<2,a=(o>>>16^l)&65535,l^=a,o^=a<<16,a=(o>>>4^l)&252645135,l^=a,o^=a<<4,r[0]=o,r[1]=l}function zs(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=st.cipher.createDecipher(r,e.key):n=st.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof st.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}const t1={},r1=Object.freeze(Object.defineProperty({__proto__:null,default:t1},Symbol.toStringTag,{value:"Module"})),Oo=yv(r1);var Ot=we,n1=Ot.pkcs5=Ot.pkcs5||{},xr;Ot.util.isNodejs&&!Ot.options.usePureJavaScript&&(xr=Oo);Ot.pbkdf2=n1.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),Ot.util.isNodejs&&!Ot.options.usePureJavaScript&&xr.pbkdf2&&(i===null||typeof i!="object")&&(xr.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?xr.pbkdf2Sync.length===4?xr.pbkdf2(e,t,r,n,function(v,_){if(v)return s(v);s(null,_.toString("binary"))}):xr.pbkdf2(e,t,r,n,i,function(v,_){if(v)return s(v);s(null,_.toString("binary"))}):xr.pbkdf2Sync.length===4?xr.pbkdf2Sync(e,t,r,n).toString("binary"):xr.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in Ot.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=Ot.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var l=Math.ceil(n/a),u=n-(l-1)*a,c=Ot.hmac.create();c.start(i,e);var f="",d,p,g;if(!s){for(var m=1;m<=l;++m){c.start(null,null),c.update(t),c.update(Ot.util.int32ToBytes(m)),d=g=c.digest().getBytes();for(var T=2;T<=r;++T)c.start(null,null),c.update(g),p=c.digest().getBytes(),d=Ot.util.xorBytes(d,p,a),g=p;f+=m<l?d:d.substr(0,u)}return f}var m=1,T;function x(){if(m>l)return s(null,f);c.start(null,null),c.update(t),c.update(Ot.util.int32ToBytes(m)),d=g=c.digest().getBytes(),T=2,B()}function B(){if(T<=r)return c.start(null,null),c.update(g),p=c.digest().getBytes(),d=Ot.util.xorBytes(d,p,a),g=p,++T,Ot.util.setImmediate(B);f+=m<l?d:d.substr(0,u),++m,x()}x()};var ur=we,Xc=ur.sha256=ur.sha256||{};ur.md.sha256=ur.md.algorithms.sha256=Xc;Xc.create=function(){Zc||i1();var e=null,t=ur.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=ur.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=ur.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Ql(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=ur.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Oa.substr(0,n.blockLength-a));for(var o,l,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,l=o/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Ql(f,r,i);var d=ur.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d.putInt32(f.h5),d.putInt32(f.h6),d.putInt32(f.h7),d},n};var Oa=null,Zc=!1,ef=null;function i1(){Oa=String.fromCharCode(128),Oa+=ur.util.fillString(String.fromCharCode(0),64),ef=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Zc=!0}function Ql(e,t,r){for(var n,i,s,a,o,l,u,c,f,d,p,g,m,T,x,B=r.length();B>=64;){for(u=0;u<16;++u)t[u]=r.getInt32();for(;u<64;++u)n=t[u-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[u-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[u]=n+t[u-7]+i+t[u-16]|0;for(c=e.h0,f=e.h1,d=e.h2,p=e.h3,g=e.h4,m=e.h5,T=e.h6,x=e.h7,u=0;u<64;++u)a=(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7),o=T^g&(m^T),s=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),l=c&f|d&(c^f),n=x+a+o+ef[u]+t[u],i=s+l,x=T,T=m,m=g,g=p+n>>>0,p=d,d=f,f=c,c=n+i>>>0;e.h0=e.h0+c|0,e.h1=e.h1+f|0,e.h2=e.h2+d|0,e.h3=e.h3+p|0,e.h4=e.h4+g|0,e.h5=e.h5+m|0,e.h6=e.h6+T|0,e.h7=e.h7+x|0,B-=64}}var ar=we,ts=null;ar.util.isNodejs&&!ar.options.usePureJavaScript&&!process.versions["node-webkit"]&&(ts=Oo);var s1=ar.prng=ar.prng||{};s1.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(u,c){if(!c)return t.generateSync(u);var f=t.plugin.cipher,d=t.plugin.increment,p=t.plugin.formatKey,g=t.plugin.formatSeed,m=ar.util.createBuffer();t.key=null,T();function T(x){if(x)return c(x);if(m.length()>=u)return c(null,m.getBytes(u));if(t.generated>1048575&&(t.key=null),t.key===null)return ar.util.nextTick(function(){s(T)});var B=f(t.key,t.seed);t.generated+=B.length,m.putBytes(B),t.key=p(f(t.key,d(t.seed))),t.seed=g(f(t.key,t.seed)),ar.util.setImmediate(T)}},t.generateSync=function(u){var c=t.plugin.cipher,f=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed;t.key=null;for(var g=ar.util.createBuffer();g.length()<u;){t.generated>1048575&&(t.key=null),t.key===null&&a();var m=c(t.key,t.seed);t.generated+=m.length,g.putBytes(m),t.key=d(c(t.key,f(t.seed))),t.seed=p(c(t.key,t.seed))}return g.getBytes(u)};function s(u){if(t.pools[0].messageLength>=32)return o(),u();var c=32-t.pools[0].messageLength<<5;t.seedFile(c,function(f,d){if(f)return u(f);t.collect(d),o(),u()})}function a(){if(t.pools[0].messageLength>=32)return o();var u=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(u)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var u=t.plugin.md.create();u.update(t.keyBytes);for(var c=1,f=0;f<32;++f)t.reseeds%c===0&&(u.update(t.pools[f].digest().getBytes()),t.pools[f].start()),c=c<<1;t.keyBytes=u.digest().getBytes(),u.start(),u.update(t.keyBytes);var d=u.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(d),t.generated=0}function l(u){var c=null,f=ar.util.globalScope,d=f.crypto||f.msCrypto;d&&d.getRandomValues&&(c=function(w){return d.getRandomValues(w)});var p=ar.util.createBuffer();if(c)for(;p.length()<u;){var g=Math.max(1,Math.min(u-p.length(),65536)/4),m=new Uint32Array(Math.floor(g));try{c(m);for(var T=0;T<m.length;++T)p.putInt32(m[T])}catch(w){if(!(typeof QuotaExceededError<"u"&&w instanceof QuotaExceededError))throw w}}if(p.length()<u)for(var x,B,v,_=Math.floor(Math.random()*65536);p.length()<u;){B=16807*(_&65535),x=16807*(_>>16),B+=(x&32767)<<16,B+=x>>15,B=(B&2147483647)+(B>>31),_=B&4294967295;for(var T=0;T<3;++T)v=_>>>(T<<3),v^=Math.floor(Math.random()*256),p.putByte(v&255)}return p.getBytes(u)}return ts?(t.seedFile=function(u,c){ts.randomBytes(u,function(f,d){if(f)return c(f);c(null,d.toString())})},t.seedFileSync=function(u){return ts.randomBytes(u).toString()}):(t.seedFile=function(u,c){try{c(null,l(u))}catch(f){c(f)}},t.seedFileSync=l),t.collect=function(u){for(var c=u.length,f=0;f<c;++f)t.pools[t.pool].update(u.substr(f,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(u,c){for(var f="",d=0;d<c;d+=8)f+=String.fromCharCode(u>>d&255);t.collect(f)},t.registerWorker=function(u){if(u===self)t.seedFile=function(f,d){function p(g){var m=g.data;m.forge&&m.forge.prng&&(self.removeEventListener("message",p),d(m.forge.prng.err,m.forge.prng.bytes))}self.addEventListener("message",p),self.postMessage({forge:{prng:{needed:f}}})};else{var c=function(f){var d=f.data;d.forge&&d.forge.prng&&t.seedFile(d.forge.prng.needed,function(p,g){u.postMessage({forge:{prng:{err:p,bytes:g}}})})};u.addEventListener("message",c)}},t};var vt=we;(function(){if(vt.random&&vt.random.getBytes){vt.random;return}(function(e){var t={},r=new Array(4),n=vt.util.createBuffer();t.formatKey=function(f){var d=vt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),vt.aes._expandKey(f,!1)},t.formatSeed=function(f){var d=vt.util.createBuffer(f);return f=new Array(4),f[0]=d.getInt32(),f[1]=d.getInt32(),f[2]=d.getInt32(),f[3]=d.getInt32(),f},t.cipher=function(f,d){return vt.aes._updateBlock(f,d,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(f){return++f[3],f},t.md=vt.md.sha256;function i(){var f=vt.prng.create(t);return f.getBytes=function(d,p){return f.generate(d,p)},f.getBytesSync=function(d){return f.generate(d)},f}var s=i(),a=null,o=vt.util.globalScope,l=o.crypto||o.msCrypto;if(l&&l.getRandomValues&&(a=function(f){return l.getRandomValues(f)}),vt.options.usePureJavaScript||!vt.util.isNodejs&&!a){if(s.collectInt(+new Date,32),typeof navigator<"u"){var u="";for(var c in navigator)try{typeof navigator[c]=="string"&&(u+=navigator[c])}catch{}s.collect(u),u=null}e&&(e().mousemove(function(f){s.collectInt(f.clientX,16),s.collectInt(f.clientY,16)}),e().keypress(function(f){s.collectInt(f.charCode,8)}))}if(!vt.random)vt.random=s;else for(var c in s)vt.random[c]=s[c];vt.random.createInstance=i,vt.random})(typeof jQuery<"u"?jQuery:null)})();var Ft=we,ha=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Jl=[1,2,3,5],a1=function(e,t){return e<<t&65535|(e&65535)>>16-t},o1=function(e,t){return(e&65535)>>t|e<<16-t&65535};Ft.rc2=Ft.rc2||{};Ft.rc2.expandKey=function(e,t){typeof e=="string"&&(e=Ft.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(ha[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,ha[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,ha[r.at(o+1)^r.at(o+s)]);return r};var tf=function(e,t,r){var n=!1,i=null,s=null,a=null,o,l,u,c,f=[];for(e=Ft.rc2.expandKey(e,t),u=0;u<64;u++)f.push(e.getInt16Le());r?(o=function(g){for(u=0;u<4;u++)g[u]+=f[c]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),g[u]=a1(g[u],Jl[u]),c++},l=function(g){for(u=0;u<4;u++)g[u]+=f[g[(u+3)%4]&63]}):(o=function(g){for(u=3;u>=0;u--)g[u]=o1(g[u],Jl[u]),g[u]-=f[c]+(g[(u+3)%4]&g[(u+2)%4])+(~g[(u+3)%4]&g[(u+1)%4]),c--},l=function(g){for(u=3;u>=0;u--)g[u]-=f[g[(u+3)%4]&63]});var d=function(g){var m=[];for(u=0;u<4;u++){var T=i.getInt16Le();a!==null&&(r?T^=a.getInt16Le():a.putInt16Le(T)),m.push(T&65535)}c=r?0:63;for(var x=0;x<g.length;x++)for(var B=0;B<g[x][0];B++)g[x][1](m);for(u=0;u<4;u++)a!==null&&(r?a.putInt16Le(m[u]):m[u]^=a.getInt16Le()),s.putInt16Le(m[u])},p=null;return p={start:function(g,m){g&&typeof g=="string"&&(g=Ft.util.createBuffer(g)),n=!1,i=Ft.util.createBuffer(),s=m||new Ft.util.createBuffer,a=g,p.output=s},update:function(g){for(n||i.putBuffer(g);i.length()>=8;)d([[5,o],[1,l],[6,o],[1,l],[5,o]])},finish:function(g){var m=!0;if(r)if(g)m=g(8,i,!r);else{var T=i.length()===8?8:8-i.length();i.fillWithByte(T,T)}if(m&&(n=!0,p.update()),!r&&(m=i.length()===0,m))if(g)m=g(8,s,!r);else{var x=s.length(),B=s.at(x-1);B>x?m=!1:s.truncate(B)}return m}},p};Ft.rc2.startEncrypting=function(e,t,r){var n=Ft.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};Ft.rc2.createEncryptionCipher=function(e,t){return tf(e,t,!0)};Ft.rc2.startDecrypting=function(e,t,r){var n=Ft.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};Ft.rc2.createDecryptionCipher=function(e,t){return tf(e,t,!1)};var Ma=we;Ma.jsbn=Ma.jsbn||{};var Ir;function W(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Ma.jsbn.BigInteger=W;function Oe(){return new W(null)}function l1(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function u1(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var l=this.data[e]&32767,u=this.data[e++]>>15,c=o*l+u*a;l=a*l+((c&32767)<<15)+r.data[n]+(i&1073741823),i=(l>>>30)+(c>>>15)+o*u+(i>>>30),r.data[n++]=l&1073741823}return i}function Yl(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var l=this.data[e]&16383,u=this.data[e++]>>14,c=o*l+u*a;l=a*l+((c&16383)<<14)+r.data[n]+i,i=(l>>28)+(c>>14)+o*u,r.data[n++]=l&268435455}return i}typeof navigator>"u"?(W.prototype.am=Yl,Ir=28):navigator.appName=="Microsoft Internet Explorer"?(W.prototype.am=u1,Ir=30):navigator.appName!="Netscape"?(W.prototype.am=l1,Ir=26):(W.prototype.am=Yl,Ir=28);W.prototype.DB=Ir;W.prototype.DM=(1<<Ir)-1;W.prototype.DV=1<<Ir;var Mo=52;W.prototype.FV=Math.pow(2,Mo);W.prototype.F1=Mo-Ir;W.prototype.F2=2*Ir-Mo;var c1="0123456789abcdefghijklmnopqrstuvwxyz",Ws=new Array,ei,Qt;ei="0".charCodeAt(0);for(Qt=0;Qt<=9;++Qt)Ws[ei++]=Qt;ei="a".charCodeAt(0);for(Qt=10;Qt<36;++Qt)Ws[ei++]=Qt;ei="A".charCodeAt(0);for(Qt=10;Qt<36;++Qt)Ws[ei++]=Qt;function Xl(e){return c1.charAt(e)}function rf(e,t){var r=Ws[e.charCodeAt(t)];return r==null?-1:r}function f1(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function h1(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function jr(e){var t=Oe();return t.fromInt(e),t}function d1(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:rf(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&(e[0]&128)!=0&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&W.ZERO.subTo(this,this)}function p1(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function g1(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=Xl(n));a>=0;)o<t?(n=(this.data[a]&(1<<o)-1)<<t-o,n|=this.data[--a]>>(o+=this.DB-t)):(n=this.data[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=Xl(n));return i?s:"0"}function y1(){var e=Oe();return W.ZERO.subTo(this,e),e}function m1(){return this.s<0?this.negate():this}function v1(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function Qs(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function C1(){return this.t<=0?0:this.DB*(this.t-1)+Qs(this.data[this.t-1]^this.s&this.DM)}function b1(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function E1(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function S1(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)t.data[o]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function _1(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function w1(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function T1(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&W.ZERO.subTo(t,t)}function x1(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function A1(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t!=null&&t.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Oe());var s=Oe(),a=this.s,o=e.s,l=this.DB-Qs(n.data[n.t-1]);l>0?(n.lShiftTo(l,s),i.lShiftTo(l,r)):(n.copyTo(s),i.copyTo(r));var u=s.t,c=s.data[u-1];if(c!=0){var f=c*(1<<this.F1)+(u>1?s.data[u-2]>>this.F2:0),d=this.FV/f,p=(1<<this.F1)/f,g=1<<this.F2,m=r.t,T=m-u,x=t==null?Oe():t;for(s.dlShiftTo(T,x),r.compareTo(x)>=0&&(r.data[r.t++]=1,r.subTo(x,r)),W.ONE.dlShiftTo(u,x),x.subTo(s,s);s.t<u;)s.data[s.t++]=0;for(;--T>=0;){var B=r.data[--m]==c?this.DM:Math.floor(r.data[m]*d+(r.data[m-1]+g)*p);if((r.data[m]+=s.am(0,B,r,T,0,u))<B)for(s.dlShiftTo(T,x),r.subTo(x,r);r.data[m]<--B;)r.subTo(x,r)}t!=null&&(r.drShiftTo(u,t),a!=o&&W.ZERO.subTo(t,t)),r.t=u,r.clamp(),l>0&&r.rShiftTo(l,r),a<0&&W.ZERO.subTo(r,r)}}}function I1(e){var t=Oe();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(W.ZERO)>0&&e.subTo(t,t),t}function Sn(e){this.m=e}function k1(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function B1(e){return e}function R1(e){e.divRemTo(this.m,null,e)}function N1(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function L1(e,t){e.squareTo(t),this.reduce(t)}Sn.prototype.convert=k1;Sn.prototype.revert=B1;Sn.prototype.reduce=R1;Sn.prototype.mulTo=N1;Sn.prototype.sqrTo=L1;function D1(){if(this.t<1)return 0;var e=this.data[0];if((e&1)==0)return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function _n(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function U1(e){var t=Oe();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(W.ZERO)>0&&this.m.subTo(t,t),t}function O1(e){var t=Oe();return e.copyTo(t),this.reduce(t),t}function M1(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function P1(e,t){e.squareTo(t),this.reduce(t)}function F1(e,t,r){e.multiplyTo(t,r),this.reduce(r)}_n.prototype.convert=U1;_n.prototype.revert=O1;_n.prototype.reduce=M1;_n.prototype.mulTo=F1;_n.prototype.sqrTo=P1;function V1(){return(this.t>0?this.data[0]&1:this.s)==0}function K1(e,t){if(e>4294967295||e<1)return W.ONE;var r=Oe(),n=Oe(),i=t.convert(this),s=Qs(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function H1(e,t){var r;return e<256||t.isEven()?r=new Sn(t):r=new _n(t),this.exp(e,r)}W.prototype.copyTo=f1;W.prototype.fromInt=h1;W.prototype.fromString=d1;W.prototype.clamp=p1;W.prototype.dlShiftTo=b1;W.prototype.drShiftTo=E1;W.prototype.lShiftTo=S1;W.prototype.rShiftTo=_1;W.prototype.subTo=w1;W.prototype.multiplyTo=T1;W.prototype.squareTo=x1;W.prototype.divRemTo=A1;W.prototype.invDigit=D1;W.prototype.isEven=V1;W.prototype.exp=K1;W.prototype.toString=g1;W.prototype.negate=y1;W.prototype.abs=m1;W.prototype.compareTo=v1;W.prototype.bitLength=C1;W.prototype.mod=I1;W.prototype.modPowInt=H1;W.ZERO=jr(0);W.ONE=jr(1);function $1(){var e=Oe();return this.copyTo(e),e}function G1(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function q1(){return this.t==0?this.s:this.data[0]<<24>>24}function j1(){return this.t==0?this.s:this.data[0]<<16>>16}function z1(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function W1(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function Q1(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=jr(r),i=Oe(),s=Oe(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function J1(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var l=rf(e,o);if(l<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+l,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&W.ZERO.subTo(this,this)}function Y1(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(W.ONE.shiftLeft(e-1),Po,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(W.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function X1(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),(n&128)!=0&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Z1(e){return this.compareTo(e)==0}function eC(e){return this.compareTo(e)<0?this:e}function tC(e){return this.compareTo(e)>0?this:e}function rC(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function nC(e,t){return e&t}function iC(e){var t=Oe();return this.bitwiseTo(e,nC,t),t}function Po(e,t){return e|t}function sC(e){var t=Oe();return this.bitwiseTo(e,Po,t),t}function nf(e,t){return e^t}function aC(e){var t=Oe();return this.bitwiseTo(e,nf,t),t}function sf(e,t){return e&~t}function oC(e){var t=Oe();return this.bitwiseTo(e,sf,t),t}function lC(){for(var e=Oe(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function uC(e){var t=Oe();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function cC(e){var t=Oe();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function fC(e){if(e==0)return-1;var t=0;return(e&65535)==0&&(e>>=16,t+=16),(e&255)==0&&(e>>=8,t+=8),(e&15)==0&&(e>>=4,t+=4),(e&3)==0&&(e>>=2,t+=2),(e&1)==0&&++t,t}function hC(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+fC(this.data[e]);return this.s<0?this.t*this.DB:-1}function dC(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function pC(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=dC(this.data[r]^t);return e}function gC(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function yC(e,t){var r=W.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function mC(e){return this.changeBit(e,Po)}function vC(e){return this.changeBit(e,sf)}function CC(e){return this.changeBit(e,nf)}function bC(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function EC(e){var t=Oe();return this.addTo(e,t),t}function SC(e){var t=Oe();return this.subTo(e,t),t}function _C(e){var t=Oe();return this.multiplyTo(e,t),t}function wC(e){var t=Oe();return this.divRemTo(e,t,null),t}function TC(e){var t=Oe();return this.divRemTo(e,null,t),t}function xC(e){var t=Oe(),r=Oe();return this.divRemTo(e,t,r),new Array(t,r)}function AC(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function IC(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Oi(){}function af(e){return e}function kC(e,t,r){e.multiplyTo(t,r)}function BC(e,t){e.squareTo(t)}Oi.prototype.convert=af;Oi.prototype.revert=af;Oi.prototype.mulTo=kC;Oi.prototype.sqrTo=BC;function RC(e){return this.exp(e,new Oi)}function NC(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function LC(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function ti(e){this.r2=Oe(),this.q3=Oe(),W.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function DC(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=Oe();return e.copyTo(t),this.reduce(t),t}function UC(e){return e}function OC(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function MC(e,t){e.squareTo(t),this.reduce(t)}function PC(e,t,r){e.multiplyTo(t,r),this.reduce(r)}ti.prototype.convert=DC;ti.prototype.revert=UC;ti.prototype.reduce=OC;ti.prototype.mulTo=PC;ti.prototype.sqrTo=MC;function FC(e,t){var r=e.bitLength(),n,i=jr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Sn(t):t.isEven()?s=new ti(t):s=new _n(t);var a=new Array,o=3,l=n-1,u=(1<<n)-1;if(a[1]=s.convert(this),n>1){var c=Oe();for(s.sqrTo(a[1],c);o<=u;)a[o]=Oe(),s.mulTo(c,a[o-2],a[o]),o+=2}var f=e.t-1,d,p=!0,g=Oe(),m;for(r=Qs(e.data[f])-1;f>=0;){for(r>=l?d=e.data[f]>>r-l&u:(d=(e.data[f]&(1<<r+1)-1)<<l-r,f>0&&(d|=e.data[f-1]>>this.DB+r-l)),o=n;(d&1)==0;)d>>=1,--o;if((r-=o)<0&&(r+=this.DB,--f),p)a[d].copyTo(i),p=!1;else{for(;o>1;)s.sqrTo(i,g),s.sqrTo(g,i),o-=2;o>0?s.sqrTo(i,g):(m=i,i=g,g=m),s.mulTo(g,a[d],i)}for(;f>=0&&(e.data[f]&1<<r)==0;)s.sqrTo(i,g),m=i,i=g,g=m,--r<0&&(r=this.DB-1,--f)}return s.revert(i)}function VC(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function KC(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function HC(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return W.ZERO;for(var r=e.clone(),n=this.clone(),i=jr(1),s=jr(0),a=jr(0),o=jr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(W.ONE)!=0)return W.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var tr=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],$C=(1<<26)/tr[tr.length-1];function GC(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=tr[tr.length-1]){for(t=0;t<tr.length;++t)if(r.data[0]==tr[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<tr.length;){for(var n=tr[t],i=t+1;i<tr.length&&n<$C;)n*=tr[i++];for(n=r.modInt(n);t<i;)if(n%tr[t++]==0)return!1}return r.millerRabin(e)}function qC(e){var t=this.subtract(W.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=jC(),s,a=0;a<e;++a){do s=new W(this.bitLength(),i);while(s.compareTo(W.ONE)<=0||s.compareTo(t)>=0);var o=s.modPow(n,this);if(o.compareTo(W.ONE)!=0&&o.compareTo(t)!=0){for(var l=1;l++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(W.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function jC(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}W.prototype.chunkSize=z1;W.prototype.toRadix=Q1;W.prototype.fromRadix=J1;W.prototype.fromNumber=Y1;W.prototype.bitwiseTo=rC;W.prototype.changeBit=yC;W.prototype.addTo=bC;W.prototype.dMultiply=AC;W.prototype.dAddOffset=IC;W.prototype.multiplyLowerTo=NC;W.prototype.multiplyUpperTo=LC;W.prototype.modInt=KC;W.prototype.millerRabin=qC;W.prototype.clone=$1;W.prototype.intValue=G1;W.prototype.byteValue=q1;W.prototype.shortValue=j1;W.prototype.signum=W1;W.prototype.toByteArray=X1;W.prototype.equals=Z1;W.prototype.min=eC;W.prototype.max=tC;W.prototype.and=iC;W.prototype.or=sC;W.prototype.xor=aC;W.prototype.andNot=oC;W.prototype.not=lC;W.prototype.shiftLeft=uC;W.prototype.shiftRight=cC;W.prototype.getLowestSetBit=hC;W.prototype.bitCount=pC;W.prototype.testBit=gC;W.prototype.setBit=mC;W.prototype.clearBit=vC;W.prototype.flipBit=CC;W.prototype.add=EC;W.prototype.subtract=SC;W.prototype.multiply=_C;W.prototype.divide=wC;W.prototype.remainder=TC;W.prototype.divideAndRemainder=xC;W.prototype.modPow=FC;W.prototype.modInverse=HC;W.prototype.pow=RC;W.prototype.gcd=VC;W.prototype.isProbablePrime=GC;var cr=we,of=cr.sha1=cr.sha1||{};cr.md.sha1=cr.md.algorithms.sha1=of;of.create=function(){lf||zC();var e=null,t=cr.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=cr.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=cr.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Zl(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=cr.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Pa.substr(0,n.blockLength-a));for(var o,l,u=n.fullMessageLength[0]*8,c=0;c<n.fullMessageLength.length-1;++c)o=n.fullMessageLength[c+1]*8,l=o/4294967296>>>0,u+=l,i.putInt32(u>>>0),u=o>>>0;i.putInt32(u);var f={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};Zl(f,r,i);var d=cr.util.createBuffer();return d.putInt32(f.h0),d.putInt32(f.h1),d.putInt32(f.h2),d.putInt32(f.h3),d.putInt32(f.h4),d},n};var Pa=null,lf=!1;function zC(){Pa=String.fromCharCode(128),Pa+=cr.util.fillString(String.fromCharCode(0),64),lf=!0}function Zl(e,t,r){for(var n,i,s,a,o,l,u,c,f=r.length();f>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,l=e.h4,c=0;c<16;++c)n=r.getInt32(),t[c]=n,u=o^s&(a^o),n=(i<<5|i>>>27)+u+l+1518500249+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<20;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=o^s&(a^o),n=(i<<5|i>>>27)+u+l+1518500249+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<32;++c)n=t[c-3]^t[c-8]^t[c-14]^t[c-16],n=n<<1|n>>>31,t[c]=n,u=s^a^o,n=(i<<5|i>>>27)+u+l+1859775393+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<40;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=s^a^o,n=(i<<5|i>>>27)+u+l+1859775393+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<60;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=s&a|o&(s^a),n=(i<<5|i>>>27)+u+l+2400959708+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;c<80;++c)n=t[c-6]^t[c-16]^t[c-28]^t[c-32],n=n<<2|n>>>30,t[c]=n,u=s^a^o,n=(i<<5|i>>>27)+u+l+3395469782+n,l=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+l|0,f-=64}}var fr=we,uf=fr.pkcs1=fr.pkcs1||{};uf.encode_rsa_oaep=function(e,t,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=fr.md.sha1.create(),a||(a=s);var o=Math.ceil(e.n.bitLength()/8),l=o-2*s.digestLength-2;if(t.length>l){var u=new Error("RSAES-OAEP input message length is too long.");throw u.length=t.length,u.maxLength=l,u}n||(n=""),s.update(n,"raw");for(var c=s.digest(),f="",d=l-t.length,p=0;p<d;p++)f+="\0";var g=c.getBytes()+f+""+t;if(!i)i=fr.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var u=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw u.seedLength=i.length,u.digestLength=s.digestLength,u}var m=_s(i,o-s.digestLength-1,a),T=fr.util.xorBytes(g,m,g.length),x=_s(T,s.digestLength,a),B=fr.util.xorBytes(i,x,i.length);return"\0"+B+T};uf.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a){var T=new Error("RSAES-OAEP encoded message length is invalid.");throw T.length=t.length,T.expectedLength=a,T}if(i===void 0?i=fr.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),l=t.charAt(0),u=t.substring(1,i.digestLength+1),c=t.substring(1+i.digestLength),f=_s(c,i.digestLength,s),d=fr.util.xorBytes(u,f,u.length),p=_s(d,a-i.digestLength-1,s),g=fr.util.xorBytes(c,p,c.length),m=g.substring(0,i.digestLength),T=l!=="\0",x=0;x<i.digestLength;++x)T|=o.charAt(x)!==m.charAt(x);for(var B=1,v=i.digestLength,_=i.digestLength;_<g.length;_++){var w=g.charCodeAt(_),I=w&1^1,k=B?65534:0;T|=w&k,B=B&I,v+=B}if(T||g.charCodeAt(v)!==1)throw new Error("Invalid RSAES-OAEP padding.");return g.substring(v+1)};function _s(e,t,r){r||(r=fr.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}var Mr=we;(function(){if(Mr.prime){Mr.prime;return}var e=Mr.prime=Mr.prime||{},t=Mr.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(f,d){return f|d};e.generateProbablePrime=function(f,d,p){typeof d=="function"&&(p=d,d={}),d=d||{};var g=d.algorithm||"PRIMEINC";typeof g=="string"&&(g={name:g}),g.options=g.options||{};var m=d.prng||Mr.random,T={nextBytes:function(x){for(var B=m.getBytesSync(x.length),v=0;v<x.length;++v)x[v]=B.charCodeAt(v)}};if(g.name==="PRIMEINC")return s(f,T,g.options,p);throw new Error("Invalid prime generation algorithm: "+g.name)};function s(f,d,p,g){return"workers"in p?l(f,d,p,g):a(f,d,p,g)}function a(f,d,p,g){var m=u(f,d),T=0,x=c(m.bitLength());"millerRabinTests"in p&&(x=p.millerRabinTests);var B=10;"maxBlockTime"in p&&(B=p.maxBlockTime),o(m,f,d,T,x,B,g)}function o(f,d,p,g,m,T,x){var B=+new Date;do{if(f.bitLength()>d&&(f=u(d,p)),f.isProbablePrime(m))return x(null,f);f.dAddOffset(r[g++%8],0)}while(T<0||+new Date-B<T);Mr.util.setImmediate(function(){o(f,d,p,g,m,T,x)})}function l(f,d,p,g){if(typeof Worker>"u")return a(f,d,p,g);var m=u(f,d),T=p.workers,x=p.workLoad||100,B=x*30/8,v=p.workerScript||"forge/prime.worker.js";if(T===-1)return Mr.util.estimateCores(function(w,I){w&&(I=2),T=I-1,_()});_();function _(){T=Math.max(1,T);for(var w=[],I=0;I<T;++I)w[I]=new Worker(v);for(var I=0;I<T;++I)w[I].addEventListener("message",M);var k=!1;function M(K){if(!k){var N=K.data;if(N.found){for(var U=0;U<w.length;++U)w[U].terminate();return k=!0,g(null,new t(N.prime,16))}m.bitLength()>f&&(m=u(f,d));var H=m.toString(16);K.target.postMessage({hex:H,workLoad:x}),m.dAddOffset(B,0)}}}}function u(f,d){var p=new t(f,d),g=f-1;return p.testBit(g)||p.bitwiseTo(t.ONE.shiftLeft(g),i,p),p.dAddOffset(31-p.mod(n).byteValue(),0),p}function c(f){return f<=100?27:f<=150?18:f<=200?15:f<=250?12:f<=300?9:f<=350?8:f<=400?7:f<=500?6:f<=600?5:f<=800?4:f<=1250?3:2}})();var ce=we;if(typeof Ue>"u")var Ue=ce.jsbn.BigInteger;var Fa=ce.util.isNodejs?Oo:null,V=ce.asn1,Jt=ce.util;ce.pki=ce.pki||{};ce.pki.rsa=ce.rsa=ce.rsa||{};var Ce=ce.pki,WC=[6,4,2,4,2,4,6,2],QC={name:"PrivateKeyInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},JC={name:"RSAPrivateKey",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},YC={name:"RSAPublicKey",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},XC=ce.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:V.Class.UNIVERSAL,type:V.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},ZC={name:"DigestInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:V.Class.UNIVERSAL,type:V.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},eb=function(e){var t;if(e.algorithm in Ce.oids)t=Ce.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=V.oidToDer(t).getBytes(),i=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]),s=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);s.value.push(V.create(V.Class.UNIVERSAL,V.Type.OID,!1,n)),s.value.push(V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,""));var a=V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),V.toDer(i).getBytes()},cf=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(Ue.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(Ue.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new Ue(ce.util.bytesToHex(ce.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(Ue.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var a=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return a=a.multiply(n.modInverse(t.n)).mod(t.n),a};Ce.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=ff(e,t,r)):(i=ce.util.createBuffer(),i.putBytes(e));for(var a=new Ue(i.toHex(),16),o=cf(a,t,n),l=o.toString(16),u=ce.util.createBuffer(),c=s-Math.ceil(l.length/2);c>0;)u.putByte(0),--c;return u.putBytes(ce.util.hexToBytes(l)),u.getBytes()};Ce.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var a=new Ue(ce.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=cf(a,t,r),l=o.toString(16),u=ce.util.createBuffer(),c=i-Math.ceil(l.length/2);c>0;)u.putByte(0),--c;return u.putBytes(ce.util.hexToBytes(l)),n!==!1?ws(u.getBytes(),t,r):u.getBytes()};Ce.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||ce.random,i={nextBytes:function(o){for(var l=n.getBytesSync(o.length),u=0;u<o.length;++u)o[u]=l.charCodeAt(u)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new Ue(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};Ce.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new Ue(null);r.fromInt(30);for(var n=0,i=function(f,d){return f|d},s=+new Date,a,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var l=e.p===null?e.pBits:e.qBits,u=l-1;e.pqState===0?(e.num=new Ue(l,e.rng),e.num.testBit(u)||e.num.bitwiseTo(Ue.ONE.shiftLeft(u),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>l?e.pqState=0:e.num.isProbablePrime(rb(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(WC[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(Ue.ONE).gcd(e.e).compareTo(Ue.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(Ue.ONE),e.q1=e.q.subtract(Ue.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(Ue.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var c=e.e.modInverse(e.phi);e.keys={privateKey:Ce.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ce.rsa.setPublicKey(e.n,e.e)}}a=+new Date,o+=a-s,s=a}return e.keys!==null};Ce.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!ce.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(eu("generateKeyPair"))return Fa.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,l,u){if(o)return n(o);n(null,{privateKey:Ce.privateKeyFromPem(u),publicKey:Ce.publicKeyFromPem(l)})});if(tu("generateKey")&&tu("exportKey"))return Jt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:nu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Jt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var l=Ce.privateKeyFromAsn1(V.fromDer(ce.util.createBuffer(o)));n(null,{privateKey:l,publicKey:Ce.setRsaPublicKey(l.n,l.e)})}});if(ru("generateKey")&&ru("exportKey")){var i=Jt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:nu(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var l=o.target.result,u=Jt.globalScope.msCrypto.subtle.exportKey("pkcs8",l.privateKey);u.oncomplete=function(c){var f=c.target.result,d=Ce.privateKeyFromAsn1(V.fromDer(ce.util.createBuffer(f)));n(null,{privateKey:d,publicKey:Ce.setRsaPublicKey(d.n,d.e)})},u.onerror=function(c){n(c)}},i.onerror=function(o){n(o)};return}}else if(eu("generateKeyPairSync")){var s=Fa.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Ce.privateKeyFromPem(s.privateKey),publicKey:Ce.publicKeyFromPem(s.publicKey)}}}var a=Ce.rsa.createKeyPairGenerationState(e,t,r);if(!n)return Ce.rsa.stepKeyPairGenerationState(a,0),a.keys;tb(a,r,n)};Ce.setRsaPublicKey=Ce.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,l,u){return ff(o,l,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,l){return ce.pkcs1.encode_rsa_oaep(l,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return Ce.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(l,u){u=ws(u,r,!0);var c=V.fromDer(u,{parseAllBytes:a._parseAllDigestBytes}),f={},d=[];if(!V.validate(c,ZC,f,d)){var p=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw p.errors=d,p}var g=V.derToOid(f.algorithmIdentifier);if(!(g===ce.oids.md2||g===ce.oids.md5||g===ce.oids.sha1||g===ce.oids.sha224||g===ce.oids.sha256||g===ce.oids.sha384||g===ce.oids.sha512||g===ce.oids["sha512-224"]||g===ce.oids["sha512-256"])){var p=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw p.oid=g,p}if((g===ce.oids.md2||g===ce.oids.md5)&&!("parameters"in f))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return l===f.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(l,u){return u=ws(u,r,!0),l===u}});var o=Ce.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};Ce.setRsaPrivateKey=Ce.rsa.setPrivateKey=function(e,t,r,n,i,s,a,o){var l={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return l.decrypt=function(u,c,f){typeof c=="string"?c=c.toUpperCase():c===void 0&&(c="RSAES-PKCS1-V1_5");var d=Ce.rsa.decrypt(u,l,!1,!1);if(c==="RSAES-PKCS1-V1_5")c={decode:ws};else if(c==="RSA-OAEP"||c==="RSAES-OAEP")c={decode:function(p,g){return ce.pkcs1.decode_rsa_oaep(g,p,f)}};else if(["RAW","NONE","NULL",null].indexOf(c)!==-1)c={decode:function(p){return p}};else throw new Error('Unsupported encryption scheme: "'+c+'".');return c.decode(d,l,!1)},l.sign=function(u,c){var f=!1;typeof c=="string"&&(c=c.toUpperCase()),c===void 0||c==="RSASSA-PKCS1-V1_5"?(c={encode:eb},f=1):(c==="NONE"||c==="NULL"||c===null)&&(c={encode:function(){return u}},f=1);var d=c.encode(u,l.n.bitLength());return Ce.rsa.encrypt(d,l,f)},l};Ce.wrapRsaPrivateKey=function(e){return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(0).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Ce.oids.rsaEncryption).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")]),V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,V.toDer(e).getBytes())])};Ce.privateKeyFromAsn1=function(e){var t={},r=[];if(V.validate(e,QC,t,r)&&(e=V.fromDer(ce.util.createBuffer(t.privateKey))),t={},r=[],!V.validate(e,JC,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,l,u,c,f;return i=ce.util.createBuffer(t.privateKeyModulus).toHex(),s=ce.util.createBuffer(t.privateKeyPublicExponent).toHex(),a=ce.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=ce.util.createBuffer(t.privateKeyPrime1).toHex(),l=ce.util.createBuffer(t.privateKeyPrime2).toHex(),u=ce.util.createBuffer(t.privateKeyExponent1).toHex(),c=ce.util.createBuffer(t.privateKeyExponent2).toHex(),f=ce.util.createBuffer(t.privateKeyCoefficient).toHex(),Ce.setRsaPrivateKey(new Ue(i,16),new Ue(s,16),new Ue(a,16),new Ue(o,16),new Ue(l,16),new Ue(u,16),new Ue(c,16),new Ue(f,16))};Ce.privateKeyToAsn1=Ce.privateKeyToRSAPrivateKey=function(e){return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(0).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.n)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.e)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.d)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.p)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.q)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.dP)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.dQ)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.qInv))])};Ce.publicKeyFromAsn1=function(e){var t={},r=[];if(V.validate(e,XC,t,r)){var n=V.derToOid(t.publicKeyOid);if(n!==Ce.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!V.validate(e,YC,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=ce.util.createBuffer(t.publicKeyModulus).toHex(),a=ce.util.createBuffer(t.publicKeyExponent).toHex();return Ce.setRsaPublicKey(new Ue(s,16),new Ue(a,16))};Ce.publicKeyToAsn1=Ce.publicKeyToSubjectPublicKeyInfo=function(e){return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Ce.oids.rsaEncryption).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")]),V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,[Ce.publicKeyToRSAPublicKey(e)])])};Ce.publicKeyToRSAPublicKey=function(e){return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.n)),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,sr(e.e))])};function ff(e,t,r){var n=ce.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var l=0;l<a;++l)n.putByte(o)}else for(;a>0;){for(var u=0,c=ce.random.getBytes(a),l=0;l<a;++l)o=c.charCodeAt(l),o===0?++u:n.putByte(o);a=u}return n.putByte(0),n.putBytes(e),n}function ws(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=ce.util.createBuffer(e),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var l=0;if(o===0){l=i-3-n;for(var u=0;u<l;++u)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(l=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++l}else if(o===2)for(l=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++l}var c=s.getByte();if(c!==0||l!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function tb(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(o,l){if(o)return r(o);if(e.p=l,e.q!==null)return a(o,e.q);s(e.qBits,a)})}function s(o,l){ce.prime.generateProbablePrime(o,n,l)}function a(o,l){if(o)return r(o);if(e.q=l,e.p.compareTo(e.q)<0){var u=e.p;e.p=e.q,e.q=u}if(e.p.subtract(Ue.ONE).gcd(e.e).compareTo(Ue.ONE)!==0){e.p=null,i();return}if(e.q.subtract(Ue.ONE).gcd(e.e).compareTo(Ue.ONE)!==0){e.q=null,s(e.qBits,a);return}if(e.p1=e.p.subtract(Ue.ONE),e.q1=e.q.subtract(Ue.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(Ue.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,a);return}var c=e.e.modInverse(e.phi);e.keys={privateKey:Ce.rsa.setPrivateKey(e.n,e.e,c,e.p,e.q,c.mod(e.p1),c.mod(e.q1),e.q.modInverse(e.p)),publicKey:Ce.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function sr(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=ce.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&(r.charCodeAt(1)&128)===0||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function rb(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function eu(e){return ce.util.isNodejs&&typeof Fa[e]=="function"}function tu(e){return typeof Jt.globalScope<"u"&&typeof Jt.globalScope.crypto=="object"&&typeof Jt.globalScope.crypto.subtle=="object"&&typeof Jt.globalScope.crypto.subtle[e]=="function"}function ru(e){return typeof Jt.globalScope<"u"&&typeof Jt.globalScope.msCrypto=="object"&&typeof Jt.globalScope.msCrypto.subtle=="object"&&typeof Jt.globalScope.msCrypto.subtle[e]=="function"}function nu(e){for(var t=ce.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}var ie=we;if(typeof nb>"u")var nb=ie.jsbn.BigInteger;var j=ie.asn1,Ee=ie.pki=ie.pki||{};Ee.pbe=ie.pbe=ie.pbe||{};var nn=Ee.oids,ib={name:"EncryptedPrivateKeyInfo",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},sb={name:"PBES2Algorithms",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:j.Class.UNIVERSAL,type:j.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},ab={name:"pkcs-12PbeParams",tagClass:j.Class.UNIVERSAL,type:j.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:j.Class.UNIVERSAL,type:j.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:j.Class.UNIVERSAL,type:j.Type.INTEGER,constructed:!1,capture:"iterations"}]};Ee.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=ie.random.getBytesSync(r.saltSize),i=r.count,s=j.integerToDer(i),a,o,l;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var u,c,f;switch(r.algorithm){case"aes128":a=16,u=16,c=nn["aes128-CBC"],f=ie.aes.createEncryptionCipher;break;case"aes192":a=24,u=16,c=nn["aes192-CBC"],f=ie.aes.createEncryptionCipher;break;case"aes256":a=32,u=16,c=nn["aes256-CBC"],f=ie.aes.createEncryptionCipher;break;case"des":a=8,u=8,c=nn.desCBC,f=ie.des.createEncryptionCipher;break;default:var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var p="hmacWith"+r.prfAlgorithm.toUpperCase(),g=df(p),m=ie.pkcs5.pbkdf2(t,n,i,a,g),T=ie.random.getBytesSync(u),x=f(m);x.start(T),x.update(j.toDer(e)),x.finish(),l=x.output.getBytes();var B=ob(n,s,a,p);o=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(nn.pkcs5PBES2).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(nn.pkcs5PBKDF2).getBytes()),B]),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(c).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,T)])])])}else if(r.algorithm==="3des"){a=24;var v=new ie.util.ByteBuffer(n),m=Ee.pbe.generatePkcs12Key(t,v,1,i,a),T=Ee.pbe.generatePkcs12Key(t,v,2,i,a),x=ie.des.createEncryptionCipher(m);x.start(T),x.update(j.toDer(e)),x.finish(),l=x.output.getBytes(),o=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(nn["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,n),j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,s.getBytes())])])}else{var d=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw d.algorithm=r.algorithm,d}var _=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[o,j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,l)]);return _};Ee.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!j.validate(e,ib,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=j.derToOid(n.encryptionOid),o=Ee.pbe.getCipher(a,n.encryptionParams,t),l=ie.util.createBuffer(n.encryptedData);return o.update(l),o.finish()&&(r=j.fromDer(o.output)),r};Ee.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:j.toDer(e).getBytes()};return ie.pem.encode(r,{maxline:t})};Ee.encryptedPrivateKeyFromPem=function(e){var t=ie.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return j.fromDer(t.body)};Ee.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=Ee.wrapRsaPrivateKey(Ee.privateKeyToAsn1(e));return n=Ee.encryptPrivateKeyInfo(n,t,r),Ee.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=ie.random.getBytesSync(16),o=ie.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=ie.random.getBytesSync(16),o=ie.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=ie.random.getBytesSync(16),o=ie.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=ie.random.getBytesSync(8),o=ie.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=ie.random.getBytesSync(8),o=ie.des.createEncryptionCipher;break;default:var l=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw l.algorithm=r.algorithm,l}var u=ie.pbe.opensslDeriveBytes(t,s.substr(0,8),a),c=o(u);c.start(s),c.update(j.toDer(Ee.privateKeyToAsn1(e))),c.finish();var f={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:ie.util.bytesToHex(s).toUpperCase()},body:c.output.getBytes()};return ie.pem.encode(f)};Ee.decryptRsaPrivateKey=function(e,t){var r=null,n=ie.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=ie.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=ie.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=ie.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=ie.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=ie.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(f){return ie.rc2.createDecryptionCipher(f,40)};break;case"RC2-64-CBC":s=8,a=function(f){return ie.rc2.createDecryptionCipher(f,64)};break;case"RC2-128-CBC":s=16,a=function(f){return ie.rc2.createDecryptionCipher(f,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=ie.util.hexToBytes(n.dekInfo.parameters),l=ie.pbe.opensslDeriveBytes(t,o.substr(0,8),s),u=a(l);if(u.start(o),u.update(ie.util.createBuffer(n.body)),u.finish())r=u.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=Ee.decryptPrivateKeyInfo(j.fromDer(r),t):r=j.fromDer(r),r!==null&&(r=Ee.privateKeyFromAsn1(r)),r};Ee.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in ie.md))throw new Error('"sha1" hash algorithm unavailable.');s=ie.md.sha1.create()}var l=s.digestLength,u=s.blockLength,c=new ie.util.ByteBuffer,f=new ie.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)f.putInt16(e.charCodeAt(o));f.putInt16(0)}var d=f.length(),p=t.length(),g=new ie.util.ByteBuffer;g.fillWithByte(r,u);var m=u*Math.ceil(p/u),T=new ie.util.ByteBuffer;for(o=0;o<m;o++)T.putByte(t.at(o%p));var x=u*Math.ceil(d/u),B=new ie.util.ByteBuffer;for(o=0;o<x;o++)B.putByte(f.at(o%d));var v=T;v.putBuffer(B);for(var _=Math.ceil(i/l),w=1;w<=_;w++){var I=new ie.util.ByteBuffer;I.putBytes(g.bytes()),I.putBytes(v.bytes());for(var k=0;k<n;k++)s.start(),s.update(I.getBytes()),I=s.digest();var M=new ie.util.ByteBuffer;for(o=0;o<u;o++)M.putByte(I.at(o%l));var K=Math.ceil(p/u)+Math.ceil(d/u),N=new ie.util.ByteBuffer;for(a=0;a<K;a++){var U=new ie.util.ByteBuffer(v.getBytes(u)),H=511;for(o=M.length()-1;o>=0;o--)H=H>>8,H+=M.at(o)+U.at(o),U.setAt(o,H&255);N.putBuffer(U)}v=N,c.putBuffer(I)}return c.truncate(c.length()-i),c};Ee.pbe.getCipher=function(e,t,r){switch(e){case Ee.oids.pkcs5PBES2:return Ee.pbe.getCipherForPBES2(e,t,r);case Ee.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case Ee.oids["pbewithSHAAnd40BitRC2-CBC"]:return Ee.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};Ee.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!j.validate(t,sb,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=j.derToOid(n.kdfOid),e!==Ee.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=j.derToOid(n.encOid),e!==Ee.oids["aes128-CBC"]&&e!==Ee.oids["aes192-CBC"]&&e!==Ee.oids["aes256-CBC"]&&e!==Ee.oids["des-EDE3-CBC"]&&e!==Ee.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=ie.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var l,u;switch(Ee.oids[e]){case"aes128-CBC":l=16,u=ie.aes.createDecryptionCipher;break;case"aes192-CBC":l=24,u=ie.aes.createDecryptionCipher;break;case"aes256-CBC":l=32,u=ie.aes.createDecryptionCipher;break;case"des-EDE3-CBC":l=24,u=ie.des.createDecryptionCipher;break;case"desCBC":l=8,u=ie.des.createDecryptionCipher;break}var c=hf(n.prfOid),f=ie.pkcs5.pbkdf2(r,a,o,l,c),d=n.encIv,p=u(f);return p.start(d),p};Ee.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!j.validate(t,ab,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=ie.util.createBuffer(n.salt),o=ie.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var l,u,c;switch(e){case Ee.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:l=24,u=8,c=ie.des.startDecrypting;break;case Ee.oids["pbewithSHAAnd40BitRC2-CBC"]:l=5,u=8,c=function(m,T){var x=ie.rc2.createDecryptionCipher(m,40);return x.start(T,null),x};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var f=hf(n.prfOid),d=Ee.pbe.generatePkcs12Key(r,a,1,o,l,f);f.start();var p=Ee.pbe.generatePkcs12Key(r,a,2,o,u,f);return c(d,p)};Ee.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in ie.md))throw new Error('"md5" hash algorithm unavailable.');n=ie.md.md5.create()}t===null&&(t="");for(var i=[iu(n,e+t)],s=16,a=1;s<r;++a,s+=16)i.push(iu(n,i[a-1]+e+t));return i.join("").substr(0,r)};function iu(e,t){return e.start().update(t).digest().getBytes()}function hf(e){var t;if(!e)t="hmacWithSHA1";else if(t=Ee.oids[j.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return df(t)}function df(e){var t=ie.md;switch(e){case"hmacWithSHA224":t=ie.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function ob(e,t,r,n){var i=j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OCTETSTRING,!1,e),j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(j.create(j.Class.UNIVERSAL,j.Type.INTEGER,!1,ie.util.hexToBytes(r.toString(16))),j.create(j.Class.UNIVERSAL,j.Type.SEQUENCE,!0,[j.create(j.Class.UNIVERSAL,j.Type.OID,!1,j.oidToDer(Ee.oids[n]).getBytes()),j.create(j.Class.UNIVERSAL,j.Type.NULL,!1,"")])),i}var Gn=we,ne=Gn.asn1,ri=Gn.pkcs7asn1=Gn.pkcs7asn1||{};Gn.pkcs7=Gn.pkcs7||{};Gn.pkcs7.asn1=ri;var pf={name:"ContentInfo",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};ri.contentInfoValidator=pf;var gf={name:"EncryptedContentInfo",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:ne.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};ri.envelopedDataValidator={name:"EnvelopedData",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(gf)};ri.encryptedDataValidator={name:"EncryptedData",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"version"}].concat(gf)};var lb={name:"SignerInfo",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:ne.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:ne.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};ri.signedDataValidator={name:"SignedData",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},pf,{name:"SignedData.Certificates",tagClass:ne.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:ne.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SET,capture:"signerInfos",optional:!0,value:[lb]}]};ri.recipientInfoValidator={name:"RecipientInfo",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:ne.Class.UNIVERSAL,type:ne.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:ne.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:ne.Class.UNIVERSAL,type:ne.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]};var hn=we;hn.mgf=hn.mgf||{};var ub=hn.mgf.mgf1=hn.mgf1=hn.mgf1||{};ub.create=function(e){var t={generate:function(r,n){for(var i=new hn.util.ByteBuffer,s=Math.ceil(n/e.digestLength),a=0;a<s;a++){var o=new hn.util.ByteBuffer;o.putInt32(a),e.start(),e.update(r+o.getBytes()),i.putBuffer(e.digest())}return i.truncate(i.length()-n),i.getBytes()}};return t};var Ts=we;Ts.mgf=Ts.mgf||{};Ts.mgf.mgf1=Ts.mgf1;var sn=we,cb=sn.pss=sn.pss||{};cb.create=function(e){arguments.length===3&&(e={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var t=e.md,r=e.mgf,n=t.digestLength,i=e.salt||null;typeof i=="string"&&(i=sn.util.createBuffer(i));var s;if("saltLength"in e)s=e.saltLength;else if(i!==null)s=i.length();else throw new Error("Salt length not specified or specific salt not given.");if(i!==null&&i.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=e.prng||sn.random,o={};return o.encode=function(l,u){var c,f=u-1,d=Math.ceil(f/8),p=l.digest().getBytes();if(d<n+s+2)throw new Error("Message is too long to encrypt.");var g;i===null?g=a.getBytesSync(s):g=i.bytes();var m=new sn.util.ByteBuffer;m.fillWithByte(0,8),m.putBytes(p),m.putBytes(g),t.start(),t.update(m.getBytes());var T=t.digest().getBytes(),x=new sn.util.ByteBuffer;x.fillWithByte(0,d-s-n-2),x.putByte(1),x.putBytes(g);var B=x.getBytes(),v=d-n-1,_=r.generate(T,v),w="";for(c=0;c<v;c++)w+=String.fromCharCode(B.charCodeAt(c)^_.charCodeAt(c));var I=65280>>8*d-f&255;return w=String.fromCharCode(w.charCodeAt(0)&~I)+w.substr(1),w+T+String.fromCharCode(188)},o.verify=function(l,u,c){var f,d=c-1,p=Math.ceil(d/8);if(u=u.substr(-p),p<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(u.charCodeAt(p-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var g=p-n-1,m=u.substr(0,g),T=u.substr(g,n),x=65280>>8*p-d&255;if((m.charCodeAt(0)&x)!==0)throw new Error("Bits beyond keysize not zero as expected.");var B=r.generate(T,g),v="";for(f=0;f<g;f++)v+=String.fromCharCode(m.charCodeAt(f)^B.charCodeAt(f));v=String.fromCharCode(v.charCodeAt(0)&~x)+v.substr(1);var _=p-n-s-2;for(f=0;f<_;f++)if(v.charCodeAt(f)!==0)throw new Error("Leftmost octets not zero as expected");if(v.charCodeAt(_)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var w=v.substr(-s),I=new sn.util.ByteBuffer;I.fillWithByte(0,8),I.putBytes(l),I.putBytes(w),t.start(),t.update(I.getBytes());var k=t.digest().getBytes();return T===k},o};var he=we,b=he.asn1,X=he.pki=he.pki||{},De=X.oids,ht={};ht.CN=De.commonName;ht.commonName="CN";ht.C=De.countryName;ht.countryName="C";ht.L=De.localityName;ht.localityName="L";ht.ST=De.stateOrProvinceName;ht.stateOrProvinceName="ST";ht.O=De.organizationName;ht.organizationName="O";ht.OU=De.organizationalUnitName;ht.organizationalUnitName="OU";ht.E=De.emailAddress;ht.emailAddress="E";var yf=he.pki.rsa.publicKeyValidator,fb={name:"Certificate",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:b.Class.UNIVERSAL,type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:b.Class.UNIVERSAL,type:b.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:b.Class.UNIVERSAL,type:b.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},yf,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:b.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},hb={name:"rsapss",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:b.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:b.Class.UNIVERSAL,type:b.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:b.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:b.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:b.Class.UNIVERSAL,type:b.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},db={name:"CertificationRequestInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},yf,{name:"CertificationRequestInfo.attributes",tagClass:b.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:b.Class.UNIVERSAL,type:b.Type.SET,constructed:!0}]}]}]},pb={name:"CertificationRequest",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[db,{name:"CertificationRequest.signatureAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:b.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:b.Class.UNIVERSAL,type:b.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};X.RDNAttributesAsArray=function(e,t){for(var r=[],n,i,s,a=0;a<e.value.length;++a){n=e.value[a];for(var o=0;o<n.value.length;++o)s={},i=n.value[o],s.type=b.derToOid(i.value[0].value),s.value=i.value[1].value,s.valueTagClass=i.value[1].type,s.type in De&&(s.name=De[s.type],s.name in ht&&(s.shortName=ht[s.name])),t&&(t.update(s.type),t.update(s.value)),r.push(s)}return r};X.CRIAttributesAsArray=function(e){for(var t=[],r=0;r<e.length;++r)for(var n=e[r],i=b.derToOid(n.value[0].value),s=n.value[1].value,a=0;a<s.length;++a){var o={};if(o.type=i,o.value=s[a].value,o.valueTagClass=s[a].type,o.type in De&&(o.name=De[o.type],o.name in ht&&(o.shortName=ht[o.name])),o.type===De.extensionRequest){o.extensions=[];for(var l=0;l<o.value.length;++l)o.extensions.push(X.certificateExtensionFromAsn1(o.value[l]))}t.push(o)}return t};function Zr(e,t){typeof t=="string"&&(t={shortName:t});for(var r=null,n,i=0;r===null&&i<e.attributes.length;++i)n=e.attributes[i],(t.type&&t.type===n.type||t.name&&t.name===n.name||t.shortName&&t.shortName===n.shortName)&&(r=n);return r}var xs=function(e,t,r){var n={};if(e!==De["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:De.sha1},mgf:{algorithmOid:De.mgf1,hash:{algorithmOid:De.sha1}},saltLength:20});var i={},s=[];if(!b.validate(t,hb,i,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return i.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=b.derToOid(i.hashOid)),i.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=b.derToOid(i.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=b.derToOid(i.maskGenHashOid)),i.saltLength!==void 0&&(n.saltLength=i.saltLength.charCodeAt(0)),n},Js=function(e){switch(De[e.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return he.md.sha1.create();case"md5WithRSAEncryption":return he.md.md5.create();case"sha256WithRSAEncryption":return he.md.sha256.create();case"sha384WithRSAEncryption":return he.md.sha384.create();case"sha512WithRSAEncryption":return he.md.sha512.create();case"RSASSA-PSS":return he.md.sha256.create();default:var t=new Error("Could not compute "+e.type+" digest. Unknown signature OID.");throw t.signatureOid=e.signatureOid,t}},mf=function(e){var t=e.certificate,r;switch(t.signatureOid){case De.sha1WithRSAEncryption:case De.sha1WithRSASignature:break;case De["RSASSA-PSS"]:var n,i;if(n=De[t.signatureParameters.mgf.hash.algorithmOid],n===void 0||he.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=t.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(i=De[t.signatureParameters.mgf.algorithmOid],i===void 0||he.mgf[i]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=t.signatureParameters.mgf.algorithmOid,s.name=i,s}if(i=he.mgf[i].create(he.md[n].create()),n=De[t.signatureParameters.hash.algorithmOid],n===void 0||he.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=t.signatureParameters.hash.algorithmOid,s.name=n,s}r=he.pss.create(he.md[n].create(),i,t.signatureParameters.saltLength);break}return t.publicKey.verify(e.md.digest().getBytes(),e.signature,r)};X.certificateFromPem=function(e,t,r){var n=he.pem.decode(e)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var i=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=b.fromDer(n.body,r);return X.certificateFromAsn1(s,t)};X.certificateToPem=function(e,t){var r={type:"CERTIFICATE",body:b.toDer(X.certificateToAsn1(e)).getBytes()};return he.pem.encode(r,{maxline:t})};X.publicKeyFromPem=function(e){var t=he.pem.decode(e)[0];if(t.type!=="PUBLIC KEY"&&t.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=b.fromDer(t.body);return X.publicKeyFromAsn1(n)};X.publicKeyToPem=function(e,t){var r={type:"PUBLIC KEY",body:b.toDer(X.publicKeyToAsn1(e)).getBytes()};return he.pem.encode(r,{maxline:t})};X.publicKeyToRSAPublicKeyPem=function(e,t){var r={type:"RSA PUBLIC KEY",body:b.toDer(X.publicKeyToRSAPublicKey(e)).getBytes()};return he.pem.encode(r,{maxline:t})};X.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||he.md.sha1.create(),n=t.type||"RSAPublicKey",i;switch(n){case"RSAPublicKey":i=b.toDer(X.publicKeyToRSAPublicKey(e)).getBytes();break;case"SubjectPublicKeyInfo":i=b.toDer(X.publicKeyToAsn1(e)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+t.type+'".')}r.start(),r.update(i);var s=r.digest();if(t.encoding==="hex"){var a=s.toHex();return t.delimiter?a.match(/.{2}/g).join(t.delimiter):a}else{if(t.encoding==="binary")return s.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return s};X.certificationRequestFromPem=function(e,t,r){var n=he.pem.decode(e)[0];if(n.type!=="CERTIFICATE REQUEST"){var i=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw i.headerType=n.type,i}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=b.fromDer(n.body,r);return X.certificationRequestFromAsn1(s,t)};X.certificationRequestToPem=function(e,t){var r={type:"CERTIFICATE REQUEST",body:b.toDer(X.certificationRequestToAsn1(e)).getBytes()};return he.pem.encode(r,{maxline:t})};X.createCertificate=function(){var e={};return e.version=2,e.serialNumber="00",e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.validity={},e.validity.notBefore=new Date,e.validity.notAfter=new Date,e.issuer={},e.issuer.getField=function(t){return Zr(e.issuer,t)},e.issuer.addField=function(t){Yt([t]),e.issuer.attributes.push(t)},e.issuer.attributes=[],e.issuer.hash=null,e.subject={},e.subject.getField=function(t){return Zr(e.subject,t)},e.subject.addField=function(t){Yt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.extensions=[],e.publicKey=null,e.md=null,e.setSubject=function(t,r){Yt(t),e.subject.attributes=t,delete e.subject.uniqueId,r&&(e.subject.uniqueId=r),e.subject.hash=null},e.setIssuer=function(t,r){Yt(t),e.issuer.attributes=t,delete e.issuer.uniqueId,r&&(e.issuer.uniqueId=r),e.issuer.hash=null},e.setExtensions=function(t){for(var r=0;r<t.length;++r)vf(t[r],{cert:e});e.extensions=t},e.getExtension=function(t){typeof t=="string"&&(t={name:t});for(var r=null,n,i=0;r===null&&i<e.extensions.length;++i)n=e.extensions[i],(t.id&&n.id===t.id||t.name&&n.name===t.name)&&(r=n);return r},e.sign=function(t,r){e.md=r||he.md.sha1.create();var n=De[e.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=n,e.tbsCertificate=X.getTBSCertificate(e);var s=b.toDer(e.tbsCertificate);e.md.update(s.getBytes()),e.signature=t.sign(e.md)},e.verify=function(t){var r=!1;if(!e.issued(t)){var n=t.issuer,i=e.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=i.attributes,s.actualIssuer=n.attributes,s}var a=t.md;if(a===null){a=Js({signatureOid:t.signatureOid,type:"certificate"});var o=t.tbsCertificate||X.getTBSCertificate(t),l=b.toDer(o);a.update(l.getBytes())}return a!==null&&(r=mf({certificate:e,md:a,signature:t.signature})),r},e.isIssuer=function(t){var r=!1,n=e.issuer,i=t.subject;if(n.hash&&i.hash)r=n.hash===i.hash;else if(n.attributes.length===i.attributes.length){r=!0;for(var s,a,o=0;r&&o<n.attributes.length;++o)s=n.attributes[o],a=i.attributes[o],(s.type!==a.type||s.value!==a.value)&&(r=!1)}return r},e.issued=function(t){return t.isIssuer(e)},e.generateSubjectKeyIdentifier=function(){return X.getPublicKeyFingerprint(e.publicKey,{type:"RSAPublicKey"})},e.verifySubjectKeyIdentifier=function(){for(var t=De.subjectKeyIdentifier,r=0;r<e.extensions.length;++r){var n=e.extensions[r];if(n.id===t){var i=e.generateSubjectKeyIdentifier().getBytes();return he.util.hexToBytes(n.subjectKeyIdentifier)===i}}return!1},e};X.certificateFromAsn1=function(e,t){var r={},n=[];if(!b.validate(e,fb,r,n)){var i=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw i.errors=n,i}var s=b.derToOid(r.publicKeyOid);if(s!==X.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=X.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var o=he.util.createBuffer(r.certSerialNumber);a.serialNumber=o.toHex(),a.signatureOid=he.asn1.derToOid(r.certSignatureOid),a.signatureParameters=xs(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=he.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=xs(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var l=[];if(r.certValidity1UTCTime!==void 0&&l.push(b.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&l.push(b.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&l.push(b.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&l.push(b.generalizedTimeToDate(r.certValidity4GeneralizedTime)),l.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(l.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=l[0],a.validity.notAfter=l[1],a.tbsCertificate=r.tbsCertificate,t){a.md=Js({signatureOid:a.signatureOid,type:"certificate"});var u=b.toDer(a.tbsCertificate);a.md.update(u.getBytes())}var c=he.md.sha1.create(),f=b.toDer(r.certIssuer);c.update(f.getBytes()),a.issuer.getField=function(g){return Zr(a.issuer,g)},a.issuer.addField=function(g){Yt([g]),a.issuer.attributes.push(g)},a.issuer.attributes=X.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=c.digest().toHex();var d=he.md.sha1.create(),p=b.toDer(r.certSubject);return d.update(p.getBytes()),a.subject.getField=function(g){return Zr(a.subject,g)},a.subject.addField=function(g){Yt([g]),a.subject.attributes.push(g)},a.subject.attributes=X.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=d.digest().toHex(),r.certExtensions?a.extensions=X.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=X.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};X.certificateExtensionsFromAsn1=function(e){for(var t=[],r=0;r<e.value.length;++r)for(var n=e.value[r],i=0;i<n.value.length;++i)t.push(X.certificateExtensionFromAsn1(n.value[i]));return t};X.certificateExtensionFromAsn1=function(e){var t={};if(t.id=b.derToOid(e.value[0].value),t.critical=!1,e.value[1].type===b.Type.BOOLEAN?(t.critical=e.value[1].value.charCodeAt(0)!==0,t.value=e.value[2].value):t.value=e.value[1].value,t.id in De){if(t.name=De[t.id],t.name==="keyUsage"){var r=b.fromDer(t.value),n=0,i=0;r.value.length>1&&(n=r.value.charCodeAt(1),i=r.value.length>2?r.value.charCodeAt(2):0),t.digitalSignature=(n&128)===128,t.nonRepudiation=(n&64)===64,t.keyEncipherment=(n&32)===32,t.dataEncipherment=(n&16)===16,t.keyAgreement=(n&8)===8,t.keyCertSign=(n&4)===4,t.cRLSign=(n&2)===2,t.encipherOnly=(n&1)===1,t.decipherOnly=(i&128)===128}else if(t.name==="basicConstraints"){var r=b.fromDer(t.value);r.value.length>0&&r.value[0].type===b.Type.BOOLEAN?t.cA=r.value[0].value.charCodeAt(0)!==0:t.cA=!1;var s=null;r.value.length>0&&r.value[0].type===b.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(t.pathLenConstraint=b.derToInteger(s))}else if(t.name==="extKeyUsage")for(var r=b.fromDer(t.value),a=0;a<r.value.length;++a){var o=b.derToOid(r.value[a].value);o in De?t[De[o]]=!0:t[o]=!0}else if(t.name==="nsCertType"){var r=b.fromDer(t.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),t.client=(n&128)===128,t.server=(n&64)===64,t.email=(n&32)===32,t.objsign=(n&16)===16,t.reserved=(n&8)===8,t.sslCA=(n&4)===4,t.emailCA=(n&2)===2,t.objCA=(n&1)===1}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.altNames=[];for(var l,r=b.fromDer(t.value),u=0;u<r.value.length;++u){l=r.value[u];var c={type:l.type,value:l.value};switch(t.altNames.push(c),l.type){case 1:case 2:case 6:break;case 7:c.ip=he.util.bytesToIP(l.value);break;case 8:c.oid=b.derToOid(l.value);break}}}else if(t.name==="subjectKeyIdentifier"){var r=b.fromDer(t.value);t.subjectKeyIdentifier=he.util.bytesToHex(r.value)}}return t};X.certificationRequestFromAsn1=function(e,t){var r={},n=[];if(!b.validate(e,pb,r,n)){var i=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw i.errors=n,i}var s=b.derToOid(r.publicKeyOid);if(s!==X.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=X.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=he.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=xs(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=he.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=xs(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,t){a.md=Js({signatureOid:a.signatureOid,type:"certification request"});var o=b.toDer(a.certificationRequestInfo);a.md.update(o.getBytes())}var l=he.md.sha1.create();return a.subject.getField=function(u){return Zr(a.subject,u)},a.subject.addField=function(u){Yt([u]),a.subject.attributes.push(u)},a.subject.attributes=X.RDNAttributesAsArray(r.certificationRequestInfoSubject,l),a.subject.hash=l.digest().toHex(),a.publicKey=X.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(u){return Zr(a,u)},a.addAttribute=function(u){Yt([u]),a.attributes.push(u)},a.attributes=X.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};X.createCertificationRequest=function(){var e={};return e.version=0,e.signatureOid=null,e.signature=null,e.siginfo={},e.siginfo.algorithmOid=null,e.subject={},e.subject.getField=function(t){return Zr(e.subject,t)},e.subject.addField=function(t){Yt([t]),e.subject.attributes.push(t)},e.subject.attributes=[],e.subject.hash=null,e.publicKey=null,e.attributes=[],e.getAttribute=function(t){return Zr(e,t)},e.addAttribute=function(t){Yt([t]),e.attributes.push(t)},e.md=null,e.setSubject=function(t){Yt(t),e.subject.attributes=t,e.subject.hash=null},e.setAttributes=function(t){Yt(t),e.attributes=t},e.sign=function(t,r){e.md=r||he.md.sha1.create();var n=De[e.md.algorithm+"WithRSAEncryption"];if(!n){var i=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw i.algorithm=e.md.algorithm,i}e.signatureOid=e.siginfo.algorithmOid=n,e.certificationRequestInfo=X.getCertificationRequestInfo(e);var s=b.toDer(e.certificationRequestInfo);e.md.update(s.getBytes()),e.signature=t.sign(e.md)},e.verify=function(){var t=!1,r=e.md;if(r===null){r=Js({signatureOid:e.signatureOid,type:"certification request"});var n=e.certificationRequestInfo||X.getCertificationRequestInfo(e),i=b.toDer(n);r.update(i.getBytes())}return r!==null&&(t=mf({certificate:e,md:r,signature:e.signature})),t},e};function qn(e){for(var t=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),r,n,i=e.attributes,s=0;s<i.length;++s){r=i[s];var a=r.value,o=b.Type.PRINTABLESTRING;"valueTagClass"in r&&(o=r.valueTagClass,o===b.Type.UTF8&&(a=he.util.encodeUtf8(a))),n=b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(r.type).getBytes()),b.create(b.Class.UNIVERSAL,o,!1,a)])]),t.value.push(n)}return t}function Yt(e){for(var t,r=0;r<e.length;++r){if(t=e[r],typeof t.name>"u"&&(t.type&&t.type in X.oids?t.name=X.oids[t.type]:t.shortName&&t.shortName in ht&&(t.name=X.oids[ht[t.shortName]])),typeof t.type>"u")if(t.name&&t.name in X.oids)t.type=X.oids[t.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=t,n}if(typeof t.shortName>"u"&&t.name&&t.name in ht&&(t.shortName=ht[t.name]),t.type===De.extensionRequest&&(t.valueConstructed=!0,t.valueTagClass=b.Type.SEQUENCE,!t.value&&t.extensions)){t.value=[];for(var i=0;i<t.extensions.length;++i)t.value.push(X.certificateExtensionToAsn1(vf(t.extensions[i])))}if(typeof t.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=t,n}}}function vf(e,t){if(t=t||{},typeof e.name>"u"&&e.id&&e.id in X.oids&&(e.name=X.oids[e.id]),typeof e.id>"u")if(e.name&&e.name in X.oids)e.id=X.oids[e.name];else{var r=new Error("Extension ID not specified.");throw r.extension=e,r}if(typeof e.value<"u")return e;if(e.name==="keyUsage"){var n=0,i=0,s=0;e.digitalSignature&&(i|=128,n=7),e.nonRepudiation&&(i|=64,n=6),e.keyEncipherment&&(i|=32,n=5),e.dataEncipherment&&(i|=16,n=4),e.keyAgreement&&(i|=8,n=3),e.keyCertSign&&(i|=4,n=2),e.cRLSign&&(i|=2,n=1),e.encipherOnly&&(i|=1,n=0),e.decipherOnly&&(s|=128,n=7);var a=String.fromCharCode(n);s!==0?a+=String.fromCharCode(i)+String.fromCharCode(s):i!==0&&(a+=String.fromCharCode(i)),e.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,a)}else if(e.name==="basicConstraints")e.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),e.cA&&e.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255))),"pathLenConstraint"in e&&e.value.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(e.pathLenConstraint).getBytes()));else if(e.name==="extKeyUsage"){e.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);var o=e.value.value;for(var l in e)e[l]===!0&&(l in De?o.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(De[l]).getBytes())):l.indexOf(".")!==-1&&o.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(l).getBytes())))}else if(e.name==="nsCertType"){var n=0,i=0;e.client&&(i|=128,n=7),e.server&&(i|=64,n=6),e.email&&(i|=32,n=5),e.objsign&&(i|=16,n=4),e.reserved&&(i|=8,n=3),e.sslCA&&(i|=4,n=2),e.emailCA&&(i|=2,n=1),e.objCA&&(i|=1,n=0);var a=String.fromCharCode(n);i!==0&&(a+=String.fromCharCode(i)),e.value=b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,a)}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);for(var u,c=0;c<e.altNames.length;++c){u=e.altNames[c];var a=u.value;if(u.type===7&&u.ip){if(a=he.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else u.type===8&&(u.oid?a=b.oidToDer(b.oidToDer(u.oid)):a=b.oidToDer(a));e.value.value.push(b.create(b.Class.CONTEXT_SPECIFIC,u.type,!1,a))}}else if(e.name==="nsComment"&&t.cert){if(!/^[\x00-\x7F]*$/.test(e.comment)||e.comment.length<1||e.comment.length>128)throw new Error('Invalid "nsComment" content.');e.value=b.create(b.Class.UNIVERSAL,b.Type.IA5STRING,!1,e.comment)}else if(e.name==="subjectKeyIdentifier"&&t.cert){var f=t.cert.generateSubjectKeyIdentifier();e.subjectKeyIdentifier=f.toHex(),e.value=b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f.getBytes())}else if(e.name==="authorityKeyIdentifier"&&t.cert){e.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);var o=e.value.value;if(e.keyIdentifier){var d=e.keyIdentifier===!0?t.cert.generateSubjectKeyIdentifier().getBytes():e.keyIdentifier;o.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!1,d))}if(e.authorityCertIssuer){var p=[b.create(b.Class.CONTEXT_SPECIFIC,4,!0,[qn(e.authorityCertIssuer===!0?t.cert.issuer:e.authorityCertIssuer)])];o.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,p))}if(e.serialNumber){var g=he.util.hexToBytes(e.serialNumber===!0?t.cert.serialNumber:e.serialNumber);o.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!1,g))}}else if(e.name==="cRLDistributionPoints"){e.value=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);for(var o=e.value.value,m=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]),T=b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[]),u,c=0;c<e.altNames.length;++c){u=e.altNames[c];var a=u.value;if(u.type===7&&u.ip){if(a=he.util.bytesFromIP(u.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=e,r}}else u.type===8&&(u.oid?a=b.oidToDer(b.oidToDer(u.oid)):a=b.oidToDer(a));T.value.push(b.create(b.Class.CONTEXT_SPECIFIC,u.type,!1,a))}m.value.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[T])),o.push(m)}if(typeof e.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=e,r}return e}function Fo(e,t){switch(e){case De["RSASSA-PSS"]:var r=[];return t.hash.algorithmOid!==void 0&&r.push(b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(t.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])])),t.mgf.algorithmOid!==void 0&&r.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(t.mgf.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(t.mgf.hash.algorithmOid).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])])])),t.saltLength!==void 0&&r.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(t.saltLength).getBytes())])),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,r);default:return b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")}}function gb(e){var t=b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[]);if(e.attributes.length===0)return t;for(var r=e.attributes,n=0;n<r.length;++n){var i=r[n],s=i.value,a=b.Type.UTF8;"valueTagClass"in i&&(a=i.valueTagClass),a===b.Type.UTF8&&(s=he.util.encodeUtf8(s));var o=!1;"valueConstructed"in i&&(o=i.valueConstructed);var l=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(i.type).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SET,!0,[b.create(b.Class.UNIVERSAL,a,o,s)])]);t.value.push(l)}return t}var yb=new Date("1950-01-01T00:00:00Z"),mb=new Date("2050-01-01T00:00:00Z");function su(e){return e>=yb&&e<mb?b.create(b.Class.UNIVERSAL,b.Type.UTCTIME,!1,b.dateToUtcTime(e)):b.create(b.Class.UNIVERSAL,b.Type.GENERALIZEDTIME,!1,b.dateToGeneralizedTime(e))}X.getTBSCertificate=function(e){var t=su(e.validity.notBefore),r=su(e.validity.notAfter),n=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.CONTEXT_SPECIFIC,0,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(e.version).getBytes())]),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,he.util.hexToBytes(e.serialNumber)),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(e.siginfo.algorithmOid).getBytes()),Fo(e.siginfo.algorithmOid,e.siginfo.parameters)]),qn(e.issuer),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[t,r]),qn(e.subject),X.publicKeyToAsn1(e.publicKey)]);return e.issuer.uniqueId&&n.value.push(b.create(b.Class.CONTEXT_SPECIFIC,1,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+e.issuer.uniqueId)])),e.subject.uniqueId&&n.value.push(b.create(b.Class.CONTEXT_SPECIFIC,2,!0,[b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+e.subject.uniqueId)])),e.extensions.length>0&&n.value.push(X.certificateExtensionsToAsn1(e.extensions)),n};X.getCertificationRequestInfo=function(e){var t=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,b.integerToDer(e.version).getBytes()),qn(e.subject),X.publicKeyToAsn1(e.publicKey),gb(e)]);return t};X.distinguishedNameToAsn1=function(e){return qn(e)};X.certificateToAsn1=function(e){var t=e.tbsCertificate||X.getTBSCertificate(e);return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[t,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(e.signatureOid).getBytes()),Fo(e.signatureOid,e.signatureParameters)]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};X.certificateExtensionsToAsn1=function(e){var t=b.create(b.Class.CONTEXT_SPECIFIC,3,!0,[]),r=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);t.value.push(r);for(var n=0;n<e.length;++n)r.value.push(X.certificateExtensionToAsn1(e[n]));return t};X.certificateExtensionToAsn1=function(e){var t=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[]);t.value.push(b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(e.id).getBytes())),e.critical&&t.value.push(b.create(b.Class.UNIVERSAL,b.Type.BOOLEAN,!1,String.fromCharCode(255)));var r=e.value;return typeof e.value!="string"&&(r=b.toDer(r).getBytes()),t.value.push(b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,r)),t};X.certificationRequestToAsn1=function(e){var t=e.certificationRequestInfo||X.getCertificationRequestInfo(e);return b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[t,b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(e.signatureOid).getBytes()),Fo(e.signatureOid,e.signatureParameters)]),b.create(b.Class.UNIVERSAL,b.Type.BITSTRING,!1,String.fromCharCode(0)+e.signature)])};X.createCaStore=function(e){var t={certs:{}};t.getIssuer=function(a){var o=r(a.issuer);return o},t.addCertificate=function(a){if(typeof a=="string"&&(a=he.pki.certificateFromPem(a)),n(a.subject),!t.hasCertificate(a))if(a.subject.hash in t.certs){var o=t.certs[a.subject.hash];he.util.isArray(o)||(o=[o]),o.push(a),t.certs[a.subject.hash]=o}else t.certs[a.subject.hash]=a},t.hasCertificate=function(a){typeof a=="string"&&(a=he.pki.certificateFromPem(a));var o=r(a.subject);if(!o)return!1;he.util.isArray(o)||(o=[o]);for(var l=b.toDer(X.certificateToAsn1(a)).getBytes(),u=0;u<o.length;++u){var c=b.toDer(X.certificateToAsn1(o[u])).getBytes();if(l===c)return!0}return!1},t.listAllCertificates=function(){var a=[];for(var o in t.certs)if(t.certs.hasOwnProperty(o)){var l=t.certs[o];if(!he.util.isArray(l))a.push(l);else for(var u=0;u<l.length;++u)a.push(l[u])}return a},t.removeCertificate=function(a){var o;if(typeof a=="string"&&(a=he.pki.certificateFromPem(a)),n(a.subject),!t.hasCertificate(a))return null;var l=r(a.subject);if(!he.util.isArray(l))return o=t.certs[a.subject.hash],delete t.certs[a.subject.hash],o;for(var u=b.toDer(X.certificateToAsn1(a)).getBytes(),c=0;c<l.length;++c){var f=b.toDer(X.certificateToAsn1(l[c])).getBytes();u===f&&(o=l[c],l.splice(c,1))}return l.length===0&&delete t.certs[a.subject.hash],o};function r(a){return n(a),t.certs[a.hash]||null}function n(a){if(!a.hash){var o=he.md.sha1.create();a.attributes=X.RDNAttributesAsArray(qn(a),o),a.hash=o.digest().toHex()}}if(e)for(var i=0;i<e.length;++i){var s=e[i];t.addCertificate(s)}return t};X.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};X.verifyCertificateChain=function(e,t,r){typeof r=="function"&&(r={verify:r}),r=r||{},t=t.slice(0);var n=t.slice(0),i=r.validityCheckDate;typeof i>"u"&&(i=new Date);var s=!0,a=null,o=0;do{var l=t.shift(),u=null,c=!1;if(i&&(i<l.validity.notBefore||i>l.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:X.certificateError.certificate_expired,notBefore:l.validity.notBefore,notAfter:l.validity.notAfter,now:i}),a===null){if(u=t[0]||e.getIssuer(l),u===null&&l.isIssuer(l)&&(c=!0,u=l),u){var f=u;he.util.isArray(f)||(f=[f]);for(var d=!1;!d&&f.length>0;){u=f.shift();try{d=u.verify(l)}catch{}}d||(a={message:"Certificate signature is invalid.",error:X.certificateError.bad_certificate})}a===null&&(!u||c)&&!e.hasCertificate(l)&&(a={message:"Certificate is not trusted.",error:X.certificateError.unknown_ca})}if(a===null&&u&&!l.isIssuer(u)&&(a={message:"Certificate issuer is invalid.",error:X.certificateError.bad_certificate}),a===null)for(var p={keyUsage:!0,basicConstraints:!0},g=0;a===null&&g<l.extensions.length;++g){var m=l.extensions[g];m.critical&&!(m.name in p)&&(a={message:"Certificate has an unsupported critical extension.",error:X.certificateError.unsupported_certificate})}if(a===null&&(!s||t.length===0&&(!u||c))){var T=l.getExtension("basicConstraints"),x=l.getExtension("keyUsage");if(x!==null&&(!x.keyCertSign||T===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:X.certificateError.bad_certificate}),a===null&&T!==null&&!T.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:X.certificateError.bad_certificate}),a===null&&x!==null&&"pathLenConstraint"in T){var B=o-1;B>T.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:X.certificateError.bad_certificate})}}var v=a===null?!0:a.error,_=r.verify?r.verify(v,o,n):v;if(_===!0)a=null;else throw v===!0&&(a={message:"The application rejected the certificate.",error:X.certificateError.bad_certificate}),(_||_===0)&&(typeof _=="object"&&!he.util.isArray(_)?(_.message&&(a.message=_.message),_.error&&(a.error=_.error)):typeof _=="string"&&(a.error=_)),a;s=!1,++o}while(t.length>0);return!0};var je=we,R=je.asn1,xe=je.pki,Ai=je.pkcs12=je.pkcs12||{},Cf={name:"ContentInfo",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:R.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},vb={name:"PFX",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,capture:"version"},Cf,{name:"PFX.macData",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:R.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:R.Class.UNIVERSAL,type:R.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:R.Class.UNIVERSAL,type:R.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:R.Class.UNIVERSAL,type:R.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Cb={name:"SafeBag",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:R.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:R.Class.UNIVERSAL,type:R.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},bb={name:"Attribute",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:R.Class.UNIVERSAL,type:R.Type.SET,constructed:!0,capture:"values"}]},Eb={name:"CertBag",tagClass:R.Class.UNIVERSAL,type:R.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:R.Class.UNIVERSAL,type:R.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:R.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:R.Class.UNIVERSAL,type:R.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function ai(e,t,r,n){for(var i=[],s=0;s<e.length;s++)for(var a=0;a<e[s].safeBags.length;a++){var o=e[s].safeBags[a];if(!(n!==void 0&&o.type!==n)){if(t===null){i.push(o);continue}o.attributes[t]!==void 0&&o.attributes[t].indexOf(r)>=0&&i.push(o)}}return i}Ai.pkcs12FromAsn1=function(e,t,r){typeof t=="string"?(r=t,t=!0):t===void 0&&(t=!0);var n={},i=[];if(!R.validate(e,vb,n,i)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var a={version:n.version.charCodeAt(0),safeContents:[],getBags:function(T){var x={},B;return"localKeyId"in T?B=T.localKeyId:"localKeyIdHex"in T&&(B=je.util.hexToBytes(T.localKeyIdHex)),B===void 0&&!("friendlyName"in T)&&"bagType"in T&&(x[T.bagType]=ai(a.safeContents,null,null,T.bagType)),B!==void 0&&(x.localKeyId=ai(a.safeContents,"localKeyId",B,T.bagType)),"friendlyName"in T&&(x.friendlyName=ai(a.safeContents,"friendlyName",T.friendlyName,T.bagType)),x},getBagsByFriendlyName:function(T,x){return ai(a.safeContents,"friendlyName",T,x)},getBagsByLocalKeyId:function(T,x){return ai(a.safeContents,"localKeyId",T,x)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(R.derToOid(n.contentType)!==xe.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=R.derToOid(n.contentType),s}var o=n.content.value[0];if(o.tagClass!==R.Class.UNIVERSAL||o.type!==R.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(o=Vo(o),n.mac){var l=null,u=0,c=R.derToOid(n.macAlgorithm);switch(c){case xe.oids.sha1:l=je.md.sha1.create(),u=20;break;case xe.oids.sha256:l=je.md.sha256.create(),u=32;break;case xe.oids.sha384:l=je.md.sha384.create(),u=48;break;case xe.oids.sha512:l=je.md.sha512.create(),u=64;break;case xe.oids.md5:l=je.md.md5.create(),u=16;break}if(l===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+c);var f=new je.util.ByteBuffer(n.macSalt),d="macIterations"in n?parseInt(je.util.bytesToHex(n.macIterations),16):1,p=Ai.generateKey(r,f,3,d,u,l),g=je.hmac.create();g.start(l,p),g.update(o.value);var m=g.getMac();if(m.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return Sb(a,o.value,t,r),a};function Vo(e){if(e.composed||e.constructed){for(var t=je.util.createBuffer(),r=0;r<e.value.length;++r)t.putBytes(e.value[r].value);e.composed=e.constructed=!1,e.value=t.getBytes()}return e}function Sb(e,t,r,n){if(t=R.fromDer(t,r),t.tagClass!==R.Class.UNIVERSAL||t.type!==R.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var i=0;i<t.value.length;i++){var s=t.value[i],a={},o=[];if(!R.validate(s,Cf,a,o)){var l=new Error("Cannot read ContentInfo.");throw l.errors=o,l}var u={encrypted:!1},c=null,f=a.content.value[0];switch(R.derToOid(a.contentType)){case xe.oids.data:if(f.tagClass!==R.Class.UNIVERSAL||f.type!==R.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");c=Vo(f).value;break;case xe.oids.encryptedData:c=_b(f,n),u.encrypted=!0;break;default:var l=new Error("Unsupported PKCS#12 contentType.");throw l.contentType=R.derToOid(a.contentType),l}u.safeBags=wb(c,r,n),e.safeContents.push(u)}}function _b(e,t){var r={},n=[];if(!R.validate(e,je.pkcs7.asn1.encryptedDataValidator,r,n)){var i=new Error("Cannot read EncryptedContentInfo.");throw i.errors=n,i}var s=R.derToOid(r.contentType);if(s!==xe.oids.data){var i=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw i.oid=s,i}s=R.derToOid(r.encAlgorithm);var a=xe.pbe.getCipher(s,r.encParameter,t),o=Vo(r.encryptedContentAsn1),l=je.util.createBuffer(o.value);if(a.update(l),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}function wb(e,t,r){if(!t&&e.length===0)return[];if(e=R.fromDer(e,t),e.tagClass!==R.Class.UNIVERSAL||e.type!==R.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],i=0;i<e.value.length;i++){var s=e.value[i],a={},o=[];if(!R.validate(s,Cb,a,o)){var l=new Error("Cannot read SafeBag.");throw l.errors=o,l}var u={type:R.derToOid(a.bagId),attributes:Tb(a.bagAttributes)};n.push(u);var c,f,d=a.bagValue.value[0];switch(u.type){case xe.oids.pkcs8ShroudedKeyBag:if(d=xe.decryptPrivateKeyInfo(d,r),d===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case xe.oids.keyBag:try{u.key=xe.privateKeyFromAsn1(d)}catch{u.key=null,u.asn1=d}continue;case xe.oids.certBag:c=Eb,f=function(){if(R.derToOid(a.certId)!==xe.oids.x509Certificate){var g=new Error("Unsupported certificate type, only X.509 supported.");throw g.oid=R.derToOid(a.certId),g}var m=R.fromDer(a.cert,t);try{u.cert=xe.certificateFromAsn1(m,!0)}catch{u.cert=null,u.asn1=m}};break;default:var l=new Error("Unsupported PKCS#12 SafeBag type.");throw l.oid=u.type,l}if(c!==void 0&&!R.validate(d,c,a,o)){var l=new Error("Cannot read PKCS#12 "+c.name);throw l.errors=o,l}f()}return n}function Tb(e){var t={};if(e!==void 0)for(var r=0;r<e.length;++r){var n={},i=[];if(!R.validate(e[r],bb,n,i)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=i,s}var a=R.derToOid(n.oid);if(xe.oids[a]!==void 0){t[xe.oids[a]]=[];for(var o=0;o<n.values.length;++o)t[xe.oids[a]].push(n.values[o].value)}}return t}Ai.toPkcs12Asn1=function(e,t,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var i=n.localKeyId,s;if(i!==null)i=je.util.hexToBytes(i);else if(n.generateLocalKeyId)if(t){var a=je.util.isArray(t)?t[0]:t;typeof a=="string"&&(a=xe.certificateFromPem(a));var o=je.md.sha1.create();o.update(R.toDer(xe.certificateToAsn1(a)).getBytes()),i=o.digest().getBytes()}else i=je.random.getBytes(20);var l=[];i!==null&&l.push(R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.localKeyId).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,i)])])),"friendlyName"in n&&l.push(R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.friendlyName).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SET,!0,[R.create(R.Class.UNIVERSAL,R.Type.BMPSTRING,!1,n.friendlyName)])])),l.length>0&&(s=R.create(R.Class.UNIVERSAL,R.Type.SET,!0,l));var u=[],c=[];t!==null&&(je.util.isArray(t)?c=t:c=[t]);for(var f=[],d=0;d<c.length;++d){t=c[d],typeof t=="string"&&(t=xe.certificateFromPem(t));var p=d===0?s:void 0,g=xe.certificateToAsn1(t),m=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.certBag).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.x509Certificate).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,R.toDer(g).getBytes())])])]),p]);f.push(m)}if(f.length>0){var T=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,f),x=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.data).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,R.toDer(T).getBytes())])]);u.push(x)}var B=null;if(e!==null){var v=xe.wrapRsaPrivateKey(xe.privateKeyToAsn1(e));r===null?B=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.keyBag).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[v]),s]):B=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.pkcs8ShroudedKeyBag).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[xe.encryptPrivateKeyInfo(v,r,n)]),s]);var _=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[B]),w=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.data).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,R.toDer(_).getBytes())])]);u.push(w)}var I=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,u),k;if(n.useMac){var o=je.md.sha1.create(),M=new je.util.ByteBuffer(je.random.getBytes(n.saltSize)),K=n.count,e=Ai.generateKey(r,M,3,K,20),N=je.hmac.create();N.start(o,e),N.update(R.toDer(I).getBytes());var U=N.getMac();k=R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.sha1).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.NULL,!1,"")]),R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,U.getBytes())]),R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,M.getBytes()),R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(K).getBytes())])}return R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.INTEGER,!1,R.integerToDer(3).getBytes()),R.create(R.Class.UNIVERSAL,R.Type.SEQUENCE,!0,[R.create(R.Class.UNIVERSAL,R.Type.OID,!1,R.oidToDer(xe.oids.data).getBytes()),R.create(R.Class.CONTEXT_SPECIFIC,0,!0,[R.create(R.Class.UNIVERSAL,R.Type.OCTETSTRING,!1,R.toDer(I).getBytes())])]),k])};Ai.generateKey=je.pbe.generatePkcs12Key;var en=we,Ko=en.asn1,jn=en.pki=en.pki||{};jn.pemToDer=function(e){var t=en.pem.decode(e)[0];if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return en.util.createBuffer(t.body)};jn.privateKeyFromPem=function(e){var t=en.pem.decode(e)[0];if(t.type!=="PRIVATE KEY"&&t.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=Ko.fromDer(t.body);return jn.privateKeyFromAsn1(n)};jn.privateKeyToPem=function(e,t){var r={type:"RSA PRIVATE KEY",body:Ko.toDer(jn.privateKeyToAsn1(e)).getBytes()};return en.pem.encode(r,{maxline:t})};jn.privateKeyInfoToPem=function(e,t){var r={type:"PRIVATE KEY",body:Ko.toDer(e).getBytes()};return en.pem.encode(r,{maxline:t})};var z=we,Ys=function(e,t,r,n){var i=z.util.createBuffer(),s=e.length>>1,a=s+(e.length&1),o=e.substr(0,a),l=e.substr(s,a),u=z.util.createBuffer(),c=z.hmac.create();r=t+r;var f=Math.ceil(n/16),d=Math.ceil(n/20);c.start("MD5",o);var p=z.util.createBuffer();u.putBytes(r);for(var g=0;g<f;++g)c.start(null,null),c.update(u.getBytes()),u.putBuffer(c.digest()),c.start(null,null),c.update(u.bytes()+r),p.putBuffer(c.digest());c.start("SHA1",l);var m=z.util.createBuffer();u.clear(),u.putBytes(r);for(var g=0;g<d;++g)c.start(null,null),c.update(u.getBytes()),u.putBuffer(c.digest()),c.start(null,null),c.update(u.bytes()+r),m.putBuffer(c.digest());return i.putBytes(z.util.xorBytes(p.getBytes(),m.getBytes(),n)),i},xb=function(e,t,r){var n=z.hmac.create();n.start("SHA1",e);var i=z.util.createBuffer();return i.putInt32(t[0]),i.putInt32(t[1]),i.putByte(r.type),i.putByte(r.version.major),i.putByte(r.version.minor),i.putInt16(r.length),i.putBytes(r.fragment.bytes()),n.update(i.getBytes()),n.digest().getBytes()},Ab=function(e,t,r){var n=!1;try{var i=e.deflate(t.fragment.getBytes());t.fragment=z.util.createBuffer(i),t.length=i.length,n=!0}catch{}return n},Ib=function(e,t,r){var n=!1;try{var i=e.inflate(t.fragment.getBytes());t.fragment=z.util.createBuffer(i),t.length=i.length,n=!0}catch{}return n},Kt=function(e,t){var r=0;switch(t){case 1:r=e.getByte();break;case 2:r=e.getInt16();break;case 3:r=e.getInt24();break;case 4:r=e.getInt32();break}return z.util.createBuffer(e.getBytes(r))},jt=function(e,t,r){e.putInt(r.length(),t<<3),e.putBuffer(r)},S={};S.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};S.SupportedVersions=[S.Versions.TLS_1_1,S.Versions.TLS_1_0];S.Version=S.SupportedVersions[0];S.MaxFragment=16384-1024;S.ConnectionEnd={server:0,client:1};S.PRFAlgorithm={tls_prf_sha256:0};S.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};S.CipherType={stream:0,block:1,aead:2};S.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};S.CompressionMethod={none:0,deflate:1};S.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};S.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};S.Alert={};S.Alert.Level={warning:1,fatal:2};S.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};S.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};S.CipherSuites={};S.getCipherSuite=function(e){var t=null;for(var r in S.CipherSuites){var n=S.CipherSuites[r];if(n.id[0]===e.charCodeAt(0)&&n.id[1]===e.charCodeAt(1)){t=n;break}}return t};S.handleUnexpected=function(e,t){var r=!e.open&&e.entity===S.ConnectionEnd.client;r||e.error(e,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unexpected_message}})};S.handleHelloRequest=function(e,t,r){!e.handshaking&&e.handshakes>0&&(S.queue(e,S.createAlert(e,{level:S.Alert.Level.warning,description:S.Alert.Description.no_renegotiation})),S.flush(e)),e.process()};S.parseHelloMessage=function(e,t,r){var n=null,i=e.entity===S.ConnectionEnd.client;if(r<38)e.error(e,{message:i?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});else{var s=t.fragment,a=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:z.util.createBuffer(s.getBytes(32)),session_id:Kt(s,1),extensions:[]},i?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=Kt(s,2),n.compression_methods=Kt(s,1)),a=r-(a-s.length()),a>0){for(var o=Kt(s,2);o.length()>0;)n.extensions.push({type:[o.getByte(),o.getByte()],data:Kt(o,2)});if(!i)for(var l=0;l<n.extensions.length;++l){var u=n.extensions[l];if(u.type[0]===0&&u.type[1]===0)for(var c=Kt(u.data,2);c.length()>0;){var f=c.getByte();if(f!==0)break;e.session.extensions.server_name.serverNameList.push(Kt(c,2).getBytes())}}}if(e.session.version&&(n.version.major!==e.session.version.major||n.version.minor!==e.session.version.minor))return e.error(e,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}});if(i)e.session.cipherSuite=S.getCipherSuite(n.cipher_suite);else for(var d=z.util.createBuffer(n.cipher_suites.bytes());d.length()>0&&(e.session.cipherSuite=S.getCipherSuite(d.getBytes(2)),e.session.cipherSuite===null););if(e.session.cipherSuite===null)return e.error(e,{message:"No cipher suites in common.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.handshake_failure},cipherSuite:z.util.bytesToHex(n.cipher_suite)});i?e.session.compressionMethod=n.compression_method:e.session.compressionMethod=S.CompressionMethod.none}return n};S.createSecurityParameters=function(e,t){var r=e.entity===S.ConnectionEnd.client,n=t.random.bytes(),i=r?e.session.sp.client_random:n,s=r?n:S.createRandom().getBytes();e.session.sp={entity:e.entity,prf_algorithm:S.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:e.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:i,server_random:s}};S.handleServerHello=function(e,t,r){var n=S.parseHelloMessage(e,t,r);if(!e.fail){if(n.version.minor<=e.version.minor)e.version.minor=n.version.minor;else return e.error(e,{message:"Incompatible TLS version.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}});e.session.version=e.version;var i=n.session_id.bytes();i.length>0&&i===e.session.id?(e.expect=bf,e.session.resuming=!0,e.session.sp.server_random=n.random.bytes()):(e.expect=Bb,e.session.resuming=!1,S.createSecurityParameters(e,n)),e.session.id=i,e.process()}};S.handleClientHello=function(e,t,r){var n=S.parseHelloMessage(e,t,r);if(!e.fail){var i=n.session_id.bytes(),s=null;if(e.sessionCache&&(s=e.sessionCache.getSession(i),s===null?i="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,i="")),i.length===0&&(i=z.random.getBytes(32)),e.session.id=i,e.session.clientHelloVersion=n.version,e.session.sp={},s)e.version=e.session.version=s.version,e.session.sp=s.sp;else{for(var a,o=1;o<S.SupportedVersions.length&&(a=S.SupportedVersions[o],!(a.minor<=n.version.minor));++o);e.version={major:a.major,minor:a.minor},e.session.version=e.version}s!==null?(e.expect=Ho,e.session.resuming=!0,e.session.sp.client_random=n.random.bytes()):(e.expect=e.verifyClient!==!1?Mb:Va,e.session.resuming=!1,S.createSecurityParameters(e,n)),e.open=!0,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerHello(e)})),e.session.resuming?(S.queue(e,S.createRecord(e,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),e.state.pending=S.createConnectionState(e),e.state.current.write=e.state.pending.write,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createFinished(e)}))):(S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificate(e)})),e.fail||(S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerKeyExchange(e)})),e.verifyClient!==!1&&S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificateRequest(e)})),S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createServerHelloDone(e)})))),S.flush(e),e.process()}};S.handleCertificate=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_list:Kt(n,3)},s,a,o=[];try{for(;i.certificate_list.length()>0;)s=Kt(i.certificate_list,3),a=z.asn1.fromDer(s),s=z.pki.certificateFromAsn1(a,!0),o.push(s)}catch(u){return e.error(e,{message:"Could not parse certificate list.",cause:u,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate}})}var l=e.entity===S.ConnectionEnd.client;(l||e.verifyClient===!0)&&o.length===0?e.error(e,{message:l?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}}):o.length===0?e.expect=l?au:Va:(l?e.session.serverCertificate=o[0]:e.session.clientCertificate=o[0],S.verifyCertificateChain(e,o)&&(e.expect=l?au:Va)),e.process()};S.handleServerKeyExchange=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unsupported_certificate}});e.expect=Rb,e.process()};S.handleClientKeyExchange=function(e,t,r){if(r<48)return e.error(e,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unsupported_certificate}});var n=t.fragment,i={enc_pre_master_secret:Kt(n,2).getBytes()},s=null;if(e.getPrivateKey)try{s=e.getPrivateKey(e,e.session.serverCertificate),s=z.pki.privateKeyFromPem(s)}catch(l){e.error(e,{message:"Could not get private key.",cause:l,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}})}if(s===null)return e.error(e,{message:"No private key set.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}});try{var a=e.session.sp;a.pre_master_secret=s.decrypt(i.enc_pre_master_secret);var o=e.session.clientHelloVersion;if(o.major!==a.pre_master_secret.charCodeAt(0)||o.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=z.random.getBytes(48)}e.expect=Ho,e.session.clientCertificate!==null&&(e.expect=Pb),e.process()};S.handleCertificateRequest=function(e,t,r){if(r<3)return e.error(e,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment,i={certificate_types:Kt(n,1),certificate_authorities:Kt(n,2)};e.session.certificateRequest=i,e.expect=Nb,e.process()};S.handleCertificateVerify=function(e,t,r){if(r<2)return e.error(e,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var n=t.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s={signature:Kt(n,2).getBytes()},a=z.util.createBuffer();a.putBuffer(e.session.md5.digest()),a.putBuffer(e.session.sha1.digest()),a=a.getBytes();try{var o=e.session.clientCertificate;if(!o.publicKey.verify(a,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");e.session.md5.update(i),e.session.sha1.update(i)}catch{return e.error(e,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.handshake_failure}})}e.expect=Ho,e.process()};S.handleServerHelloDone=function(e,t,r){if(r>0)return e.error(e,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.record_overflow}});if(e.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.insufficient_security}},i=0,s=e.verify(e,n.alert.description,i,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!z.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),e.error(e,n)}e.session.certificateRequest!==null&&(t=S.createRecord(e,{type:S.ContentType.handshake,data:S.createCertificate(e)}),S.queue(e,t)),t=S.createRecord(e,{type:S.ContentType.handshake,data:S.createClientKeyExchange(e)}),S.queue(e,t),e.expect=Ub;var a=function(o,l){o.session.certificateRequest!==null&&o.session.clientCertificate!==null&&S.queue(o,S.createRecord(o,{type:S.ContentType.handshake,data:S.createCertificateVerify(o,l)})),S.queue(o,S.createRecord(o,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),o.state.pending=S.createConnectionState(o),o.state.current.write=o.state.pending.write,S.queue(o,S.createRecord(o,{type:S.ContentType.handshake,data:S.createFinished(o)})),o.expect=bf,S.flush(o),o.process()};if(e.session.certificateRequest===null||e.session.clientCertificate===null)return a(e,null);S.getClientSignature(e,a)};S.handleChangeCipherSpec=function(e,t){if(t.fragment.getByte()!==1)return e.error(e,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.illegal_parameter}});var r=e.entity===S.ConnectionEnd.client;(e.session.resuming&&r||!e.session.resuming&&!r)&&(e.state.pending=S.createConnectionState(e)),e.state.current.read=e.state.pending.read,(!e.session.resuming&&r||e.session.resuming&&!r)&&(e.state.pending=null),e.expect=r?Lb:Fb,e.process()};S.handleFinished=function(e,t,r){var n=t.fragment;n.read-=4;var i=n.bytes();n.read+=4;var s=t.fragment.getBytes();n=z.util.createBuffer(),n.putBuffer(e.session.md5.digest()),n.putBuffer(e.session.sha1.digest());var a=e.entity===S.ConnectionEnd.client,o=a?"server finished":"client finished",l=e.session.sp,u=12,c=Ys;if(n=c(l.master_secret,o,n.getBytes(),u),n.getBytes()!==s)return e.error(e,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.decrypt_error}});e.session.md5.update(i),e.session.sha1.update(i),(e.session.resuming&&a||!e.session.resuming&&!a)&&(S.queue(e,S.createRecord(e,{type:S.ContentType.change_cipher_spec,data:S.createChangeCipherSpec()})),e.state.current.write=e.state.pending.write,e.state.pending=null,S.queue(e,S.createRecord(e,{type:S.ContentType.handshake,data:S.createFinished(e)}))),e.expect=a?Db:Vb,e.handshaking=!1,++e.handshakes,e.peerCertificate=a?e.session.serverCertificate:e.session.clientCertificate,S.flush(e),e.isConnected=!0,e.connected(e),e.process()};S.handleAlert=function(e,t){var r=t.fragment,n={level:r.getByte(),description:r.getByte()},i;switch(n.description){case S.Alert.Description.close_notify:i="Connection closed.";break;case S.Alert.Description.unexpected_message:i="Unexpected message.";break;case S.Alert.Description.bad_record_mac:i="Bad record MAC.";break;case S.Alert.Description.decryption_failed:i="Decryption failed.";break;case S.Alert.Description.record_overflow:i="Record overflow.";break;case S.Alert.Description.decompression_failure:i="Decompression failed.";break;case S.Alert.Description.handshake_failure:i="Handshake failure.";break;case S.Alert.Description.bad_certificate:i="Bad certificate.";break;case S.Alert.Description.unsupported_certificate:i="Unsupported certificate.";break;case S.Alert.Description.certificate_revoked:i="Certificate revoked.";break;case S.Alert.Description.certificate_expired:i="Certificate expired.";break;case S.Alert.Description.certificate_unknown:i="Certificate unknown.";break;case S.Alert.Description.illegal_parameter:i="Illegal parameter.";break;case S.Alert.Description.unknown_ca:i="Unknown certificate authority.";break;case S.Alert.Description.access_denied:i="Access denied.";break;case S.Alert.Description.decode_error:i="Decode error.";break;case S.Alert.Description.decrypt_error:i="Decrypt error.";break;case S.Alert.Description.export_restriction:i="Export restriction.";break;case S.Alert.Description.protocol_version:i="Unsupported protocol version.";break;case S.Alert.Description.insufficient_security:i="Insufficient security.";break;case S.Alert.Description.internal_error:i="Internal error.";break;case S.Alert.Description.user_canceled:i="User canceled.";break;case S.Alert.Description.no_renegotiation:i="Renegotiation not supported.";break;default:i="Unknown error.";break}if(n.description===S.Alert.Description.close_notify)return e.close();e.error(e,{message:i,send:!1,origin:e.entity===S.ConnectionEnd.client?"server":"client",alert:n}),e.process()};S.handleHandshake=function(e,t){var r=t.fragment,n=r.getByte(),i=r.getInt24();if(i>r.length())return e.fragmented=t,t.fragment=z.util.createBuffer(),r.read-=4,e.process();e.fragmented=null,r.read-=4;var s=r.bytes(i+4);r.read+=4,n in As[e.entity][e.expect]?(e.entity===S.ConnectionEnd.server&&!e.open&&!e.fail&&(e.handshaking=!0,e.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:z.md.md5.create(),sha1:z.md.sha1.create()}),n!==S.HandshakeType.hello_request&&n!==S.HandshakeType.certificate_verify&&n!==S.HandshakeType.finished&&(e.session.md5.update(s),e.session.sha1.update(s)),As[e.entity][e.expect][n](e,t,i)):S.handleUnexpected(e,t)};S.handleApplicationData=function(e,t){e.data.putBuffer(t.fragment),e.dataReady(e),e.process()};S.handleHeartbeat=function(e,t){var r=t.fragment,n=r.getByte(),i=r.getInt16(),s=r.getBytes(i);if(n===S.HeartbeatMessageType.heartbeat_request){if(e.handshaking||i>s.length)return e.process();S.queue(e,S.createRecord(e,{type:S.ContentType.heartbeat,data:S.createHeartbeat(S.HeartbeatMessageType.heartbeat_response,s)})),S.flush(e)}else if(n===S.HeartbeatMessageType.heartbeat_response){if(s!==e.expectedHeartbeatPayload)return e.process();e.heartbeatReceived&&e.heartbeatReceived(e,z.util.createBuffer(s))}e.process()};var kb=0,Bb=1,au=2,Rb=3,Nb=4,bf=5,Lb=6,Db=7,Ub=8,Ob=0,Mb=1,Va=2,Pb=3,Ho=4,Fb=5,Vb=6,E=S.handleUnexpected,Ef=S.handleChangeCipherSpec,kt=S.handleAlert,Mt=S.handleHandshake,Sf=S.handleApplicationData,Bt=S.handleHeartbeat,$o=[];$o[S.ConnectionEnd.client]=[[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[Ef,kt,E,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,Sf,Bt],[E,kt,Mt,E,Bt]];$o[S.ConnectionEnd.server]=[[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,E,Bt],[Ef,kt,E,E,Bt],[E,kt,Mt,E,Bt],[E,kt,Mt,Sf,Bt],[E,kt,Mt,E,Bt]];var Pr=S.handleHelloRequest,Kb=S.handleServerHello,_f=S.handleCertificate,ou=S.handleServerKeyExchange,da=S.handleCertificateRequest,Gi=S.handleServerHelloDone,wf=S.handleFinished,As=[];As[S.ConnectionEnd.client]=[[E,E,Kb,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,_f,ou,da,Gi,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,ou,da,Gi,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,da,Gi,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,E,Gi,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,wf],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[Pr,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]];var Hb=S.handleClientHello,$b=S.handleClientKeyExchange,Gb=S.handleCertificateVerify;As[S.ConnectionEnd.server]=[[E,Hb,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,_f,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,$b,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,Gb,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,wf],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E],[E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E,E]];S.generateKeys=function(e,t){var r=Ys,n=t.client_random+t.server_random;e.session.resuming||(t.master_secret=r(t.pre_master_secret,"master secret",n,48).bytes(),t.pre_master_secret=null),n=t.server_random+t.client_random;var i=2*t.mac_key_length+2*t.enc_key_length,s=e.version.major===S.Versions.TLS_1_0.major&&e.version.minor===S.Versions.TLS_1_0.minor;s&&(i+=2*t.fixed_iv_length);var a=r(t.master_secret,"key expansion",n,i),o={client_write_MAC_key:a.getBytes(t.mac_key_length),server_write_MAC_key:a.getBytes(t.mac_key_length),client_write_key:a.getBytes(t.enc_key_length),server_write_key:a.getBytes(t.enc_key_length)};return s&&(o.client_write_IV=a.getBytes(t.fixed_iv_length),o.server_write_IV=a.getBytes(t.fixed_iv_length)),o};S.createConnectionState=function(e){var t=e.entity===S.ConnectionEnd.client,r=function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},n={read:r(),write:r()};if(n.read.update=function(s,a){return n.read.cipherFunction(a,n.read)?n.read.compressFunction(s,a,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,a){return n.write.compressFunction(s,a,n.write)?n.write.cipherFunction(a,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}),!s.fail},e.session){var i=e.session.sp;switch(e.session.cipherSuite.initSecurityParameters(i),i.keys=S.generateKeys(e,i),n.read.macKey=t?i.keys.server_write_MAC_key:i.keys.client_write_MAC_key,n.write.macKey=t?i.keys.client_write_MAC_key:i.keys.server_write_MAC_key,e.session.cipherSuite.initConnectionState(n,e,i),i.compression_algorithm){case S.CompressionMethod.none:break;case S.CompressionMethod.deflate:n.read.compressFunction=Ib,n.write.compressFunction=Ab;break;default:throw new Error("Unsupported compression algorithm.")}}return n};S.createRandom=function(){var e=new Date,t=+e+e.getTimezoneOffset()*6e4,r=z.util.createBuffer();return r.putInt32(t),r.putBytes(z.random.getBytes(28)),r};S.createRecord=function(e,t){if(!t.data)return null;var r={type:t.type,version:{major:e.version.major,minor:e.version.minor},length:t.data.length(),fragment:t.data};return r};S.createAlert=function(e,t){var r=z.util.createBuffer();return r.putByte(t.level),r.putByte(t.description),S.createRecord(e,{type:S.ContentType.alert,data:r})};S.createClientHello=function(e){e.session.clientHelloVersion={major:e.version.major,minor:e.version.minor};for(var t=z.util.createBuffer(),r=0;r<e.cipherSuites.length;++r){var n=e.cipherSuites[r];t.putByte(n.id[0]),t.putByte(n.id[1])}var i=t.length(),s=z.util.createBuffer();s.putByte(S.CompressionMethod.none);var a=s.length(),o=z.util.createBuffer();if(e.virtualHost){var l=z.util.createBuffer();l.putByte(0),l.putByte(0);var u=z.util.createBuffer();u.putByte(0),jt(u,2,z.util.createBuffer(e.virtualHost));var c=z.util.createBuffer();jt(c,2,u),jt(l,2,c),o.putBuffer(l)}var f=o.length();f>0&&(f+=2);var d=e.session.id,p=d.length+1+2+4+28+2+i+1+a+f,g=z.util.createBuffer();return g.putByte(S.HandshakeType.client_hello),g.putInt24(p),g.putByte(e.version.major),g.putByte(e.version.minor),g.putBytes(e.session.sp.client_random),jt(g,1,z.util.createBuffer(d)),jt(g,2,t),jt(g,1,s),f>0&&jt(g,2,o),g};S.createServerHello=function(e){var t=e.session.id,r=t.length+1+2+4+28+2+1,n=z.util.createBuffer();return n.putByte(S.HandshakeType.server_hello),n.putInt24(r),n.putByte(e.version.major),n.putByte(e.version.minor),n.putBytes(e.session.sp.server_random),jt(n,1,z.util.createBuffer(t)),n.putByte(e.session.cipherSuite.id[0]),n.putByte(e.session.cipherSuite.id[1]),n.putByte(e.session.compressionMethod),n};S.createCertificate=function(e){var t=e.entity===S.ConnectionEnd.client,r=null;if(e.getCertificate){var n;t?n=e.session.certificateRequest:n=e.session.extensions.server_name.serverNameList,r=e.getCertificate(e,n)}var i=z.util.createBuffer();if(r!==null)try{z.util.isArray(r)||(r=[r]);for(var s=null,a=0;a<r.length;++a){var o=z.pem.decode(r[a])[0];if(o.type!=="CERTIFICATE"&&o.type!=="X509 CERTIFICATE"&&o.type!=="TRUSTED CERTIFICATE"){var l=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw l.headerType=o.type,l}if(o.procType&&o.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var u=z.util.createBuffer(o.body);s===null&&(s=z.asn1.fromDer(u.bytes(),!1));var c=z.util.createBuffer();jt(c,3,u),i.putBuffer(c)}r=z.pki.certificateFromAsn1(s),t?e.session.clientCertificate=r:e.session.serverCertificate=r}catch(p){return e.error(e,{message:"Could not send certificate list.",cause:p,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate}})}var f=3+i.length(),d=z.util.createBuffer();return d.putByte(S.HandshakeType.certificate),d.putInt24(f),jt(d,3,i),d};S.createClientKeyExchange=function(e){var t=z.util.createBuffer();t.putByte(e.session.clientHelloVersion.major),t.putByte(e.session.clientHelloVersion.minor),t.putBytes(z.random.getBytes(46));var r=e.session.sp;r.pre_master_secret=t.getBytes();var n=e.session.serverCertificate.publicKey;t=n.encrypt(r.pre_master_secret);var i=t.length+2,s=z.util.createBuffer();return s.putByte(S.HandshakeType.client_key_exchange),s.putInt24(i),s.putInt16(t.length),s.putBytes(t),s};S.createServerKeyExchange=function(e){var t=z.util.createBuffer();return t};S.getClientSignature=function(e,t){var r=z.util.createBuffer();r.putBuffer(e.session.md5.digest()),r.putBuffer(e.session.sha1.digest()),r=r.getBytes(),e.getSignature=e.getSignature||function(n,i,s){var a=null;if(n.getPrivateKey)try{a=n.getPrivateKey(n,n.session.clientCertificate),a=z.pki.privateKeyFromPem(a)}catch(o){n.error(n,{message:"Could not get private key.",cause:o,send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}})}a===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.internal_error}}):i=a.sign(i,null),s(n,i)},e.getSignature(e,r,t)};S.createCertificateVerify=function(e,t){var r=t.length+2,n=z.util.createBuffer();return n.putByte(S.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(t.length),n.putBytes(t),n};S.createCertificateRequest=function(e){var t=z.util.createBuffer();t.putByte(1);var r=z.util.createBuffer();for(var n in e.caStore.certs){var i=e.caStore.certs[n],s=z.pki.distinguishedNameToAsn1(i.subject),a=z.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var o=1+t.length()+2+r.length(),l=z.util.createBuffer();return l.putByte(S.HandshakeType.certificate_request),l.putInt24(o),jt(l,1,t),jt(l,2,r),l};S.createServerHelloDone=function(e){var t=z.util.createBuffer();return t.putByte(S.HandshakeType.server_hello_done),t.putInt24(0),t};S.createChangeCipherSpec=function(){var e=z.util.createBuffer();return e.putByte(1),e};S.createFinished=function(e){var t=z.util.createBuffer();t.putBuffer(e.session.md5.digest()),t.putBuffer(e.session.sha1.digest());var r=e.entity===S.ConnectionEnd.client,n=e.session.sp,i=12,s=Ys,a=r?"client finished":"server finished";t=s(n.master_secret,a,t.getBytes(),i);var o=z.util.createBuffer();return o.putByte(S.HandshakeType.finished),o.putInt24(t.length()),o.putBuffer(t),o};S.createHeartbeat=function(e,t,r){typeof r>"u"&&(r=t.length);var n=z.util.createBuffer();n.putByte(e),n.putInt16(r),n.putBytes(t);var i=n.length(),s=Math.max(16,i-r-3);return n.putBytes(z.random.getBytes(s)),n};S.queue=function(e,t){if(!!t&&!(t.fragment.length()===0&&(t.type===S.ContentType.handshake||t.type===S.ContentType.alert||t.type===S.ContentType.change_cipher_spec))){if(t.type===S.ContentType.handshake){var r=t.fragment.bytes();e.session.md5.update(r),e.session.sha1.update(r),r=null}var n;if(t.fragment.length()<=S.MaxFragment)n=[t];else{n=[];for(var i=t.fragment.bytes();i.length>S.MaxFragment;)n.push(S.createRecord(e,{type:t.type,data:z.util.createBuffer(i.slice(0,S.MaxFragment))})),i=i.slice(S.MaxFragment);i.length>0&&n.push(S.createRecord(e,{type:t.type,data:z.util.createBuffer(i)}))}for(var s=0;s<n.length&&!e.fail;++s){var a=n[s],o=e.state.current.write;o.update(e,a)&&e.records.push(a)}}};S.flush=function(e){for(var t=0;t<e.records.length;++t){var r=e.records[t];e.tlsData.putByte(r.type),e.tlsData.putByte(r.version.major),e.tlsData.putByte(r.version.minor),e.tlsData.putInt16(r.fragment.length()),e.tlsData.putBuffer(e.records[t].fragment)}return e.records=[],e.tlsDataReady(e)};var pa=function(e){switch(e){case!0:return!0;case z.pki.certificateError.bad_certificate:return S.Alert.Description.bad_certificate;case z.pki.certificateError.unsupported_certificate:return S.Alert.Description.unsupported_certificate;case z.pki.certificateError.certificate_revoked:return S.Alert.Description.certificate_revoked;case z.pki.certificateError.certificate_expired:return S.Alert.Description.certificate_expired;case z.pki.certificateError.certificate_unknown:return S.Alert.Description.certificate_unknown;case z.pki.certificateError.unknown_ca:return S.Alert.Description.unknown_ca;default:return S.Alert.Description.bad_certificate}},qb=function(e){switch(e){case!0:return!0;case S.Alert.Description.bad_certificate:return z.pki.certificateError.bad_certificate;case S.Alert.Description.unsupported_certificate:return z.pki.certificateError.unsupported_certificate;case S.Alert.Description.certificate_revoked:return z.pki.certificateError.certificate_revoked;case S.Alert.Description.certificate_expired:return z.pki.certificateError.certificate_expired;case S.Alert.Description.certificate_unknown:return z.pki.certificateError.certificate_unknown;case S.Alert.Description.unknown_ca:return z.pki.certificateError.unknown_ca;default:return z.pki.certificateError.bad_certificate}};S.verifyCertificateChain=function(e,t){try{var r={};for(var n in e.verifyOptions)r[n]=e.verifyOptions[n];r.verify=function(s,a,o){var l=pa(s),u=e.verify(e,s,a,o);if(u!==!0){if(typeof u=="object"&&!z.util.isArray(u)){var c=new Error("The application rejected the certificate.");throw c.send=!0,c.alert={level:S.Alert.Level.fatal,description:S.Alert.Description.bad_certificate},u.message&&(c.message=u.message),u.alert&&(c.alert.description=u.alert),c}u!==s&&(u=qb(u))}return u},z.pki.verifyCertificateChain(e.caStore,t,r)}catch(s){var i=s;(typeof i!="object"||z.util.isArray(i))&&(i={send:!0,alert:{level:S.Alert.Level.fatal,description:pa(s)}}),"send"in i||(i.send=!0),"alert"in i||(i.alert={level:S.Alert.Level.fatal,description:pa(i.error)}),e.error(e,i)}return!e.fail};S.createSessionCache=function(e,t){var r=null;if(e&&e.getSession&&e.setSession&&e.order)r=e;else{r={},r.cache=e||{},r.capacity=Math.max(t||100,1),r.order=[];for(var n in e)r.order.length<=t?r.order.push(n):delete e[n];r.getSession=function(i){var s=null,a=null;if(i?a=z.util.bytesToHex(i):r.order.length>0&&(a=r.order[0]),a!==null&&a in r.cache){s=r.cache[a],delete r.cache[a];for(var o in r.order)if(r.order[o]===a){r.order.splice(o,1);break}}return s},r.setSession=function(i,s){if(r.order.length===r.capacity){var a=r.order.shift();delete r.cache[a]}var a=z.util.bytesToHex(i);r.order.push(a),r.cache[a]=s}}return r};S.createConnection=function(e){var t=null;e.caStore?z.util.isArray(e.caStore)?t=z.pki.createCaStore(e.caStore):t=e.caStore:t=z.pki.createCaStore();var r=e.cipherSuites||null;if(r===null){r=[];for(var n in S.CipherSuites)r.push(S.CipherSuites[n])}var i=e.server?S.ConnectionEnd.server:S.ConnectionEnd.client,s=e.sessionCache?S.createSessionCache(e.sessionCache):null,a={version:{major:S.Version.major,minor:S.Version.minor},entity:i,sessionId:e.sessionId,caStore:t,sessionCache:s,cipherSuites:r,connected:e.connected,virtualHost:e.virtualHost||null,verifyClient:e.verifyClient||!1,verify:e.verify||function(c,f,d,p){return f},verifyOptions:e.verifyOptions||{},getCertificate:e.getCertificate||null,getPrivateKey:e.getPrivateKey||null,getSignature:e.getSignature||null,input:z.util.createBuffer(),tlsData:z.util.createBuffer(),data:z.util.createBuffer(),tlsDataReady:e.tlsDataReady,dataReady:e.dataReady,heartbeatReceived:e.heartbeatReceived,closed:e.closed,error:function(c,f){f.origin=f.origin||(c.entity===S.ConnectionEnd.client?"client":"server"),f.send&&(S.queue(c,S.createAlert(c,f.alert)),S.flush(c));var d=f.fatal!==!1;d&&(c.fail=!0),e.error(c,f),d&&c.close(!1)},deflate:e.deflate||null,inflate:e.inflate||null};a.reset=function(c){a.version={major:S.Version.major,minor:S.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===S.ConnectionEnd.client?kb:Ob,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(c||typeof c>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=S.createConnectionState(a)},a.reset();var o=function(c,f){var d=f.type-S.ContentType.change_cipher_spec,p=$o[c.entity][c.expect];d in p?p[d](c,f):S.handleUnexpected(c,f)},l=function(c){var f=0,d=c.input,p=d.length();if(p<5)f=5-p;else{c.record={type:d.getByte(),version:{major:d.getByte(),minor:d.getByte()},length:d.getInt16(),fragment:z.util.createBuffer(),ready:!1};var g=c.record.version.major===c.version.major;g&&c.session&&c.session.version&&(g=c.record.version.minor===c.version.minor),g||c.error(c,{message:"Incompatible TLS version.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.protocol_version}})}return f},u=function(c){var f=0,d=c.input,p=d.length();if(p<c.record.length)f=c.record.length-p;else{c.record.fragment.putBytes(d.getBytes(c.record.length)),d.compact();var g=c.state.current.read;g.update(c,c.record)&&(c.fragmented!==null&&(c.fragmented.type===c.record.type?(c.fragmented.fragment.putBuffer(c.record.fragment),c.record=c.fragmented):c.error(c,{message:"Invalid fragmented record.",send:!0,alert:{level:S.Alert.Level.fatal,description:S.Alert.Description.unexpected_message}})),c.record.ready=!0)}return f};return a.handshake=function(c){if(a.entity!==S.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,c=c||"";var f=null;c.length>0&&(a.sessionCache&&(f=a.sessionCache.getSession(c)),f===null&&(c="")),c.length===0&&a.sessionCache&&(f=a.sessionCache.getSession(),f!==null&&(c=f.id)),a.session={id:c,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:z.md.md5.create(),sha1:z.md.sha1.create()},f&&(a.version=f.version,a.session.sp=f.sp),a.session.sp.client_random=S.createRandom().getBytes(),a.open=!0,S.queue(a,S.createRecord(a,{type:S.ContentType.handshake,data:S.createClientHello(a)})),S.flush(a)}},a.process=function(c){var f=0;return c&&a.input.putBytes(c),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(f=l(a)),!a.fail&&a.record!==null&&!a.record.ready&&(f=u(a)),!a.fail&&a.record!==null&&a.record.ready&&o(a,a.record)),f},a.prepare=function(c){return S.queue(a,S.createRecord(a,{type:S.ContentType.application_data,data:z.util.createBuffer(c)})),S.flush(a)},a.prepareHeartbeatRequest=function(c,f){return c instanceof z.util.ByteBuffer&&(c=c.bytes()),typeof f>"u"&&(f=c.length),a.expectedHeartbeatPayload=c,S.queue(a,S.createRecord(a,{type:S.ContentType.heartbeat,data:S.createHeartbeat(S.HeartbeatMessageType.heartbeat_request,c,f)})),S.flush(a)},a.close=function(c){if(!a.fail&&a.sessionCache&&a.session){var f={id:a.session.id,version:a.session.version,sp:a.session.sp};f.sp.keys=null,a.sessionCache.setSession(f.id,f)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,S.queue(a,S.createAlert(a,{level:S.Alert.Level.warning,description:S.Alert.Description.close_notify})),S.flush(a)),a.closed(a)),a.reset(c)},a};z.tls=z.tls||{};for(var ga in S)typeof S[ga]!="function"&&(z.tls[ga]=S[ga]);z.tls.prf_tls1=Ys;z.tls.hmac_sha1=xb;z.tls.createSessionCache=S.createSessionCache;z.tls.createConnection=S.createConnection;var Qr=we,Xt=Qr.tls;Xt.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Xt.BulkCipherAlgorithm.aes,e.cipher_type=Xt.CipherType.block,e.enc_key_length=16,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Xt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Tf};Xt.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(e){e.bulk_cipher_algorithm=Xt.BulkCipherAlgorithm.aes,e.cipher_type=Xt.CipherType.block,e.enc_key_length=32,e.block_length=16,e.fixed_iv_length=16,e.record_iv_length=16,e.mac_algorithm=Xt.MACAlgorithm.hmac_sha1,e.mac_length=20,e.mac_key_length=20},initConnectionState:Tf};function Tf(e,t,r){var n=t.entity===Qr.tls.ConnectionEnd.client;e.read.cipherState={init:!1,cipher:Qr.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},e.write.cipherState={init:!1,cipher:Qr.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},e.read.cipherFunction=Qb,e.write.cipherFunction=jb,e.read.macLength=e.write.macLength=r.mac_length,e.read.macFunction=e.write.macFunction=Xt.hmac_sha1}function jb(e,t){var r=!1,n=t.macFunction(t.macKey,t.sequenceNumber,e);e.fragment.putBytes(n),t.updateSequenceNumber();var i;e.version.minor===Xt.Versions.TLS_1_0.minor?i=t.cipherState.init?null:t.cipherState.iv:i=Qr.random.getBytesSync(16),t.cipherState.init=!0;var s=t.cipherState.cipher;return s.start({iv:i}),e.version.minor>=Xt.Versions.TLS_1_1.minor&&s.output.putBytes(i),s.update(e.fragment),s.finish(zb)&&(e.fragment=s.output,e.length=e.fragment.length(),r=!0),r}function zb(e,t,r){if(!r){var n=e-t.length()%e;t.fillWithByte(n-1,n)}return!0}function Wb(e,t,r){var n=!0;if(r){for(var i=t.length(),s=t.last(),a=i-1-s;a<i-1;++a)n=n&&t.at(a)==s;n&&t.truncate(s+1)}return n}function Qb(e,t){var r=!1,n;e.version.minor===Xt.Versions.TLS_1_0.minor?n=t.cipherState.init?null:t.cipherState.iv:n=e.fragment.getBytes(16),t.cipherState.init=!0;var i=t.cipherState.cipher;i.start({iv:n}),i.update(e.fragment),r=i.finish(Wb);var s=t.macLength,a=Qr.random.getBytesSync(s),o=i.output.length();o>=s?(e.fragment=i.output.getBytes(o-s),a=i.output.getBytes(s)):e.fragment=i.output.getBytes(),e.fragment=Qr.util.createBuffer(e.fragment),e.length=e.fragment.length();var l=t.macFunction(t.macKey,t.sequenceNumber,e);return t.updateSequenceNumber(),r=Jb(t.macKey,a,l)&&r,r}function Jb(e,t,r){var n=Qr.hmac.create();return n.start("SHA1",e),n.update(t),t=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),t===r}var Ze=we,Mi=Ze.sha512=Ze.sha512||{};Ze.md.sha512=Ze.md.algorithms.sha512=Mi;var xf=Ze.sha384=Ze.sha512.sha384=Ze.sha512.sha384||{};xf.create=function(){return Mi.create("SHA-384")};Ze.md.sha384=Ze.md.algorithms.sha384=xf;Ze.sha512.sha256=Ze.sha512.sha256||{create:function(){return Mi.create("SHA-512/256")}};Ze.md["sha512/256"]=Ze.md.algorithms["sha512/256"]=Ze.sha512.sha256;Ze.sha512.sha224=Ze.sha512.sha224||{create:function(){return Mi.create("SHA-512/224")}};Ze.md["sha512/224"]=Ze.md.algorithms["sha512/224"]=Ze.sha512.sha224;Mi.create=function(e){if(Af||Yb(),typeof e>"u"&&(e="SHA-512"),!(e in an))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=an[e],r=null,n=Ze.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(e){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var l=o.messageLengthSize/4,u=0;u<l;++u)o.fullMessageLength.push(0);n=Ze.util.createBuffer(),r=new Array(t.length);for(var u=0;u<t.length;++u)r[u]=t[u].slice(0);return o},o.start(),o.update=function(l,u){u==="utf8"&&(l=Ze.util.encodeUtf8(l));var c=l.length;o.messageLength+=c,c=[c/4294967296>>>0,c>>>0];for(var f=o.fullMessageLength.length-1;f>=0;--f)o.fullMessageLength[f]+=c[1],c[1]=c[0]+(o.fullMessageLength[f]/4294967296>>>0),o.fullMessageLength[f]=o.fullMessageLength[f]>>>0,c[0]=c[1]/4294967296>>>0;return n.putBytes(l),lu(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var l=Ze.util.createBuffer();l.putBytes(n.bytes());var u=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,c=u&o.blockLength-1;l.putBytes(Ka.substr(0,o.blockLength-c));for(var f,d,p=o.fullMessageLength[0]*8,g=0;g<o.fullMessageLength.length-1;++g)f=o.fullMessageLength[g+1]*8,d=f/4294967296>>>0,p+=d,l.putInt32(p>>>0),p=f>>>0;l.putInt32(p);for(var m=new Array(r.length),g=0;g<r.length;++g)m[g]=r[g].slice(0);lu(m,i,l);var T=Ze.util.createBuffer(),x;e==="SHA-512"?x=m.length:e==="SHA-384"?x=m.length-2:x=m.length-4;for(var g=0;g<x;++g)T.putInt32(m[g][0]),(g!==x-1||e!=="SHA-512/224")&&T.putInt32(m[g][1]);return T},o};var Ka=null,Af=!1,Ha=null,an=null;function Yb(){Ka=String.fromCharCode(128),Ka+=Ze.util.fillString(String.fromCharCode(0),128),Ha=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],an={},an["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],an["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],an["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],an["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Af=!0}function lu(e,t,r){for(var n,i,s,a,o,l,u,c,f,d,p,g,m,T,x,B,v,_,w,I,k,M,K,N,U,H,$,re,Y,le,ee,ot,de,$e,Me,Fe=r.length();Fe>=128;){for(Y=0;Y<16;++Y)t[Y][0]=r.getInt32()>>>0,t[Y][1]=r.getInt32()>>>0;for(;Y<80;++Y)ot=t[Y-2],le=ot[0],ee=ot[1],n=((le>>>19|ee<<13)^(ee>>>29|le<<3)^le>>>6)>>>0,i=((le<<13|ee>>>19)^(ee<<3|le>>>29)^(le<<26|ee>>>6))>>>0,$e=t[Y-15],le=$e[0],ee=$e[1],s=((le>>>1|ee<<31)^(le>>>8|ee<<24)^le>>>7)>>>0,a=((le<<31|ee>>>1)^(le<<24|ee>>>8)^(le<<25|ee>>>7))>>>0,de=t[Y-7],Me=t[Y-16],ee=i+de[1]+a+Me[1],t[Y][0]=n+de[0]+s+Me[0]+(ee/4294967296>>>0)>>>0,t[Y][1]=ee>>>0;for(m=e[0][0],T=e[0][1],x=e[1][0],B=e[1][1],v=e[2][0],_=e[2][1],w=e[3][0],I=e[3][1],k=e[4][0],M=e[4][1],K=e[5][0],N=e[5][1],U=e[6][0],H=e[6][1],$=e[7][0],re=e[7][1],Y=0;Y<80;++Y)u=((k>>>14|M<<18)^(k>>>18|M<<14)^(M>>>9|k<<23))>>>0,c=((k<<18|M>>>14)^(k<<14|M>>>18)^(M<<23|k>>>9))>>>0,f=(U^k&(K^U))>>>0,d=(H^M&(N^H))>>>0,o=((m>>>28|T<<4)^(T>>>2|m<<30)^(T>>>7|m<<25))>>>0,l=((m<<4|T>>>28)^(T<<30|m>>>2)^(T<<25|m>>>7))>>>0,p=(m&x|v&(m^x))>>>0,g=(T&B|_&(T^B))>>>0,ee=re+c+d+Ha[Y][1]+t[Y][1],n=$+u+f+Ha[Y][0]+t[Y][0]+(ee/4294967296>>>0)>>>0,i=ee>>>0,ee=l+g,s=o+p+(ee/4294967296>>>0)>>>0,a=ee>>>0,$=U,re=H,U=K,H=N,K=k,N=M,ee=I+i,k=w+n+(ee/4294967296>>>0)>>>0,M=ee>>>0,w=v,I=_,v=x,_=B,x=m,B=T,ee=i+a,m=n+s+(ee/4294967296>>>0)>>>0,T=ee>>>0;ee=e[0][1]+T,e[0][0]=e[0][0]+m+(ee/4294967296>>>0)>>>0,e[0][1]=ee>>>0,ee=e[1][1]+B,e[1][0]=e[1][0]+x+(ee/4294967296>>>0)>>>0,e[1][1]=ee>>>0,ee=e[2][1]+_,e[2][0]=e[2][0]+v+(ee/4294967296>>>0)>>>0,e[2][1]=ee>>>0,ee=e[3][1]+I,e[3][0]=e[3][0]+w+(ee/4294967296>>>0)>>>0,e[3][1]=ee>>>0,ee=e[4][1]+M,e[4][0]=e[4][0]+k+(ee/4294967296>>>0)>>>0,e[4][1]=ee>>>0,ee=e[5][1]+N,e[5][0]=e[5][0]+K+(ee/4294967296>>>0)>>>0,e[5][1]=ee>>>0,ee=e[6][1]+H,e[6][0]=e[6][0]+U+(ee/4294967296>>>0)>>>0,e[6][1]=ee>>>0,ee=e[7][1]+re,e[7][0]=e[7][0]+$+(ee/4294967296>>>0)>>>0,e[7][1]=ee>>>0,Fe-=128}}var Go={},Xb=we,Et=Xb.asn1;Go.privateKeyValidator={name:"PrivateKeyInfo",tagClass:Et.Class.UNIVERSAL,type:Et.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:Et.Class.UNIVERSAL,type:Et.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:Et.Class.UNIVERSAL,type:Et.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Et.Class.UNIVERSAL,type:Et.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:Et.Class.UNIVERSAL,type:Et.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};Go.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:Et.Class.UNIVERSAL,type:Et.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:Et.Class.UNIVERSAL,type:Et.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:Et.Class.UNIVERSAL,type:Et.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:Et.Class.UNIVERSAL,type:Et.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]};var Rt=we,If=Go,Zb=If.publicKeyValidator,eE=If.privateKeyValidator;if(typeof tE>"u")var tE=Rt.jsbn.BigInteger;var $a=Rt.util.ByteBuffer,Vt=typeof Buffer>"u"?Uint8Array:Buffer;Rt.pki=Rt.pki||{};Rt.pki.ed25519=Rt.ed25519=Rt.ed25519||{};var Ae=Rt.ed25519;Ae.constants={};Ae.constants.PUBLIC_KEY_BYTE_LENGTH=32;Ae.constants.PRIVATE_KEY_BYTE_LENGTH=64;Ae.constants.SEED_BYTE_LENGTH=32;Ae.constants.SIGN_BYTE_LENGTH=64;Ae.constants.HASH_BYTE_LENGTH=64;Ae.generateKeyPair=function(e){e=e||{};var t=e.seed;if(t===void 0)t=Rt.random.getBytesSync(Ae.constants.SEED_BYTE_LENGTH);else if(typeof t=="string"){if(t.length!==Ae.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+Ae.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');t=Rr({message:t,encoding:"binary"});for(var r=new Vt(Ae.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Vt(Ae.constants.PRIVATE_KEY_BYTE_LENGTH),i=0;i<32;++i)n[i]=t[i];return sE(r,n),{publicKey:r,privateKey:n}};Ae.privateKeyFromAsn1=function(e){var t={},r=[],n=Rt.asn1.validate(e,eE,t,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=Rt.asn1.derToOid(t.privateKeyOid),a=Rt.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var o=t.privateKey,l=Rr({message:Rt.asn1.fromDer(o).value,encoding:"binary"});return{privateKeyBytes:l}};Ae.publicKeyFromAsn1=function(e){var t={},r=[],n=Rt.asn1.validate(e,Zb,t,r);if(!n){var i=new Error("Invalid Key.");throw i.errors=r,i}var s=Rt.asn1.derToOid(t.publicKeyOid),a=Rt.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var o=t.ed25519PublicKey;if(o.length!==Ae.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Rr({message:o,encoding:"binary"})};Ae.publicKeyFromPrivateKey=function(e){e=e||{};var t=Rr({message:e.privateKey,encoding:"binary"});if(t.length!==Ae.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ae.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Vt(Ae.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=t[32+n];return r};Ae.sign=function(e){e=e||{};var t=Rr(e),r=Rr({message:e.privateKey,encoding:"binary"});if(r.length===Ae.constants.SEED_BYTE_LENGTH){var n=Ae.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==Ae.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+Ae.constants.SEED_BYTE_LENGTH+" or "+Ae.constants.PRIVATE_KEY_BYTE_LENGTH);var i=new Vt(Ae.constants.SIGN_BYTE_LENGTH+t.length);aE(i,t,t.length,r);for(var s=new Vt(Ae.constants.SIGN_BYTE_LENGTH),a=0;a<s.length;++a)s[a]=i[a];return s};Ae.verify=function(e){e=e||{};var t=Rr(e);if(e.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Rr({message:e.signature,encoding:"binary"});if(r.length!==Ae.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+Ae.constants.SIGN_BYTE_LENGTH);var n=Rr({message:e.publicKey,encoding:"binary"});if(n.length!==Ae.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+Ae.constants.PUBLIC_KEY_BYTE_LENGTH);var i=new Vt(Ae.constants.SIGN_BYTE_LENGTH+t.length),s=new Vt(Ae.constants.SIGN_BYTE_LENGTH+t.length),a;for(a=0;a<Ae.constants.SIGN_BYTE_LENGTH;++a)i[a]=r[a];for(a=0;a<t.length;++a)i[a+Ae.constants.SIGN_BYTE_LENGTH]=t[a];return oE(s,i,i.length,n)>=0};function Rr(e){var t=e.message;if(t instanceof Uint8Array||t instanceof Vt)return t;var r=e.encoding;if(t===void 0)if(e.md)t=e.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof t=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof t=="string"){if(typeof Buffer<"u")return Buffer.from(t,r);t=new $a(t,r)}else if(!(t instanceof $a))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Vt(t.length()),i=0;i<n.length;++i)n[i]=t.at(i);return n}var Ga=ge(),Is=ge([1]),rE=ge([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),nE=ge([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),uu=ge([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),cu=ge([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),ya=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),iE=ge([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function yi(e,t){var r=Rt.md.sha512.create(),n=new $a(e);r.update(n.getBytes(t),"binary");var i=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(i,"binary");for(var s=new Vt(Ae.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)s[a]=i.charCodeAt(a);return s}function sE(e,t){var r=[ge(),ge(),ge(),ge()],n,i=yi(t,32);for(i[0]&=248,i[31]&=127,i[31]|=64,jo(r,i),qo(e,r),n=0;n<32;++n)t[n+32]=e[n];return 0}function aE(e,t,r,n){var i,s,a=new Float64Array(64),o=[ge(),ge(),ge(),ge()],l=yi(n,32);l[0]&=248,l[31]&=127,l[31]|=64;var u=r+64;for(i=0;i<r;++i)e[64+i]=t[i];for(i=0;i<32;++i)e[32+i]=l[32+i];var c=yi(e.subarray(32),r+32);for(qa(c),jo(o,c),qo(e,o),i=32;i<64;++i)e[i]=n[i];var f=yi(e,r+64);for(qa(f),i=32;i<64;++i)a[i]=0;for(i=0;i<32;++i)a[i]=c[i];for(i=0;i<32;++i)for(s=0;s<32;s++)a[i+s]+=f[i]*l[s];return kf(e.subarray(32),a),u}function oE(e,t,r,n){var i,s,a=new Vt(32),o=[ge(),ge(),ge(),ge()],l=[ge(),ge(),ge(),ge()];if(s=-1,r<64||lE(l,n))return-1;for(i=0;i<r;++i)e[i]=t[i];for(i=0;i<32;++i)e[i+32]=n[i];var u=yi(e,r);if(qa(u),Nf(o,l,u),jo(l,t.subarray(32)),ja(o,l),qo(a,o),r-=64,Bf(t,0,a,0)){for(i=0;i<r;++i)e[i]=0;return-1}for(i=0;i<r;++i)e[i]=t[i+64];return s=r,s}function kf(e,t){var r,n,i,s;for(n=63;n>=32;--n){for(r=0,i=n-32,s=n-12;i<s;++i)t[i]+=r-16*t[n]*ya[i-(n-32)],r=t[i]+128>>8,t[i]-=r*256;t[i]+=r,t[n]=0}for(r=0,i=0;i<32;++i)t[i]+=r-(t[31]>>4)*ya[i],r=t[i]>>8,t[i]&=255;for(i=0;i<32;++i)t[i]-=r*ya[i];for(n=0;n<32;++n)t[n+1]+=t[n]>>8,e[n]=t[n]&255}function qa(e){for(var t=new Float64Array(64),r=0;r<64;++r)t[r]=e[r],e[r]=0;kf(e,t)}function ja(e,t){var r=ge(),n=ge(),i=ge(),s=ge(),a=ge(),o=ge(),l=ge(),u=ge(),c=ge();Nn(r,e[1],e[0]),Nn(c,t[1],t[0]),Ge(r,r,c),kn(n,e[0],e[1]),kn(c,t[0],t[1]),Ge(n,n,c),Ge(i,e[3],t[3]),Ge(i,i,nE),Ge(s,e[2],t[2]),kn(s,s,s),Nn(a,n,r),Nn(o,s,i),kn(l,s,i),kn(u,n,r),Ge(e[0],a,o),Ge(e[1],u,l),Ge(e[2],l,o),Ge(e[3],a,u)}function fu(e,t,r){for(var n=0;n<4;++n)Lf(e[n],t[n],r)}function qo(e,t){var r=ge(),n=ge(),i=ge();hE(i,t[2]),Ge(r,t[0],i),Ge(n,t[1],i),ks(e,n),e[31]^=Rf(r)<<7}function ks(e,t){var r,n,i,s=ge(),a=ge();for(r=0;r<16;++r)a[r]=t[r];for(ma(a),ma(a),ma(a),n=0;n<2;++n){for(s[0]=a[0]-65517,r=1;r<15;++r)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),i=s[15]>>16&1,s[14]&=65535,Lf(a,s,1-i)}for(r=0;r<16;r++)e[2*r]=a[r]&255,e[2*r+1]=a[r]>>8}function lE(e,t){var r=ge(),n=ge(),i=ge(),s=ge(),a=ge(),o=ge(),l=ge();return zr(e[2],Is),uE(e[1],t),on(i,e[1]),Ge(s,i,rE),Nn(i,i,e[2]),kn(s,e[2],s),on(a,s),on(o,a),Ge(l,o,a),Ge(r,l,i),Ge(r,r,s),cE(r,r),Ge(r,r,i),Ge(r,r,s),Ge(r,r,s),Ge(e[0],r,s),on(n,e[0]),Ge(n,n,s),hu(n,i)&&Ge(e[0],e[0],iE),on(n,e[0]),Ge(n,n,s),hu(n,i)?-1:(Rf(e[0])===t[31]>>7&&Nn(e[0],Ga,e[0]),Ge(e[3],e[0],e[1]),0)}function uE(e,t){var r;for(r=0;r<16;++r)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function cE(e,t){var r=ge(),n;for(n=0;n<16;++n)r[n]=t[n];for(n=250;n>=0;--n)on(r,r),n!==1&&Ge(r,r,t);for(n=0;n<16;++n)e[n]=r[n]}function hu(e,t){var r=new Vt(32),n=new Vt(32);return ks(r,e),ks(n,t),Bf(r,0,n,0)}function Bf(e,t,r,n){return fE(e,t,r,n,32)}function fE(e,t,r,n,i){var s,a=0;for(s=0;s<i;++s)a|=e[t+s]^r[n+s];return(1&a-1>>>8)-1}function Rf(e){var t=new Vt(32);return ks(t,e),t[0]&1}function Nf(e,t,r){var n,i;for(zr(e[0],Ga),zr(e[1],Is),zr(e[2],Is),zr(e[3],Ga),i=255;i>=0;--i)n=r[i/8|0]>>(i&7)&1,fu(e,t,n),ja(t,e),ja(e,e),fu(e,t,n)}function jo(e,t){var r=[ge(),ge(),ge(),ge()];zr(r[0],uu),zr(r[1],cu),zr(r[2],Is),Ge(r[3],uu,cu),Nf(e,r,t)}function zr(e,t){var r;for(r=0;r<16;r++)e[r]=t[r]|0}function hE(e,t){var r=ge(),n;for(n=0;n<16;++n)r[n]=t[n];for(n=253;n>=0;--n)on(r,r),n!==2&&n!==4&&Ge(r,r,t);for(n=0;n<16;++n)e[n]=r[n]}function ma(e){var t,r,n=1;for(t=0;t<16;++t)r=e[t]+n+65535,n=Math.floor(r/65536),e[t]=r-n*65536;e[0]+=n-1+37*(n-1)}function Lf(e,t,r){for(var n,i=~(r-1),s=0;s<16;++s)n=i&(e[s]^t[s]),e[s]^=n,t[s]^=n}function ge(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;++t)r[t]=e[t];return r}function kn(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]+r[n]}function Nn(e,t,r){for(var n=0;n<16;++n)e[n]=t[n]-r[n]}function on(e,t){Ge(e,t,t)}function Ge(e,t,r){var n,i,s=0,a=0,o=0,l=0,u=0,c=0,f=0,d=0,p=0,g=0,m=0,T=0,x=0,B=0,v=0,_=0,w=0,I=0,k=0,M=0,K=0,N=0,U=0,H=0,$=0,re=0,Y=0,le=0,ee=0,ot=0,de=0,$e=r[0],Me=r[1],Fe=r[2],_e=r[3],ve=r[4],Ve=r[5],We=r[6],Qe=r[7],lt=r[8],tt=r[9],rt=r[10],ut=r[11],Je=r[12],Ke=r[13],He=r[14],P=r[15];n=t[0],s+=n*$e,a+=n*Me,o+=n*Fe,l+=n*_e,u+=n*ve,c+=n*Ve,f+=n*We,d+=n*Qe,p+=n*lt,g+=n*tt,m+=n*rt,T+=n*ut,x+=n*Je,B+=n*Ke,v+=n*He,_+=n*P,n=t[1],a+=n*$e,o+=n*Me,l+=n*Fe,u+=n*_e,c+=n*ve,f+=n*Ve,d+=n*We,p+=n*Qe,g+=n*lt,m+=n*tt,T+=n*rt,x+=n*ut,B+=n*Je,v+=n*Ke,_+=n*He,w+=n*P,n=t[2],o+=n*$e,l+=n*Me,u+=n*Fe,c+=n*_e,f+=n*ve,d+=n*Ve,p+=n*We,g+=n*Qe,m+=n*lt,T+=n*tt,x+=n*rt,B+=n*ut,v+=n*Je,_+=n*Ke,w+=n*He,I+=n*P,n=t[3],l+=n*$e,u+=n*Me,c+=n*Fe,f+=n*_e,d+=n*ve,p+=n*Ve,g+=n*We,m+=n*Qe,T+=n*lt,x+=n*tt,B+=n*rt,v+=n*ut,_+=n*Je,w+=n*Ke,I+=n*He,k+=n*P,n=t[4],u+=n*$e,c+=n*Me,f+=n*Fe,d+=n*_e,p+=n*ve,g+=n*Ve,m+=n*We,T+=n*Qe,x+=n*lt,B+=n*tt,v+=n*rt,_+=n*ut,w+=n*Je,I+=n*Ke,k+=n*He,M+=n*P,n=t[5],c+=n*$e,f+=n*Me,d+=n*Fe,p+=n*_e,g+=n*ve,m+=n*Ve,T+=n*We,x+=n*Qe,B+=n*lt,v+=n*tt,_+=n*rt,w+=n*ut,I+=n*Je,k+=n*Ke,M+=n*He,K+=n*P,n=t[6],f+=n*$e,d+=n*Me,p+=n*Fe,g+=n*_e,m+=n*ve,T+=n*Ve,x+=n*We,B+=n*Qe,v+=n*lt,_+=n*tt,w+=n*rt,I+=n*ut,k+=n*Je,M+=n*Ke,K+=n*He,N+=n*P,n=t[7],d+=n*$e,p+=n*Me,g+=n*Fe,m+=n*_e,T+=n*ve,x+=n*Ve,B+=n*We,v+=n*Qe,_+=n*lt,w+=n*tt,I+=n*rt,k+=n*ut,M+=n*Je,K+=n*Ke,N+=n*He,U+=n*P,n=t[8],p+=n*$e,g+=n*Me,m+=n*Fe,T+=n*_e,x+=n*ve,B+=n*Ve,v+=n*We,_+=n*Qe,w+=n*lt,I+=n*tt,k+=n*rt,M+=n*ut,K+=n*Je,N+=n*Ke,U+=n*He,H+=n*P,n=t[9],g+=n*$e,m+=n*Me,T+=n*Fe,x+=n*_e,B+=n*ve,v+=n*Ve,_+=n*We,w+=n*Qe,I+=n*lt,k+=n*tt,M+=n*rt,K+=n*ut,N+=n*Je,U+=n*Ke,H+=n*He,$+=n*P,n=t[10],m+=n*$e,T+=n*Me,x+=n*Fe,B+=n*_e,v+=n*ve,_+=n*Ve,w+=n*We,I+=n*Qe,k+=n*lt,M+=n*tt,K+=n*rt,N+=n*ut,U+=n*Je,H+=n*Ke,$+=n*He,re+=n*P,n=t[11],T+=n*$e,x+=n*Me,B+=n*Fe,v+=n*_e,_+=n*ve,w+=n*Ve,I+=n*We,k+=n*Qe,M+=n*lt,K+=n*tt,N+=n*rt,U+=n*ut,H+=n*Je,$+=n*Ke,re+=n*He,Y+=n*P,n=t[12],x+=n*$e,B+=n*Me,v+=n*Fe,_+=n*_e,w+=n*ve,I+=n*Ve,k+=n*We,M+=n*Qe,K+=n*lt,N+=n*tt,U+=n*rt,H+=n*ut,$+=n*Je,re+=n*Ke,Y+=n*He,le+=n*P,n=t[13],B+=n*$e,v+=n*Me,_+=n*Fe,w+=n*_e,I+=n*ve,k+=n*Ve,M+=n*We,K+=n*Qe,N+=n*lt,U+=n*tt,H+=n*rt,$+=n*ut,re+=n*Je,Y+=n*Ke,le+=n*He,ee+=n*P,n=t[14],v+=n*$e,_+=n*Me,w+=n*Fe,I+=n*_e,k+=n*ve,M+=n*Ve,K+=n*We,N+=n*Qe,U+=n*lt,H+=n*tt,$+=n*rt,re+=n*ut,Y+=n*Je,le+=n*Ke,ee+=n*He,ot+=n*P,n=t[15],_+=n*$e,w+=n*Me,I+=n*Fe,k+=n*_e,M+=n*ve,K+=n*Ve,N+=n*We,U+=n*Qe,H+=n*lt,$+=n*tt,re+=n*rt,Y+=n*ut,le+=n*Je,ee+=n*Ke,ot+=n*He,de+=n*P,s+=38*w,a+=38*I,o+=38*k,l+=38*M,u+=38*K,c+=38*N,f+=38*U,d+=38*H,p+=38*$,g+=38*re,m+=38*Y,T+=38*le,x+=38*ee,B+=38*ot,v+=38*de,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=T+i+65535,i=Math.floor(n/65536),T=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=B+i+65535,i=Math.floor(n/65536),B=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=g+i+65535,i=Math.floor(n/65536),g=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=T+i+65535,i=Math.floor(n/65536),T=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=B+i+65535,i=Math.floor(n/65536),B=n-i*65536,n=v+i+65535,i=Math.floor(n/65536),v=n-i*65536,n=_+i+65535,i=Math.floor(n/65536),_=n-i*65536,s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=l,e[4]=u,e[5]=c,e[6]=f,e[7]=d,e[8]=p,e[9]=g,e[10]=m,e[11]=T,e[12]=x,e[13]=B,e[14]=v,e[15]=_}var Ht=we;Ht.kem=Ht.kem||{};var du=Ht.jsbn.BigInteger;Ht.kem.rsa={};Ht.kem.rsa.create=function(e,t){t=t||{};var r=t.prng||Ht.random,n={};return n.encrypt=function(i,s){var a=Math.ceil(i.n.bitLength()/8),o;do o=new du(Ht.util.bytesToHex(r.getBytesSync(a)),16).mod(i.n);while(o.compareTo(du.ONE)<=0);o=Ht.util.hexToBytes(o.toString(16));var l=a-o.length;l>0&&(o=Ht.util.fillString(String.fromCharCode(0),l)+o);var u=i.encrypt(o,"NONE"),c=e.generate(o,s);return{encapsulation:u,key:c}},n.decrypt=function(i,s,a){var o=i.decrypt(s,"NONE");return e.generate(o,a)},n};Ht.kem.kdf1=function(e,t){Df(this,e,0,t||e.digestLength)};Ht.kem.kdf2=function(e,t){Df(this,e,1,t||e.digestLength)};function Df(e,t,r,n){e.generate=function(i,s){for(var a=new Ht.util.ByteBuffer,o=Math.ceil(s/n)+r,l=new Ht.util.ByteBuffer,u=r;u<o;++u){l.putInt32(u),t.start(),t.update(i+l.getBytes());var c=t.digest();a.putBytes(c.getBytes(n))}return a.truncate(a.length()-s),a.getBytes()}}var Ne=we;Ne.log=Ne.log||{};Ne.log.levels=["none","error","warning","info","debug","verbose","max"];var Bs={},za=[],mi=null;Ne.log.LEVEL_LOCKED=1<<1;Ne.log.NO_LEVEL_CHECK=1<<2;Ne.log.INTERPOLATE=1<<3;for(var Wr=0;Wr<Ne.log.levels.length;++Wr){var pu=Ne.log.levels[Wr];Bs[pu]={index:Wr,name:pu.toUpperCase()}}Ne.log.logMessage=function(e){for(var t=Bs[e.level].index,r=0;r<za.length;++r){var n=za[r];if(n.flags&Ne.log.NO_LEVEL_CHECK)n.f(e);else{var i=Bs[n.level].index;t<=i&&n.f(n,e)}}};Ne.log.prepareStandard=function(e){"standard"in e||(e.standard=Bs[e.level].name+" ["+e.category+"] "+e.message)};Ne.log.prepareFull=function(e){if(!("full"in e)){var t=[e.message];t=t.concat([]),e.full=Ne.util.format.apply(this,t)}};Ne.log.prepareStandardFull=function(e){"standardFull"in e||(Ne.log.prepareStandard(e),e.standardFull=e.standard)};for(var gu=["error","warning","info","debug","verbose"],Wr=0;Wr<gu.length;++Wr)(function(t){Ne.log[t]=function(r,n){var i=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:t,category:r,message:n,arguments:i};Ne.log.logMessage(s)}})(gu[Wr]);Ne.log.makeLogger=function(e){var t={flags:0,f:e};return Ne.log.setLevel(t,"none"),t};Ne.log.setLevel=function(e,t){var r=!1;if(e&&!(e.flags&Ne.log.LEVEL_LOCKED))for(var n=0;n<Ne.log.levels.length;++n){var i=Ne.log.levels[n];if(t==i){e.level=t,r=!0;break}}return r};Ne.log.lock=function(e,t){typeof t>"u"||t?e.flags|=Ne.log.LEVEL_LOCKED:e.flags&=~Ne.log.LEVEL_LOCKED};Ne.log.addLogger=function(e){za.push(e)};if(typeof console<"u"&&"log"in console){var oi;if(console.error&&console.warn&&console.info&&console.debug){var dE={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},zo=function(e,t){Ne.log.prepareStandard(t);var r=dE[t.level],n=[t.standard];n=n.concat(t.arguments.slice()),r.apply(console,n)};oi=Ne.log.makeLogger(zo)}else{var zo=function(t,r){Ne.log.prepareStandardFull(r),console.log(r.standardFull)};oi=Ne.log.makeLogger(zo)}Ne.log.setLevel(oi,"debug"),Ne.log.addLogger(oi),mi=oi}else console={log:function(){}};if(mi!==null&&typeof window<"u"&&window.location){var qi=new URL(window.location.href).searchParams;if(qi.has("console.level")&&Ne.log.setLevel(mi,qi.get("console.level").slice(-1)[0]),qi.has("console.lock")){var pE=qi.get("console.lock").slice(-1)[0];pE=="true"&&Ne.log.lock(mi)}}Ne.log.consoleLogger=mi;var gE={exports:{}};(function(e){e.exports=Hv})(gE);var Z=we,L=Z.asn1,Pt=Z.pkcs7=Z.pkcs7||{};Pt.messageFromPem=function(e){var t=Z.pem.decode(e)[0];if(t.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=L.fromDer(t.body);return Pt.messageFromAsn1(n)};Pt.messageToPem=function(e,t){var r={type:"PKCS7",body:L.toDer(e.toAsn1()).getBytes()};return Z.pem.encode(r,{maxline:t})};Pt.messageFromAsn1=function(e){var t={},r=[];if(!L.validate(e,Pt.asn1.contentInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var i=L.derToOid(t.contentType),s;switch(i){case Z.pki.oids.envelopedData:s=Pt.createEnvelopedData();break;case Z.pki.oids.encryptedData:s=Pt.createEncryptedData();break;case Z.pki.oids.signedData:s=Pt.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+i+" is not (yet) supported.")}return s.fromAsn1(t.content.value[0]),s};Pt.createSignedData=function(){var e=null;return e={type:Z.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(Wo(e,n,Pt.asn1.signedDataValidator),e.certificates=[],e.crls=[],e.digestAlgorithmIdentifiers=[],e.contentInfo=null,e.signerInfos=[],e.rawCapture.certificates)for(var i=e.rawCapture.certificates.value,s=0;s<i.length;++s)e.certificates.push(Z.pki.certificateFromAsn1(i[s]))},toAsn1:function(){e.contentInfo||e.sign();for(var n=[],i=0;i<e.certificates.length;++i)n.push(Z.pki.certificateToAsn1(e.certificates[i]));var s=[],a=L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(e.version).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,e.digestAlgorithmIdentifiers),e.contentInfo])]);return n.length>0&&a.value[0].value.push(L.create(L.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&a.value[0].value.push(L.create(L.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(L.create(L.Class.UNIVERSAL,L.Type.SET,!0,e.signerInfos)),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.type).getBytes()),a])},addSigner:function(n){var i=n.issuer,s=n.serialNumber;if(n.certificate){var a=n.certificate;typeof a=="string"&&(a=Z.pki.certificateFromPem(a)),i=a.issuer.attributes,s=a.serialNumber}var o=n.key;if(!o)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof o=="string"&&(o=Z.pki.privateKeyFromPem(o));var l=n.digestAlgorithm||Z.pki.oids.sha1;switch(l){case Z.pki.oids.sha1:case Z.pki.oids.sha256:case Z.pki.oids.sha384:case Z.pki.oids.sha512:case Z.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+l)}var u=n.authenticatedAttributes||[];if(u.length>0){for(var c=!1,f=!1,d=0;d<u.length;++d){var p=u[d];if(!c&&p.type===Z.pki.oids.contentType){if(c=!0,f)break;continue}if(!f&&p.type===Z.pki.oids.messageDigest){if(f=!0,c)break;continue}}if(!c||!f)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}e.signers.push({key:o,version:1,issuer:i,serialNumber:s,digestAlgorithm:l,signatureAlgorithm:Z.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:u,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof e.content!="object"||e.contentInfo===null)&&(e.contentInfo=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Z.pki.oids.data).getBytes())]),"content"in e)){var i;e.content instanceof Z.util.ByteBuffer?i=e.content.bytes():typeof e.content=="string"&&(i=Z.util.encodeUtf8(e.content)),n.detached?e.detachedContent=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,i):e.contentInfo.value.push(L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,i)]))}if(e.signers.length!==0){var s=t();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=Z.pki.certificateFromPem(n)),e.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},e;function t(){for(var n={},i=0;i<e.signers.length;++i){var s=e.signers[i],a=s.digestAlgorithm;a in n||(n[a]=Z.md[Z.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=n[a]:s.md=Z.md[Z.pki.oids[a]].create()}e.digestAlgorithmIdentifiers=[];for(var a in n)e.digestAlgorithmIdentifiers.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(a).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]));return n}function r(n){var i;if(e.detachedContent?i=e.detachedContent:(i=e.contentInfo.value[1],i=i.value[0]),!i)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=L.derToOid(e.contentInfo.value[0].value),a=L.toDer(i);a.getByte(),L.getBerValueLength(a),a=a.getBytes();for(var o in n)n[o].start().update(a);for(var l=new Date,u=0;u<e.signers.length;++u){var c=e.signers[u];if(c.authenticatedAttributes.length===0){if(s!==Z.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{c.authenticatedAttributesAsn1=L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var f=L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[]),d=0;d<c.authenticatedAttributes.length;++d){var p=c.authenticatedAttributes[d];p.type===Z.pki.oids.messageDigest?p.value=n[c.digestAlgorithm].digest():p.type===Z.pki.oids.signingTime&&(p.value||(p.value=l)),f.value.push(Wa(p)),c.authenticatedAttributesAsn1.value.push(Wa(p))}a=L.toDer(f).getBytes(),c.md.start().update(a)}c.signature=c.key.sign(c.md,"RSASSA-PKCS1-V1_5")}e.signerInfos=EE(e.signers)}};Pt.createEncryptedData=function(){var e=null;return e={type:Z.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:Z.pki.oids["aes256-CBC"]},fromAsn1:function(t){Wo(e,t,Pt.asn1.encryptedDataValidator)},decrypt:function(t){t!==void 0&&(e.encryptedContent.key=t),Uf(e)}},e};Pt.createEnvelopedData=function(){var e=null;return e={type:Z.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:Z.pki.oids["aes256-CBC"]},fromAsn1:function(t){var r=Wo(e,t,Pt.asn1.envelopedDataValidator);e.recipients=vE(r.recipientInfos.value)},toAsn1:function(){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.type).getBytes()),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(e.version).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,CE(e.recipients)),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,SE(e.encryptedContent))])])])},findRecipient:function(t){for(var r=t.issuer.attributes,n=0;n<e.recipients.length;++n){var i=e.recipients[n],s=i.issuer;if(i.serialNumber===t.serialNumber&&s.length===r.length){for(var a=!0,o=0;o<r.length;++o)if(s[o].type!==r[o].type||s[o].value!==r[o].value){a=!1;break}if(a)return i}}return null},decrypt:function(t,r){if(e.encryptedContent.key===void 0&&t!==void 0&&r!==void 0)switch(t.encryptedContent.algorithm){case Z.pki.oids.rsaEncryption:case Z.pki.oids.desCBC:var n=r.decrypt(t.encryptedContent.content);e.encryptedContent.key=Z.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+t.encryptedContent.algorithm)}Uf(e)},addRecipient:function(t){e.recipients.push({version:0,issuer:t.issuer.attributes,serialNumber:t.serialNumber,encryptedContent:{algorithm:Z.pki.oids.rsaEncryption,key:t.publicKey}})},encrypt:function(t,r){if(e.encryptedContent.content===void 0){r=r||e.encryptedContent.algorithm,t=t||e.encryptedContent.key;var n,i,s;switch(r){case Z.pki.oids["aes128-CBC"]:n=16,i=16,s=Z.aes.createEncryptionCipher;break;case Z.pki.oids["aes192-CBC"]:n=24,i=16,s=Z.aes.createEncryptionCipher;break;case Z.pki.oids["aes256-CBC"]:n=32,i=16,s=Z.aes.createEncryptionCipher;break;case Z.pki.oids["des-EDE3-CBC"]:n=24,i=8,s=Z.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(t===void 0)t=Z.util.createBuffer(Z.random.getBytes(n));else if(t.length()!=n)throw new Error("Symmetric key has wrong length; got "+t.length()+" bytes, expected "+n+".");e.encryptedContent.algorithm=r,e.encryptedContent.key=t,e.encryptedContent.parameter=Z.util.createBuffer(Z.random.getBytes(i));var a=s(t);if(a.start(e.encryptedContent.parameter.copy()),a.update(e.content),!a.finish())throw new Error("Symmetric encryption failed.");e.encryptedContent.content=a.output}for(var o=0;o<e.recipients.length;++o){var l=e.recipients[o];if(l.encryptedContent.content===void 0)switch(l.encryptedContent.algorithm){case Z.pki.oids.rsaEncryption:l.encryptedContent.content=l.encryptedContent.key.encrypt(e.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+l.encryptedContent.algorithm)}}}},e};function yE(e){var t={},r=[];if(!L.validate(e,Pt.asn1.recipientInfoValidator,t,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:t.version.charCodeAt(0),issuer:Z.pki.RDNAttributesAsArray(t.issuer),serialNumber:Z.util.createBuffer(t.serial).toHex(),encryptedContent:{algorithm:L.derToOid(t.encAlgorithm),parameter:t.encParameter?t.encParameter.value:void 0,content:t.encKey}}}function mE(e){return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(e.version).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[Z.pki.distinguishedNameToAsn1({attributes:e.issuer}),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Z.util.hexToBytes(e.serialNumber))]),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.encryptedContent.algorithm).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")]),L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.encryptedContent.content)])}function vE(e){for(var t=[],r=0;r<e.length;++r)t.push(yE(e[r]));return t}function CE(e){for(var t=[],r=0;r<e.length;++r)t.push(mE(e[r]));return t}function bE(e){var t=L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,L.integerToDer(e.version).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[Z.pki.distinguishedNameToAsn1({attributes:e.issuer}),L.create(L.Class.UNIVERSAL,L.Type.INTEGER,!1,Z.util.hexToBytes(e.serialNumber))]),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.digestAlgorithm).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")])]);if(e.authenticatedAttributesAsn1&&t.value.push(e.authenticatedAttributesAsn1),t.value.push(L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.signatureAlgorithm).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.NULL,!1,"")])),t.value.push(L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.signature)),e.unauthenticatedAttributes.length>0){for(var r=L.create(L.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<e.unauthenticatedAttributes.length;++n){var i=e.unauthenticatedAttributes[n];r.values.push(Wa(i))}t.value.push(r)}return t}function EE(e){for(var t=[],r=0;r<e.length;++r)t.push(bE(e[r]));return t}function Wa(e){var t;if(e.type===Z.pki.oids.contentType)t=L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.value).getBytes());else if(e.type===Z.pki.oids.messageDigest)t=L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.value.bytes());else if(e.type===Z.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),i=e.value;if(typeof i=="string"){var s=Date.parse(i);isNaN(s)?i.length===13?i=L.utcTimeToDate(i):i=L.generalizedTimeToDate(i):i=new Date(s)}i>=r&&i<n?t=L.create(L.Class.UNIVERSAL,L.Type.UTCTIME,!1,L.dateToUtcTime(i)):t=L.create(L.Class.UNIVERSAL,L.Type.GENERALIZEDTIME,!1,L.dateToGeneralizedTime(i))}return L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.type).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SET,!0,[t])])}function SE(e){return[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(Z.pki.oids.data).getBytes()),L.create(L.Class.UNIVERSAL,L.Type.SEQUENCE,!0,[L.create(L.Class.UNIVERSAL,L.Type.OID,!1,L.oidToDer(e.algorithm).getBytes()),e.parameter?L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.parameter.getBytes()):void 0]),L.create(L.Class.CONTEXT_SPECIFIC,0,!0,[L.create(L.Class.UNIVERSAL,L.Type.OCTETSTRING,!1,e.content.getBytes())])]}function Wo(e,t,r){var n={},i=[];if(!L.validate(t,r,n,i)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=L.derToOid(n.contentType);if(a!==Z.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var o="";if(Z.util.isArray(n.encryptedContent))for(var l=0;l<n.encryptedContent.length;++l){if(n.encryptedContent[l].type!==L.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");o+=n.encryptedContent[l].value}else o=n.encryptedContent;e.encryptedContent={algorithm:L.derToOid(n.encAlgorithm),parameter:Z.util.createBuffer(n.encParameter.value),content:Z.util.createBuffer(o)}}if(n.content){var o="";if(Z.util.isArray(n.content))for(var l=0;l<n.content.length;++l){if(n.content[l].type!==L.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");o+=n.content[l].value}else o=n.content;e.content=Z.util.createBuffer(o)}return e.version=n.version.charCodeAt(0),e.rawCapture=n,n}function Uf(e){if(e.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(e.content===void 0){var t;switch(e.encryptedContent.algorithm){case Z.pki.oids["aes128-CBC"]:case Z.pki.oids["aes192-CBC"]:case Z.pki.oids["aes256-CBC"]:t=Z.aes.createDecryptionCipher(e.encryptedContent.key);break;case Z.pki.oids.desCBC:case Z.pki.oids["des-EDE3-CBC"]:t=Z.des.createDecryptionCipher(e.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+e.encryptedContent.algorithm)}if(t.start(e.encryptedContent.parameter),t.update(e.encryptedContent.content),!t.finish())throw new Error("Symmetric decryption failed.");e.content=t.output}}var dt=we,Xs=dt.ssh=dt.ssh||{};Xs.privateKeyToPutty=function(e,t,r){r=r||"",t=t||"";var n="ssh-rsa",i=t===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+i+`\r
`,s+="Comment: "+r+`\r
`;var a=dt.util.createBuffer();Ln(a,n),or(a,e.e),or(a,e.n);var o=dt.util.encode64(a.bytes(),64),l=Math.floor(o.length/66)+1;s+="Public-Lines: "+l+`\r
`,s+=o;var u=dt.util.createBuffer();or(u,e.d),or(u,e.p),or(u,e.q),or(u,e.qInv);var c;if(!t)c=dt.util.encode64(u.bytes(),64);else{var f=u.length()+16-1;f-=f%16;var d=ji(u.bytes());d.truncate(d.length()-f+u.length()),u.putBuffer(d);var p=dt.util.createBuffer();p.putBuffer(ji("\0\0\0\0",t)),p.putBuffer(ji("\0\0\0",t));var g=dt.aes.createEncryptionCipher(p.truncate(8),"CBC");g.start(dt.util.createBuffer().fillWithByte(0,16)),g.update(u.copy()),g.finish();var m=g.output;m.truncate(16),c=dt.util.encode64(m.bytes(),64)}l=Math.floor(c.length/66)+1,s+=`\r
Private-Lines: `+l+`\r
`,s+=c;var T=ji("putty-private-key-file-mac-key",t),x=dt.util.createBuffer();Ln(x,n),Ln(x,i),Ln(x,r),x.putInt32(a.length()),x.putBuffer(a),x.putInt32(u.length()),x.putBuffer(u);var B=dt.hmac.create();return B.start("sha1",T),B.update(x.bytes()),s+=`\r
Private-MAC: `+B.digest().toHex()+`\r
`,s};Xs.publicKeyToOpenSSH=function(e,t){var r="ssh-rsa";t=t||"";var n=dt.util.createBuffer();return Ln(n,r),or(n,e.e),or(n,e.n),r+" "+dt.util.encode64(n.bytes())+" "+t};Xs.privateKeyToOpenSSH=function(e,t){return t?dt.pki.encryptRsaPrivateKey(e,t,{legacy:!0,algorithm:"aes128"}):dt.pki.privateKeyToPem(e)};Xs.getPublicKeyFingerprint=function(e,t){t=t||{};var r=t.md||dt.md.md5.create(),n="ssh-rsa",i=dt.util.createBuffer();Ln(i,n),or(i,e.e),or(i,e.n),r.start(),r.update(i.getBytes());var s=r.digest();if(t.encoding==="hex"){var a=s.toHex();return t.delimiter?a.match(/.{2}/g).join(t.delimiter):a}else{if(t.encoding==="binary")return s.getBytes();if(t.encoding)throw new Error('Unknown encoding "'+t.encoding+'".')}return s};function or(e,t){var r=t.toString(16);r[0]>="8"&&(r="00"+r);var n=dt.util.hexToBytes(r);e.putInt32(n.length),e.putBytes(n)}function Ln(e,t){e.putInt32(t.length),e.putString(t)}function ji(){for(var e=dt.md.sha1.create(),t=arguments.length,r=0;r<t;++r)e.update(arguments[r]);return e.digest()}(function(e){e.exports=we})(Gc);const zn=gv(Gc.exports),_E={peerOpts:{config:{iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"},{urls:"stun:openrelay.metered.ca:80"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443?transport=tcp",username:"openrelayproject",credential:"openrelayproject"}]}}},Qa=e=>{const t=zn.util.createBuffer();return t.putBytes(zn.util.hexToBytes(e)),t},Of=e=>{const t=e.substring(0,32),r=e.substring(32);return{key:Qa(t),iv:Qa(r)}},wE=(e,t)=>{const{key:r,iv:n}=Of(t),i=zn.cipher.createCipher("AES-CBC",r);return i.start({iv:n}),i.update(zn.util.createBuffer(e)),i.finish(),i.output.toHex()},yu=(e,t)=>{const{key:r,iv:n}=Of(t),i=zn.cipher.createDecipher("AES-CBC",r);return i.start({iv:n}),i.update(Qa(e)),i.finish()?i.output.toString():null};class TE{constructor(t){this.name=t,this.session=null}isEntered(){return this.session!==null}enter(t,r,n,i,s){const a=zn.md.sha512.create().update(this.name).digest().toHex(),o=new Yn,l=o.getMap("nav");l.observe(f=>i(l.get("state")));const u=o.getArray("chat");u.observe(f=>{for(const d of[...f.changes.delta[0].insert].reverse()){const p=yu(d.encryptedMessage,this.session.secret);p!==null&&s({username:d.username,message:p})}});const c=new Nv(a.substring(0,a.length-64),o,_E);return this.session={secret:a.substring(a.length-64),ydoc:o,awareness:c.awareness},this.session.awareness.on("change",f=>n(this.session.awareness.getStates())),this.session.awareness.setLocalStateField("username",t),this.session.awareness.setLocalStateField("navControl",r),{clientID:this.session.awareness.clientID,messages:u.toArray().map(f=>{const d=yu(f.encryptedMessage,this.session.secret);return d!==null?{username:f.username,message:d}:null})}}leave(){!this.isEntered()||(this.session.ydoc.destroy(),this.session=null)}setNavControl(t){!this.isEntered()||this.session.awareness.setLocalStateField("navControl",t)}navigate(t){if(!this.isEntered())return;this.session.ydoc.getMap("nav").set("state",t)}send(t){if(!this.isEntered())return;const r=this.session.ydoc.getArray("chat");r.insert(0,[{username:this.session.awareness.getLocalState().username,encryptedMessage:wE(t,this.session.secret)}]),r.delete(100,r.length-100)}}function mu(e,t,r){const n=e.slice();return n[16]=t[r],n}function xE(e){let t,r,n,i,s,a,o,l,u,c,f,d,p,g,m,T,x,B,v,_,w,I,k;function M($,re){return $[6]?kE:IE}let K=M(e),N=K(e);s=new hr({props:{id:"logout"}}),B=new hr({props:{id:"send"}});let U=e[3].chat,H=[];for(let $=0;$<U.length;$+=1)H[$]=vu(mu(e,U,$));return{c(){t=oe("div"),r=oe("button"),N.c(),n=it(),i=oe("button"),_t(s.$$.fragment),a=it(),o=oe("p"),l=ft("Praying in "),u=oe("em"),c=ft(e[0]),f=ft(" (private) "),d=ft(e[5]),p=it(),g=oe("div"),m=oe("input"),T=it(),x=oe("button"),_t(B.$$.fragment),v=it();for(let $=0;$<H.length;$+=1)H[$].c();_=Ii(),pe(r,"class","svelte-tpbysk"),pe(i,"class","svelte-tpbysk"),pe(t,"class","action svelte-tpbysk"),pe(m,"type","text"),pe(m,"class","svelte-tpbysk"),pe(x,"class","svelte-tpbysk"),pe(g,"class","action svelte-tpbysk")},m($,re){me($,t,re),se(t,r),N.m(r,null),se(t,n),se(t,i),pt(s,i,null),me($,a,re),me($,o,re),se(o,l),se(o,u),se(u,c),se(o,f),se(o,d),me($,p,re),me($,g,re),se(g,m),Bn(m,e[4]),se(g,T),se(g,x),pt(B,x,null),me($,v,re);for(let Y=0;Y<H.length;Y+=1)H[Y].m($,re);me($,_,re),w=!0,I||(k=[Lt(r,"click",e[10]),Lt(i,"click",e[8]),Lt(m,"input",e[13]),Lt(x,"click",e[9])],I=!0)},p($,re){if(K!==(K=M($))&&(N.d(1),N=K($),N&&(N.c(),N.m(r,null))),(!w||re&1)&&qt(c,$[0]),(!w||re&32)&&qt(d,$[5]),re&16&&m.value!==$[4]&&Bn(m,$[4]),re&8){U=$[3].chat;let Y;for(Y=0;Y<U.length;Y+=1){const le=mu($,U,Y);H[Y]?H[Y].p(le,re):(H[Y]=vu(le),H[Y].c(),H[Y].m(_.parentNode,_))}for(;Y<H.length;Y+=1)H[Y].d(1);H.length=U.length}},i($){w||(Se(s.$$.fragment,$),Se(B.$$.fragment,$),w=!0)},o($){Ie(s.$$.fragment,$),Ie(B.$$.fragment,$),w=!1},d($){$&&ye(t),N.d(),gt(s),$&&ye(a),$&&ye(o),$&&ye(p),$&&ye(g),gt(B),$&&ye(v),dn(H,$),$&&ye(_),I=!1,br(k)}}}function AE(e){let t,r,n,i,s,a,o,l,u,c,f,d;return u=new hr({props:{id:"login"}}),{c(){t=oe("h1"),t.textContent="Private groups",r=it(),n=oe("input"),i=it(),s=oe("div"),a=oe("input"),o=it(),l=oe("button"),_t(u.$$.fragment),pe(n,"type","text"),pe(n,"placeholder","Your name"),pe(a,"type","text"),pe(a,"placeholder","Name of a private group"),pe(a,"class","svelte-tpbysk"),pe(l,"class","svelte-tpbysk"),pe(s,"class","action svelte-tpbysk")},m(p,g){me(p,t,g),me(p,r,g),me(p,n,g),Bn(n,e[1]),me(p,i,g),me(p,s,g),se(s,a),Bn(a,e[0]),se(s,o),se(s,l),pt(u,l,null),c=!0,f||(d=[Lt(n,"input",e[11]),Lt(a,"input",e[12]),Lt(l,"click",e[7])],f=!0)},p(p,g){g&2&&n.value!==p[1]&&Bn(n,p[1]),g&1&&a.value!==p[0]&&Bn(a,p[0])},i(p){c||(Se(u.$$.fragment,p),c=!0)},o(p){Ie(u.$$.fragment,p),c=!1},d(p){p&&ye(t),p&&ye(r),p&&ye(n),p&&ye(i),p&&ye(s),gt(u),f=!1,br(d)}}}function IE(e){let t;return{c(){t=ft("Lead this group")},m(r,n){me(r,t,n)},d(r){r&&ye(t)}}}function kE(e){let t;return{c(){t=ft("Stop leading this group")},m(r,n){me(r,t,n)},d(r){r&&ye(t)}}}function vu(e){let t,r,n=e[16].username+"",i,s,a=e[16].message+"",o;return{c(){t=oe("p"),r=oe("em"),i=ft(n),s=ft(": "),o=ft(a)},m(l,u){me(l,t,u),se(t,r),se(r,i),se(t,s),se(t,o)},p(l,u){u&8&&n!==(n=l[16].username+"")&&qt(i,n),u&8&&a!==(a=l[16].message+"")&&qt(o,a)},d(l){l&&ye(t)}}}function Cu(e){let t,r,n,i,s,a;const o=[AE,xE],l=[];function u(c,f){return c[2]===null?0:1}return r=u(e),n=l[r]=o[r](e),{c(){t=oe("div"),n.c(),pe(t,"class","svelte-tpbysk")},m(c,f){me(c,t,f),l[r].m(t,null),a=!0},p(c,f){let d=r;r=u(c),r===d?l[r].p(c,f):(Lr(),Ie(l[d],1,1,()=>{l[d]=null}),Dr(),n=l[r],n?n.p(c,f):(n=l[r]=o[r](c),n.c()),Se(n,1),n.m(t,null))},i(c){a||(Se(n),Jr(()=>{s&&s.end(1),i=Za(t,Pn,{delay:75,duration:75}),i.start()}),a=!0)},o(c){Ie(n),i&&i.invalidate(),s=eo(t,Pn,{duration:75}),a=!1},d(c){c&&ye(t),l[r].d(),c&&s&&s.end()}}}function BE(e){let t,r=e[2],n,i=Cu(e);return{c(){t=oe("div"),i.c(),pe(t,"class","groups svelte-tpbysk")},m(s,a){me(s,t,a),i.m(t,null),n=!0},p(s,[a]){a&4&&Dt(r,r=s[2])?(Lr(),Ie(i,1,1,et),Dr(),i=Cu(s),i.c(),Se(i,1),i.m(t,null)):i.p(s,a)},i(s){n||(Se(i),n=!0)},o(s){Ie(i),n=!1},d(s){s&&ye(t),i.d(s)}}}function RE(e,t,r){let n,i,s;Xe(e,Tt,v=>r(14,n=v)),Xe(e,ln,v=>r(6,i=v)),Xe(e,ui,v=>r(1,s=v));let a=null,o={},l="",u="",c="";const f=()=>{if(l.length==0||(ui.update(_=>_.trim()),s.length==0))return;ln.set(!1),r(2,a=new TE(l)),r(3,o.awareness=[],o),r(3,o.chat=[],o);const v=a.enter(s,i,_=>{r(3,o.awareness=[..._],o),r(5,c=m())},_=>{(n.prayer!=_.prayer||n.lang!=_.lang||n.stage!=_.stage||n.step!=_.step)&&Tt.update(w=>(w.prayer=_.prayer,w.lang=_.lang,w.stage=_.stage,w.step=_.step,w.conf=_.conf,w))},_=>{r(3,o.chat=[_,...o.chat.slice(0,99)],o)});r(3,o.clientID=v.clientID,o),r(3,o.chat=v.messages.filter(_=>_!==null),o),r(4,u="")},d=()=>{a.leave(),r(2,a=null),r(3,o={}),ln.set(!0)},p=()=>{r(4,u=u.trim()),u.length!=0&&(a.send(u),r(4,u=""))},g=()=>{ln.update(v=>!v),a.setNavControl(i),i&&a.navigate(n)},m=()=>{const v=o.awareness.length-1;return v==0?"":"with "+v+" "+(v==1?"friend":"friends")+": "+o.awareness.filter(_=>_[0]!=o.clientID).map(_=>_[1].username+(_[1].navControl?" (leader)":"")).join(", ")};Tt.subscribe(v=>{a!==null&&a.navigate(v)});function T(){s=this.value,ui.set(s)}function x(){l=this.value,r(0,l)}function B(){u=this.value,r(4,u)}return e.$$.update=()=>{e.$$.dirty&1&&r(0,l=l.toLowerCase().replace(RegExp(/[^\p{L}0-9\-]/,"gu"),"")),e.$$.dirty&2&&Ff(ui,s=s.replace(RegExp(/[^\p{L} \.\-]/,"gu"),""),s)},[l,s,a,o,u,c,i,f,d,p,g,T,x,B]}class NE extends Sr{constructor(t){super(),Er(this,t,RE,BE,Dt,{})}}Tt.subscribe(e=>{localStorage.setItem("state",JSON.stringify(e))});ui.subscribe(e=>{localStorage.setItem("privateName",e)});function LE(e){let t,r,n,i,s,a,o,l,u,c,f,d,p,g,m,T,x,B,v;return n=new lg({}),l=new pg({}),f=new Rg({}),g=new NE({}),B=new fg({}),{c(){t=oe("div"),r=oe("header"),_t(n.$$.fragment),i=it(),s=oe("main"),a=oe("div"),o=oe("div"),_t(l.$$.fragment),u=it(),c=oe("div"),_t(f.$$.fragment),d=it(),p=oe("div"),_t(g.$$.fragment),T=it(),x=oe("footer"),_t(B.$$.fragment),pe(r,"class","svelte-114vc00"),pe(o,"data-tab","menu"),pe(o,"class","svelte-114vc00"),pe(c,"data-tab","prayer"),pe(c,"class","svelte-114vc00"),pe(p,"data-tab","groups"),pe(p,"class","svelte-114vc00"),pe(a,"class",m=Jo("tab-"+e[0])+" svelte-114vc00"),pe(s,"class","svelte-114vc00"),pe(x,"class","svelte-114vc00"),pe(t,"class","container svelte-114vc00")},m(_,w){me(_,t,w),se(t,r),pt(n,r,null),se(t,i),se(t,s),se(s,a),se(a,o),pt(l,o,null),se(a,u),se(a,c),pt(f,c,null),se(a,d),se(a,p),pt(g,p,null),se(t,T),se(t,x),pt(B,x,null),v=!0},p(_,[w]){(!v||w&1&&m!==(m=Jo("tab-"+_[0])+" svelte-114vc00"))&&pe(a,"class",m)},i(_){v||(Se(n.$$.fragment,_),Se(l.$$.fragment,_),Se(f.$$.fragment,_),Se(g.$$.fragment,_),Se(B.$$.fragment,_),v=!0)},o(_){Ie(n.$$.fragment,_),Ie(l.$$.fragment,_),Ie(f.$$.fragment,_),Ie(g.$$.fragment,_),Ie(B.$$.fragment,_),v=!1},d(_){_&&ye(t),gt(n),gt(l),gt(f),gt(g),gt(B)}}}function DE(e,t,r){let n;Xe(e,ss,s=>r(0,n=s)),ss.subscribe(s=>{for(const a of document.querySelectorAll("[data-tab]"))s==a.dataset.tab?a.scrollTo({top:0}):a.scrollTo({top:0,behavior:"smooth"})});const i=()=>{try{navigator.wakeLock.request("screen")}catch(s){s.message.includes("is undefined")||setTimeout(i,4e3)}};return i(),[n]}class UE extends Sr{constructor(t){super(),Er(this,t,DE,LE,Dt,{})}}new UE({target:document.getElementById("app")});
